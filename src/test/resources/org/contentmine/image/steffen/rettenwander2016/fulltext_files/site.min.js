var debounce=function(n,o,a){var s;return function(){var t=this,e=arguments,i=a&&!s;clearTimeout(s),s=setTimeout(function(){s=null,a||n.apply(t,e)},o),i&&n.apply(t,e)}};function updateViewportDimensions(){var t=window,e=document,i=e.documentElement,n=e.getElementsByTagName("body")[0];return{width:t.innerWidth||i.clientWidth||n.clientWidth,height:t.innerHeight||i.clientHeight||n.clientHeight}}var viewport=updateViewportDimensions(),SCM=SCM||{};SCM.JSUtility=function(u){return{equalHeights:function(i,n){function t(){if(u(i).length&&u(window).width()>n){var e=0,t=u(i);t.attr("style",""),t.each(function(){var t=u(this).outerHeight();e<t&&(e=t)}),u(i).css("height",e)}else u(i).attr("style","")}t(),u(window).resize(function(){t()})},addStateToggle:function(t,e,i){var n=u(t),o=u(e),a="active-state",s="target-active",r=u("body"),l=e.replace(/.|#/,"")+"-active",c=o.find(".close");function d(){o.removeClass(a),n.removeClass(s),i&&r.removeClass(l)}i=i||!1,n.click(function(t){t.preventDefault(),o.toggleClass(a),n.toggleClass(s),i&&r.toggleClass(l)}),r.click(function(t){u(t.target).closest(n.add(o)).length||d()}),c.click(function(){d()})},toggleVisibility:function(t,e,i){var n=u(t),o="target-active",a="active";e=e||!1,i=i||640;function s(){var t=u(this),e=u("."+t.attr("data-toggle-target"));t.toggleClass(o),e.slideToggle().toggleClass(a)}var r=debounce(function(){e?(viewport=updateViewportDimensions()).width>i?(n.off("click.toggle-visibility"),n.removeClass(o),n.each(function(){u("."+u(this).attr("data-toggle-target")).removeAttr("style").removeClass(a)})):(n.off("click.toggle-visibility"),n.on("click.toggle-visibility",s)):n.on("click.toggle-visibility",s)},150,!0);r(),e&&u(window).resize(function(){r()})},getParameterByName:function(t,e){e=e||window.location.href,t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}}}(jQuery);var SCM=SCM||{};SCM.Logging=function(){var t={debug:function(t){i()&&console.log(t)},warn:function(t){console.warn(t)},error:function(t){console.error(t)}},e=null;return{init:function(){},getLogger:function(){return t},isJsDebugEnabled:i};function i(){var t;return null!==e?e:e=(t=SCM.JSUtility.getParameterByName("JsDebug",window.location.href))&&"true"===t}}();var SCM=SCM||{};SCM.JqueryMigrateLogger=function(){var e,i,n=5e3,t=20,o=0;return{init:function(){if(i=SCM.Logging.getLogger(),!function(){return(e=$("[data-jquery-migrate-logging-enabled]"))&&e.length&&jQuery.migrateWarnings}())return void i.debug("jquery-migrate logging is disabled");i.debug("jquery-migrate logging is enabled.  Attempting to initialize Application Insights.");var t=function(){if(!e&&!e.length)return"";var t=e.data("jqueryMigrateInstrumentationKey");return t?t.trim():""}();if(!t)return;if(function(t){var e="appInsightsSDK";window[e]="appInsights";var i=window[e],n=window[i]||function(e){function t(e){s[e]=function(){var t=arguments;s.queue.push(function(){s[e].apply(s,t)})}}var s={config:e,initialize:!0},i=document,n=window;setTimeout(function(){var t=i.createElement("script");t.src=e.url||"https://az416426.vo.msecnd.net/scripts/b/ai.2.min.js",i.getElementsByTagName("script")[0].parentNode.appendChild(t)});try{s.cookie=i.cookie}catch(e){}s.queue=[],s.version=2;for(var r=["Event","PageView","Exception","Trace","DependencyData","Metric","PageViewPerformance"];r.length;)t("track"+r.pop());t("startTrackPage"),t("stopTrackPage");var o="Track"+r[0];if(t("start"+o),t("stop"+o),t("setAuthenticatedUserContext"),t("clearAuthenticatedUserContext"),t("flush"),!(!0===e.disableExceptionTracking||e.extensionConfig&&e.extensionConfig.ApplicationInsightsAnalytics&&!0===e.extensionConfig.ApplicationInsightsAnalytics.disableExceptionTracking)){t("_"+(r="onerror"));var l=n[r];n[r]=function(t,e,i,n,o){var a=l&&l(t,e,i,n,o);return!0!==a&&s["_"+r]({message:t,url:e,lineNumber:i,columnNumber:n,error:o}),a},e.autoExceptionInstrumented=!0}return s}({instrumentationKey:t,disableAjaxTracking:!0});window[i]=n}(t),!window.appInsights)return void i.warn("Application Insights failed to initialize.");setTimeout(a,n)}};function a(){jQuery.migrateWarnings&&jQuery.migrateWarnings.length&&(i.debug("Logging "+jQuery.migrateWarnings.length+" jquery-migrate warnings."),jQuery.migrateWarnings.forEach(function(t){i.debug(t),appInsights.trackEvent({name:"jquery-migrate-warning",properties:{host:window.location.hostname,url:window.location.href,warning:t}})}),jQuery.migrateReset()),++o<t&&setTimeout(a,n)}}();var SCM=SCM||{};!function(t,p){t.getDocWidth=function(){return self.innerWidth?self.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0},t.rightPanelHeight=function(){-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&setTimeout(function(){if(p(".panels").length){var t=p(window).height()-p(".panels").offset().top;p(".panels").css("height",t),p(".dynamic-widget-inner-wrap").addClass("panel-scroll")}},5e3)},t.SetActiveTab=function(){if(window.location.hash){var t=window.location.hash.substring(1);if(void 0!==t&&t.length&&-1<t.indexOf("tab-",0))p("."+t).trigger("click")}},t.init=function(){t.rightPanelHeight();var a=t.getDocWidth()<1024;p("body.pg_ArticleSplitView, body.pg_articlesplitview, body.pg_Chapter, body.pg_chapter").removeClass("pg_ArticleSplitView").addClass("pg_article pg_articlesplitview");var s=p("body.pg_articlesplitview .tab"),r=p("body.pg_articlesplitview .panels > .dynamic-widget-inner-wrap"),l=p("body.pg_articlesplitview .panels"),c=p("body.pg_articlesplitview .article");p("body").hasClass("pg_myaccount")||p(".tabs").prepend('<a class="tab tab-FullTextCss"><i class="tab__icon icon-full-text"><span class="tab__icon-text">Full Text</span></i><div class="tab__text">Full Text</div></a>');var d=p(".tab-FullTextCss");p(".ref-list [content-id]").each(function(){var t=p(this).attr("content-id");p(this).attr("data-id",t)}),p("body.pg_articlesplitview .widget-instance-SitePageFooter, body.pg_articlesplitview .site-theme-footer").appendTo(".article"),s.each(function(t){p(this).attr({"data-tab":t,role:"tab","aria-selected":"false","aria-controls":".dynamic-widget-inner-wrap[data-display-order='"+t+"']"})});var u={};function h(t){if(!SCM.Common.isDefined(t))return null;var e=p(t).attr("data-open");return SCM.Common.isDefined(e)?e.split(/\s+/)[0]:(e=p(t).attr("href"),SCM.Common.isDefined(e)?e.substring(1).split(/\s+/)[0]:null)}r.each(function(t){p(this).attr({role:"tabpanel","aria-hidden":"false","aria-labelledby":".tab[data-tab='"+t+"']"}),p(this).find("div[content-id]").each(function(){u[p(this).attr("content-id")]=t})}),s.on("click",function(){a&&c.hide(),l.show(),s.add(d).removeClass("active").attr("aria-selected","false"),p(this).addClass("active").attr("aria-selected","true"),r.hide().attr("aria-hidden","true");var t=p(this).attr("data-tab");return r.eq(t).show().attr("aria-hidden","false"),!1}),p("body.pg_articlesplitview .article .link-reveal, .aside .link-reveal, body.pg_articlesplitview .figlink").not(".xref-fn").on("click",function(){var t=h(this);if(!SCM.Common.isDefined(t))return console.warn("link not found"),!1;var e=t.toLowerCase(),i=p(".panels div[data-id="+t+"]");0===i.length&&(i=p(".panels div#"+t)),0===i.length&&(i=p(".panels div[data-id="+e+"]")),0===i.length&&(i=p(".panels div#"+e));var n=u[t],o=r.eq(n);return i&&i.length?(a&&c.hide(),l.show(),s.add(d).removeClass("active"),s.eq(n).addClass("active"),o.show().siblings().hide(),o.delay(100).animate({scrollTop:o.scrollTop()+i.position().top-10},250)):function(t){var e=h(t),i=p(".article-body div[content-id="+e+"]");i&&i.length?(a&&d.trigger("click"),c.delay(100).animate({scrollTop:i.position().top-10},250)):console.warn("link not found")}(this),!1}),p(".pg_articlesplitview").length&&p('a.scrollTo[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname){var t=p(this.hash);t=t.length?t:p("[name="+this.hash.slice(1)+"]");var e=p(".article");if(t.length)return e.delay(100).animate({scrollTop:e.scrollTop()+t.position().top-10},250),!1}}),p(".backReferenceLink .section-jump-link__link-wrap a").click(function(){if(p(".ref-list").length){l.show(),s.add(d).removeClass("active").attr("aria-selected","false"),p("body.pg_articlesplitview .tab-ReferencesCss").addClass("active").attr("aria-selected","true"),r.hide().attr("aria-hidden","true");var t=p(".tab-ReferencesCss").attr("data-tab");return r.eq(t).show().attr("aria-hidden","false"),!1}}),d.on("click",function(t){s.removeClass("active"),p(this).addClass("active"),l.hide(),c.show()}),p(window).on("resize",function(){!1===(a=t.getDocWidth()<1024)?(c.show(),0===p(".tab.active").not(".tab-FullTextCss").length&&p(".tab:visible").first().trigger("click")):0<p(".tab.active").not(".tab-FullTextCss").length&&p(".tab.active").trigger("click")}),p(window).on("load",function(){var n=0<p("#articlefulltext_figshare").length;r.each(function(t){var e=p(this).find(".widget-dynamic-inner-wrap").html(),i=s.eq(t);e&&0!==e.length&&!/^\s*$/.test(e)||(n&&i.hasClass("tab-SupplementsCss")?(p(this).hide(),i.hasClass("js-hascontent")||i.hide()):(p(this).remove(),i.remove()))}),p(".tabs, .panels").css("display","flex"),p(".tab").removeClass("active"),p(".FiguresTablesCss").length?(p(".tab-FiguresTablesCss").addClass("active"),p(".FiguresTablesCss").parents(".dynamic-widget-inner-wrap[role='tabpanel']").show()):(p(".tab-ContentCss").addClass("active"),p(".ContentCss").parents(".dynamic-widget-inner-wrap[role='tabpanel']").show()),!0===a?(l.hide(),p(d).addClass("active")):p(".tab:visible").first().trigger("click"),p(".linked-name").on("click",function(){p(this).parent(".al-author-name").position().left+300>p(".article").width()&&p(this).next(".al-author-info-wrap").addClass("al-author-info-wrap--right")}),t.SetActiveTab()})}}(SCM.SplitScreen=SCM.SplitScreen||{},jQuery);var SCM=SCM||{};!function(t){t.init=function(){}}(SCM.ArticleFulltext=SCM.ArticleFulltext||{},jQuery);var SCM=SCM||{};!function(t){t(document).ready(function(){SCM.Logging.init(),SCM.JqueryMigrateLogger.init(),SCM.SplitScreen.init(),SCM.gdprCookieBanner.init(),SCM.ToolboxGetCitations&&SCM.ToolboxGetCitations.init&&SCM.ToolboxGetCitations.init(),t(".site-menu-item a.nav-link:contains('SEG Member Log In')").click(function(){var t=new Date;t.setTime(t.getTime()+36e5);var e="; expires="+t.toGMTString();document.cookie="ForceAutoLogin=AutoLogin=GeoScienceWorld"+e+"; path=/economicgeology"}),t(".geoRefRecordSummary .georefSection .gr-coordinates").filter(":first").addClass("labeled")}),t(document).ajaxStop(function(){t(".map-overlay").removeClass("covered")})}(jQuery),function(){for(var a=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,e){var i=(new Date).getTime(),n=Math.max(0,16-(i-a)),o=window.setTimeout(function(){t(i+n)},n);return a=i+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(l){var a="unobtrusiveAjaxClick",o="unobtrusiveAjaxClickTarget";function c(t,e){for(var i=window,n=(t||"").split(".");i&&n.length;)i=i[n.shift()];return"function"==typeof i?i:(e.push(t),Function.constructor.apply(null,e))}function d(t){return"GET"===t||"POST"===t}function s(n,t){var e,i,o,a;if(!(e=n.getAttribute("data-ajax-confirm"))||window.confirm(e)){i=l(n.getAttribute("data-ajax-loading")),a=parseInt(n.getAttribute("data-ajax-loading-duration"),10)||0,l.extend(t,{type:n.getAttribute("data-ajax-method")||void 0,url:n.getAttribute("data-ajax-url")||void 0,cache:"true"===(n.getAttribute("data-ajax-cache")||"").toLowerCase(),beforeSend:function(t){var e;return function(t,e){d(e)||t.setRequestHeader("X-HTTP-Method-Override",e)}(t,o),!1!==(e=c(n.getAttribute("data-ajax-begin"),["xhr"]).apply(n,arguments))&&i.show(a),e},complete:function(){i.hide(a),c(n.getAttribute("data-ajax-complete"),["xhr","status"]).apply(n,arguments)},success:function(t,e,i){!function(t,i,e){var n;-1===e.indexOf("application/x-javascript")&&(n=(t.getAttribute("data-ajax-mode")||"").toUpperCase(),l(t.getAttribute("data-ajax-update")).each(function(t,e){switch(n){case"BEFORE":l(e).prepend(i);break;case"AFTER":l(e).append(i);break;case"REPLACE-WITH":l(e).replaceWith(i);break;default:l(e).html(i)}}))}(n,t,i.getResponseHeader("Content-Type")||"text/html"),c(n.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(n,arguments)},error:function(){c(n.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(n,arguments)}}),t.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),d(o=t.type.toUpperCase())||(t.type="POST",t.data.push({name:"X-HTTP-Method-Override",value:o}));var s=l(n);if(s.is("form")&&"multipart/form-data"==s.attr("enctype")){var r=new FormData;l.each(t.data,function(t,e){r.append(e.name,e.value)}),l("input[type=file]",s).each(function(){var i=this;l.each(i.files,function(t,e){r.append(i.name,e)})}),l.extend(t,{processData:!1,contentType:!1,data:r})}l.ajax(t)}}l(document).on("click","a[data-ajax=true]",function(t){t.preventDefault(),s(this,{url:this.href,type:"GET",data:[]})}),l(document).on("click","form[data-ajax=true] input[type=image]",function(t){var e=t.target.name,i=l(t.target),n=l(i.parents("form")[0]),o=i.offset();n.data(a,[{name:e+".x",value:Math.round(t.pageX-o.left)},{name:e+".y",value:Math.round(t.pageY-o.top)}]),setTimeout(function(){n.removeData(a)},0)}),l(document).on("click","form[data-ajax=true] :submit",function(t){var e=t.currentTarget.name,i=l(t.target),n=l(i.parents("form")[0]);n.data(a,e?[{name:e,value:t.currentTarget.value}]:[]),n.data(o,i),setTimeout(function(){n.removeData(a),n.removeData(o)},0)}),l(document).on("submit","form[data-ajax=true]",function(t){var e=l(this).data(a)||[],i=l(this).data(o),n=i&&(i.hasClass("cancel")||void 0!==i.attr("formnovalidate"));t.preventDefault(),(n||function(t){var e=l(t).data("unobtrusiveValidation");return!e||!e.validate||e.validate()}(this))&&s(this,{url:this.action,type:this.method||"GET",data:e.concat(l(this).serializeArray())})})}(jQuery),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(d){var i;d.extend(d.fn,{validate:function(t){if(this.length){var n=d.data(this[0],"validator");return n||(this.attr("novalidate","novalidate"),n=new d.validator(t,this[0]),d.data(this[0],"validator",n),n.settings.onsubmit&&(this.on("click.validate",":submit",function(t){n.submitButton=t.currentTarget,d(this).hasClass("cancel")&&(n.cancelSubmit=!0),void 0!==d(this).attr("formnovalidate")&&(n.cancelSubmit=!0)}),this.on("submit.validate",function(i){function t(){var t,e;return n.submitButton&&(n.settings.submitHandler||n.formSubmitted)&&(t=d("<input type='hidden'/>").attr("name",n.submitButton.name).val(d(n.submitButton).val()).appendTo(n.currentForm)),!(n.settings.submitHandler&&!n.settings.debug)||(e=n.settings.submitHandler.call(n,n.currentForm,i),t&&t.remove(),void 0!==e&&e)}return n.settings.debug&&i.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,t()):n.form()?n.pendingRequest?!(n.formSubmitted=!0):t():(n.focusInvalid(),!1)})),n)}t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){var t,e,i;return d(this[0]).is("form")?t=this.validate().form():(i=[],t=!0,e=d(this[0].form).validate(),this.each(function(){(t=e.element(this)&&t)||(i=i.concat(e.errorList))}),e.errorList=i),t},rules:function(t,e){var i,n,o,a,s,r,l=this[0],c=void 0!==this.attr("contenteditable")&&"false"!==this.attr("contenteditable");if(null!=l&&(!l.form&&c&&(l.form=this.closest("form")[0],l.name=this.attr("name")),null!=l.form)){if(t)switch(n=(i=d.data(l.form,"validator").settings).rules,o=d.validator.staticRules(l),t){case"add":d.extend(o,d.validator.normalizeRule(e)),delete o.messages,n[l.name]=o,e.messages&&(i.messages[l.name]=d.extend(i.messages[l.name],e.messages));break;case"remove":return e?(r={},d.each(e.split(/\s/),function(t,e){r[e]=o[e],delete o[e]}),r):(delete n[l.name],o)}return(a=d.validator.normalizeRules(d.extend({},d.validator.classRules(l),d.validator.attributeRules(l),d.validator.dataRules(l),d.validator.staticRules(l)),l)).required&&(s=a.required,delete a.required,a=d.extend({required:s},a)),a.remote&&(s=a.remote,delete a.remote,a=d.extend(a,{remote:s})),a}}}),d.extend(d.expr.pseudos||d.expr[":"],{blank:function(t){return!d.trim(""+d(t).val())},filled:function(t){var e=d(t).val();return null!==e&&!!d.trim(""+e)},unchecked:function(t){return!d(t).prop("checked")}}),d.validator=function(t,e){this.settings=d.extend(!0,{},d.validator.defaults,t),this.currentForm=e,this.init()},d.validator.format=function(i,t){return 1===arguments.length?function(){var t=d.makeArray(arguments);return t.unshift(i),d.validator.format.apply(this,t)}:(void 0===t||(2<arguments.length&&t.constructor!==Array&&(t=d.makeArray(arguments).slice(1)),t.constructor!==Array&&(t=[t]),d.each(t,function(t,e){i=i.replace(new RegExp("\\{"+t+"\\}","g"),function(){return e})})),i)},d.extend(d.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:d([]),errorLabelContainer:d([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(t){this.lastActive=t,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,t,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(t)))},onfocusout:function(t){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)},onkeyup:function(t,e){9===e.which&&""===this.elementValue(t)||-1!==d.inArray(e.keyCode,[16,17,18,20,35,36,37,38,39,40,45,144,225])||(t.name in this.submitted||t.name in this.invalid)&&this.element(t)},onclick:function(t){t.name in this.submitted?this.element(t):t.parentNode.name in this.submitted&&this.element(t.parentNode)},highlight:function(t,e,i){"radio"===t.type?this.findByName(t.name).addClass(e).removeClass(i):d(t).addClass(e).removeClass(i)},unhighlight:function(t,e,i){"radio"===t.type?this.findByName(t.name).removeClass(e).addClass(i):d(t).removeClass(e).addClass(i)}},setDefaults:function(t){d.extend(d.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:d.validator.format("Please enter no more than {0} characters."),minlength:d.validator.format("Please enter at least {0} characters."),rangelength:d.validator.format("Please enter a value between {0} and {1} characters long."),range:d.validator.format("Please enter a value between {0} and {1}."),max:d.validator.format("Please enter a value less than or equal to {0}."),min:d.validator.format("Please enter a value greater than or equal to {0}."),step:d.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){this.labelContainer=d(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||d(this.currentForm),this.containers=d(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var i,a=this.currentForm,n=this.groups={};function t(t){var e=void 0!==d(this).attr("contenteditable")&&"false"!==d(this).attr("contenteditable");if(!this.form&&e&&(this.form=d(this).closest("form")[0],this.name=d(this).attr("name")),a===this.form){var i=d.data(this.form,"validator"),n="on"+t.type.replace(/^validate/,""),o=i.settings;o[n]&&!d(this).is(o.ignore)&&o[n].call(i,this,t)}}d.each(this.settings.groups,function(i,t){"string"==typeof t&&(t=t.split(/\s/)),d.each(t,function(t,e){n[e]=i})}),i=this.settings.rules,d.each(i,function(t,e){i[t]=d.validator.normalizeRule(e)}),d(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']",t).on("click.validate","select, option, [type='radio'], [type='checkbox']",t),this.settings.invalidHandler&&d(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),d.extend(this.submitted,this.errorMap),this.invalid=d.extend({},this.errorMap),this.valid()||d(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var t=0,e=this.currentElements=this.elements();e[t];t++)this.check(e[t]);return this.valid()},element:function(t){var e,i,n=this.clean(t),o=this.validationTargetFor(n),a=this,s=!0;return void 0===o?delete this.invalid[n.name]:(this.prepareElement(o),this.currentElements=d(o),(i=this.groups[o.name])&&d.each(this.groups,function(t,e){e===i&&t!==o.name&&(n=a.validationTargetFor(a.clean(a.findByName(t))))&&n.name in a.invalid&&(a.currentElements.push(n),s=a.check(n)&&s)}),e=!1!==this.check(o),s=s&&e,this.invalid[o.name]=!e,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),d(t).attr("aria-invalid",!e)),s},showErrors:function(e){if(e){var i=this;d.extend(this.errorMap,e),this.errorList=d.map(this.errorMap,function(t,e){return{message:t,element:i.findByName(e)[0]}}),this.successList=d.grep(this.successList,function(t){return!(t.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){d.fn.resetForm&&d(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var t=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(t)},resetElements:function(t){var e;if(this.settings.unhighlight)for(e=0;t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,""),this.findByName(t[e].name).removeClass(this.settings.validClass);else t.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(t){var e,i=0;for(e in t)void 0!==t[e]&&null!==t[e]&&!1!==t[e]&&i++;return i},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(t){t.not(this.containers).text(""),this.addWrapper(t).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{d(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").trigger("focus").trigger("focusin")}catch(t){}},findLastActive:function(){var e=this.lastActive;return e&&1===d.grep(this.errorList,function(t){return t.element.name===e.name}).length&&e},elements:function(){var i=this,n={};return d(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var t=this.name||d(this).attr("name"),e=void 0!==d(this).attr("contenteditable")&&"false"!==d(this).attr("contenteditable");return!t&&i.settings.debug&&window.console&&console.error("%o has no name assigned",this),e&&(this.form=d(this).closest("form")[0],this.name=t),this.form===i.currentForm&&(!(t in n||!i.objectLength(d(this).rules()))&&(n[t]=!0))})},clean:function(t){return d(t)[0]},errors:function(){var t=this.settings.errorClass.split(" ").join(".");return d(this.settings.errorElement+"."+t,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=d([]),this.toHide=d([])},reset:function(){this.resetInternals(),this.currentElements=d([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(t){this.reset(),this.toHide=this.errorsFor(t)},elementValue:function(t){var e,i,n=d(t),o=t.type,a=void 0!==n.attr("contenteditable")&&"false"!==n.attr("contenteditable");return"radio"===o||"checkbox"===o?this.findByName(t.name).filter(":checked").val():"number"===o&&void 0!==t.validity?t.validity.badInput?"NaN":n.val():(e=a?n.text():n.val(),"file"===o?"C:\\fakepath\\"===e.substr(0,12)?e.substr(12):0<=(i=e.lastIndexOf("/"))?e.substr(i+1):0<=(i=e.lastIndexOf("\\"))?e.substr(i+1):e:"string"==typeof e?e.replace(/\r/g,""):e)},check:function(e){e=this.validationTargetFor(this.clean(e));var t,i,n,o,a=d(e).rules(),s=d.map(a,function(t,e){return e}).length,r=!1,l=this.elementValue(e);for(i in"function"==typeof a.normalizer?o=a.normalizer:"function"==typeof this.settings.normalizer&&(o=this.settings.normalizer),o&&(l=o.call(e,l),delete a.normalizer),a){n={method:i,parameters:a[i]};try{if("dependency-mismatch"===(t=d.validator.methods[i].call(this,l,e,n.parameters))&&1===s){r=!0;continue}if(r=!1,"pending"===t)return void(this.toHide=this.toHide.not(this.errorsFor(e)));if(!t)return this.formatAndAdd(e,n),!1}catch(t){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+e.id+", check the '"+n.method+"' method.",t),t instanceof TypeError&&(t.message+=".  Exception occurred when checking element "+e.id+", check the '"+n.method+"' method."),t}}if(!r)return this.objectLength(a)&&this.successList.push(e),!0},customDataMessage:function(t,e){return d(t).data("msg"+e.charAt(0).toUpperCase()+e.substring(1).toLowerCase())||d(t).data("msg")},customMessage:function(t,e){var i=this.settings.messages[t];return i&&(i.constructor===String?i:i[e])},findDefined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]},defaultMessage:function(t,e){"string"==typeof e&&(e={method:e});var i=this.findDefined(this.customMessage(t.name,e.method),this.customDataMessage(t,e.method),!this.settings.ignoreTitle&&t.title||void 0,d.validator.messages[e.method],"<strong>Warning: No message defined for "+t.name+"</strong>"),n=/\$?\{(\d+)\}/g;return"function"==typeof i?i=i.call(this,e.parameters,t):n.test(i)&&(i=d.validator.format(i.replace(n,"{$1}"),e.parameters)),i},formatAndAdd:function(t,e){var i=this.defaultMessage(t,e);this.errorList.push({message:i,element:t,method:e.method}),this.errorMap[t.name]=i,this.submitted[t.name]=i},addWrapper:function(t){return this.settings.wrapper&&(t=t.add(t.parent(this.settings.wrapper))),t},defaultShowErrors:function(){var t,e,i;for(t=0;this.errorList[t];t++)i=this.errorList[t],this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(t=0;this.successList[t];t++)this.showLabel(this.successList[t]);if(this.settings.unhighlight)for(t=0,e=this.validElements();e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return d(this.errorList).map(function(){return this.element})},showLabel:function(t,e){var i,n,o,a,s=this.errorsFor(t),r=this.idOrName(t),l=d(t).attr("aria-describedby");s.length?(s.removeClass(this.settings.validClass).addClass(this.settings.errorClass),s.html(e)):(i=s=d("<"+this.settings.errorElement+">").attr("id",r+"-error").addClass(this.settings.errorClass).html(e||""),this.settings.wrapper&&(i=s.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(i):this.settings.errorPlacement?this.settings.errorPlacement.call(this,i,d(t)):i.insertAfter(t),s.is("label")?s.attr("for",r):0===s.parents("label[for='"+this.escapeCssMeta(r)+"']").length&&(o=s.attr("id"),l?l.match(new RegExp("\\b"+this.escapeCssMeta(o)+"\\b"))||(l+=" "+o):l=o,d(t).attr("aria-describedby",l),(n=this.groups[t.name])&&(a=this,d.each(a.groups,function(t,e){e===n&&d("[name='"+a.escapeCssMeta(t)+"']",a.currentForm).attr("aria-describedby",s.attr("id"))})))),!e&&this.settings.success&&(s.text(""),"string"==typeof this.settings.success?s.addClass(this.settings.success):this.settings.success(s,t)),this.toShow=this.toShow.add(s)},errorsFor:function(t){var e=this.escapeCssMeta(this.idOrName(t)),i=d(t).attr("aria-describedby"),n="label[for='"+e+"'], label[for='"+e+"'] *";return i&&(n=n+", #"+this.escapeCssMeta(i).replace(/\s+/g,", #")),this.errors().filter(n)},escapeCssMeta:function(t){return t.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(t){return this.groups[t.name]||(this.checkable(t)?t.name:t.id||t.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name)),d(t).not(this.settings.ignore)[0]},checkable:function(t){return/radio|checkbox/i.test(t.type)},findByName:function(t){return d(this.currentForm).find("[name='"+this.escapeCssMeta(t)+"']")},getLength:function(t,e){switch(e.nodeName.toLowerCase()){case"select":return d("option:selected",e).length;case"input":if(this.checkable(e))return this.findByName(e.name).filter(":checked").length}return t.length},depend:function(t,e){return!this.dependTypes[typeof t]||this.dependTypes[typeof t](t,e)},dependTypes:{boolean:function(t){return t},string:function(t,e){return!!d(t,e.form).length},function:function(t,e){return t(e)}},optional:function(t){var e=this.elementValue(t);return!d.validator.methods.required.call(this,e,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,d(t).addClass(this.settings.pendingClass),this.pending[t.name]=!0)},stopRequest:function(t,e){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],d(t).removeClass(this.settings.pendingClass),e&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(d(this.currentForm).submit(),this.submitButton&&d("input:hidden[name='"+this.submitButton.name+"']",this.currentForm).remove(),this.formSubmitted=!1):!e&&0===this.pendingRequest&&this.formSubmitted&&(d(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t,e){return e="string"==typeof e&&e||"remote",d.data(t,"previousValue")||d.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,{method:e})})},destroy:function(){this.resetForm(),d(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur").find(".validate-lessThan-blur").off(".validate-lessThan").removeClass("validate-lessThan-blur").find(".validate-lessThanEqual-blur").off(".validate-lessThanEqual").removeClass("validate-lessThanEqual-blur").find(".validate-greaterThanEqual-blur").off(".validate-greaterThanEqual").removeClass("validate-greaterThanEqual-blur").find(".validate-greaterThan-blur").off(".validate-greaterThan").removeClass("validate-greaterThan-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,e){t.constructor===String?this.classRuleSettings[t]=e:d.extend(this.classRuleSettings,t)},classRules:function(t){var e={},i=d(t).attr("class");return i&&d.each(i.split(" "),function(){this in d.validator.classRuleSettings&&d.extend(e,d.validator.classRuleSettings[this])}),e},normalizeAttributeRule:function(t,e,i,n){/min|max|step/.test(i)&&(null===e||/number|range|text/.test(e))&&(n=Number(n),isNaN(n)&&(n=void 0)),n||0===n?t[i]=n:e===i&&"range"!==e&&(t[i]=!0)},attributeRules:function(t){var e,i,n={},o=d(t),a=t.getAttribute("type");for(e in d.validator.methods)i="required"===e?(""===(i=t.getAttribute(e))&&(i=!0),!!i):o.attr(e),this.normalizeAttributeRule(n,a,e,i);return n.maxlength&&/-1|2147483647|524288/.test(n.maxlength)&&delete n.maxlength,n},dataRules:function(t){var e,i,n={},o=d(t),a=t.getAttribute("type");for(e in d.validator.methods)""===(i=o.data("rule"+e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))&&(i=!0),this.normalizeAttributeRule(n,a,e,i);return n},staticRules:function(t){var e={},i=d.data(t.form,"validator");return i.settings.rules&&(e=d.validator.normalizeRule(i.settings.rules[t.name])||{}),e},normalizeRules:function(n,o){return d.each(n,function(t,e){if(!1!==e){if(e.param||e.depends){var i=!0;switch(typeof e.depends){case"string":i=!!d(e.depends,o.form).length;break;case"function":i=e.depends.call(o,o)}i?n[t]=void 0===e.param||e.param:(d.data(o.form,"validator").resetElements(d(o)),delete n[t])}}else delete n[t]}),d.each(n,function(t,e){n[t]=d.isFunction(e)&&"normalizer"!==t?e(o):e}),d.each(["minlength","maxlength"],function(){n[this]&&(n[this]=Number(n[this]))}),d.each(["rangelength","range"],function(){var t;n[this]&&(d.isArray(n[this])?n[this]=[Number(n[this][0]),Number(n[this][1])]:"string"==typeof n[this]&&(t=n[this].replace(/[\[\]]/g,"").split(/[\s,]+/),n[this]=[Number(t[0]),Number(t[1])]))}),d.validator.autoCreateRanges&&(null!=n.min&&null!=n.max&&(n.range=[n.min,n.max],delete n.min,delete n.max),null!=n.minlength&&null!=n.maxlength&&(n.rangelength=[n.minlength,n.maxlength],delete n.minlength,delete n.maxlength)),n},normalizeRule:function(t){if("string"==typeof t){var e={};d.each(t.split(/\s/),function(){e[this]=!0}),t=e}return t},addMethod:function(t,e,i){d.validator.methods[t]=e,d.validator.messages[t]=void 0!==i?i:d.validator.messages[t],e.length<3&&d.validator.addClassRules(t,d.validator.normalizeRule(t))},methods:{required:function(t,e,i){if(!this.depend(i,e))return"dependency-mismatch";if("select"!==e.nodeName.toLowerCase())return this.checkable(e)?0<this.getLength(t,e):null!=t&&0<t.length;var n=d(e).val();return n&&0<n.length},email:function(t,e){return this.optional(e)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)},url:function(t,e){return this.optional(e)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(t)},date:(i=!1,function(t,e){return i||(i=!0,this.settings.debug&&window.console&&console.warn("The `date` method is deprecated and will be removed in version '2.0.0'.\nPlease don't use it, since it relies on the Date constructor, which\nbehaves very differently across browsers and locales. Use `dateISO`\ninstead or one of the locale specific methods in `localizations/`\nand `additional-methods.js`.")),this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())}),dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(t)},number:function(t,e){return this.optional(e)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},minlength:function(t,e,i){var n=d.isArray(t)?t.length:this.getLength(t,e);return this.optional(e)||i<=n},maxlength:function(t,e,i){var n=d.isArray(t)?t.length:this.getLength(t,e);return this.optional(e)||n<=i},rangelength:function(t,e,i){var n=d.isArray(t)?t.length:this.getLength(t,e);return this.optional(e)||n>=i[0]&&n<=i[1]},min:function(t,e,i){return this.optional(e)||i<=t},max:function(t,e,i){return this.optional(e)||t<=i},range:function(t,e,i){return this.optional(e)||t>=i[0]&&t<=i[1]},step:function(t,e,i){function n(t){var e=(""+t).match(/(?:\.(\d+))?$/);return e&&e[1]?e[1].length:0}function o(t){return Math.round(t*Math.pow(10,a))}var a,s=d(e).attr("type"),r="Step attribute on input type "+s+" is not supported.",l=new RegExp("\\b"+s+"\\b"),c=!0;if(s&&!l.test(["text","number","range"].join()))throw new Error(r);return a=n(i),(n(t)>a||o(t)%o(i)!=0)&&(c=!1),this.optional(e)||c},equalTo:function(t,e,i){var n=d(i);return this.settings.onfocusout&&n.not(".validate-equalTo-blur").length&&n.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){d(e).valid()}),t===n.val()},remote:function(a,s,t,r){if(this.optional(s))return"dependency-mismatch";r="string"==typeof r&&r||"remote";var l,e,i,c=this.previousValue(s,r);return this.settings.messages[s.name]||(this.settings.messages[s.name]={}),c.originalMessage=c.originalMessage||this.settings.messages[s.name][r],this.settings.messages[s.name][r]=c.message,t="string"==typeof t&&{url:t}||t,i=d.param(d.extend({data:a},t.data)),c.old===i?c.valid:(c.old=i,(l=this).startRequest(s),(e={})[s.name]=a,d.ajax(d.extend(!0,{mode:"abort",port:"validate"+s.name,dataType:"json",data:e,context:l.currentForm,success:function(t){var e,i,n,o=!0===t||"true"===t;l.settings.messages[s.name][r]=c.originalMessage,o?(n=l.formSubmitted,l.resetInternals(),l.toHide=l.errorsFor(s),l.formSubmitted=n,l.successList.push(s),l.invalid[s.name]=!1,l.showErrors()):(e={},i=t||l.defaultMessage(s,{method:r,parameters:a}),e[s.name]=c.message=i,l.invalid[s.name]=!0,l.showErrors(e)),c.valid=o,l.stopRequest(s,o)}},t)),"pending")}}});var n,o={};return d.ajaxPrefilter?d.ajaxPrefilter(function(t,e,i){var n=t.port;"abort"===t.mode&&(o[n]&&o[n].abort(),o[n]=i)}):(n=d.ajax,d.ajax=function(t){var e=("mode"in t?t:d.ajaxSettings).mode,i=("port"in t?t:d.ajaxSettings).port;return"abort"===e?(o[i]&&o[i].abort(),o[i]=n.apply(this,arguments),o[i]):n.apply(this,arguments)}),d}),function(t){"function"==typeof define&&define.amd?define("jquery.validate.unobtrusive",["jquery-validation"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery-validation")):jQuery.validator.unobtrusive=t(jQuery)}(function(l){var t,s=l.validator,r="unobtrusiveValidation";function c(t,e,i){t.rules[e]=i,t.message&&(t.messages[e]=t.message)}function d(t){return t.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function u(t){return t.substr(0,t.lastIndexOf(".")+1)}function h(t,e){return 0===t.indexOf("*.")&&(t=t.replace("*.",e)),t}function p(t){var e=l(this),i="__jquery_unobtrusive_validation_form_reset";if(!e.data(i)){e.data(i,!0);try{e.data("validator").resetForm()}finally{e.removeData(i)}e.find(".validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors"),e.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").removeData("unobtrusiveContainer").find(">*").removeData("unobtrusiveContainer")}}function f(n){function t(t,e){var i=a[t];i&&l.isFunction(i)&&i.apply(n,e)}var e=l(n),i=e.data(r),o=l.proxy(p,n),a=s.unobtrusive.options||{};return i||(i={options:{errorClass:a.errorClass||"input-validation-error",errorElement:a.errorElement||"span",errorPlacement:function(){(function(t,e){var i=l(this).find("[data-valmsg-for='"+d(e[0].name)+"']"),n=i.attr("data-valmsg-replace"),o=n?!1!==l.parseJSON(n):null;i.removeClass("field-validation-valid").addClass("field-validation-error"),t.data("unobtrusiveContainer",i),o?(i.empty(),t.removeClass("input-validation-error").appendTo(i)):t.hide()}).apply(n,arguments),t("errorPlacement",arguments)},invalidHandler:function(){(function(t,e){var i=l(this).find("[data-valmsg-summary=true]"),n=i.find("ul");n&&n.length&&e.errorList.length&&(n.empty(),i.addClass("validation-summary-errors").removeClass("validation-summary-valid"),l.each(e.errorList,function(){l("<li />").html(this.message).appendTo(n)}))}).apply(n,arguments),t("invalidHandler",arguments)},messages:{},rules:{},success:function(){(function(t){var e=t.data("unobtrusiveContainer");if(e){var i=e.attr("data-valmsg-replace"),n=i?l.parseJSON(i):null;e.addClass("field-validation-valid").removeClass("field-validation-error"),t.removeData("unobtrusiveContainer"),n&&e.empty()}}).apply(n,arguments),t("success",arguments)}},attachValidation:function(){e.off("reset."+r,o).on("reset."+r,o).validate(this.options)},validate:function(){return e.validate(),e.valid()}},e.data(r,i)),i}return s.unobtrusive={adapters:[],parseElement:function(n,t){var e,o,a,s=l(n),r=s.parents("form")[0];r&&((e=f(r)).options.rules[n.name]=o={},e.options.messages[n.name]=a={},l.each(this.adapters,function(){var t="data-val-"+this.name,e=s.attr(t),i={};void 0!==e&&(t+="-",l.each(this.params,function(){i[this]=s.attr(t+this)}),this.adapt({element:n,form:r,message:e,params:i,rules:o,messages:a}))}),l.extend(o,{__dummy__:!0}),t||e.attachValidation())},parse:function(t){var e=l(t),i=e.parents().addBack().filter("form").add(e.find("form")).has("[data-val=true]");e.find("[data-val=true]").each(function(){s.unobtrusive.parseElement(this,!0)}),i.each(function(){var t=f(this);t&&t.attachValidation()})}},(t=s.unobtrusive.adapters).add=function(t,e,i){return i||(i=e,e=[]),this.push({name:t,params:e,adapt:i}),this},t.addBool=function(e,i){return this.add(e,function(t){c(t,i||e,!0)})},t.addMinMax=function(t,n,o,a,e,i){return this.add(t,[e||"min",i||"max"],function(t){var e=t.params.min,i=t.params.max;e&&i?c(t,a,[e,i]):e?c(t,n,e):i&&c(t,o,i)})},t.addSingleVal=function(e,i,n){return this.add(e,[i||"val"],function(t){c(t,n||e,t.params[i])})},s.addMethod("__dummy__",function(t,e,i){return!0}),s.addMethod("regex",function(t,e,i){var n;return!!this.optional(e)||(n=new RegExp(i).exec(t))&&0===n.index&&n[0].length===t.length}),s.addMethod("nonalphamin",function(t,e,i){var n;return i&&(n=(n=t.match(/\W/g))&&n.length>=i),n}),s.methods.extension?(t.addSingleVal("accept","mimtype"),t.addSingleVal("extension","extension")):t.addSingleVal("extension","extension","accept"),t.addSingleVal("regex","pattern"),t.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"),t.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range"),t.addMinMax("minlength","minlength").addMinMax("maxlength","minlength","maxlength"),t.add("equalto",["other"],function(t){var e=u(t.element.name),i=h(t.params.other,e);c(t,"equalTo",l(t.form).find(":input").filter("[name='"+d(i)+"']")[0])}),t.add("required",function(t){"INPUT"===t.element.tagName.toUpperCase()&&"CHECKBOX"===t.element.type.toUpperCase()||c(t,"required",!0)}),t.add("remote",["url","type","additionalfields"],function(n){var o={url:n.params.url,type:n.params.type||"GET",data:{}},a=u(n.element.name);l.each(function(t){return t.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g)}(n.params.additionalfields||n.element.name),function(t,e){var i=h(e,a);o.data[i]=function(){var t=l(n.form).find(":input").filter("[name='"+d(i)+"']");return t.is(":checkbox")?t.filter(":checked").val()||t.filter(":hidden").val()||"":t.is(":radio")?t.filter(":checked").val()||"":t.val()}}),c(n,"remote",o)}),t.add("password",["min","nonalphamin","regex"],function(t){t.params.min&&c(t,"minlength",t.params.min),t.params.nonalphamin&&c(t,"nonalphamin",t.params.nonalphamin),t.params.regex&&c(t,"regex",t.params.regex)}),t.add("fileextensions",["extensions"],function(t){c(t,"extension",t.params.extensions)}),l(function(){s.unobtrusive.parse(document)}),s.unobtrusive}),function(u){function o(t,e,i){var n=[];return(t.reduction||t).filter(u.validity.settings.elementSupport).each(function(){e(this)?n.push(this):a(this,s(i,{field:r(this)}))}),t.reduction=u(n),t}function i(){u.validity.isValidating()&&(u.validity.report.errors++,u.validity.report.valid=!1)}function a(t,e){i(),u.validity.out.raise(u(t),e)}function h(t,e){i(),u.validity.out.raiseAggregate(t,e)}function n(t){var e=0;return t.each(function(){var t=parseFloat(this.value);e+=isNaN(t)?0:t}),e}function s(t,e){for(var i in e)e.hasOwnProperty(i)&&(t=t.replace(RegExp("#\\{"+i+"\\}","g"),e[i]));return l(t)}function r(t){var e=(t=u(t)).prop("id"),i=u.validity.settings.defaultFieldName;if(t.prop("title").length)i=t.prop("title");else if(/^([A-Z0-9][a-z]*)+$/.test(e))i=e.replace(/([A-Z0-9])[a-z]*/g," $&");else if(/^[a-z0-9]+(_[a-z0-9]+)*$/.test(e)){for(t=e.split("_"),e=0;e<t.length;++e)t[e]=l(t[e]);i=t.join(" ")}return u.trim(i)}function l(t){return t.substring?t.substring(0,1).toUpperCase()+t.substring(1,t.length):t}var e;u.validity={settings:u.extend({outputMode:"tooltip",scrollTo:!1,modalErrorsClickable:!0,defaultFieldName:"This field",elementSupport:":text, :password, textarea, select, :radio, :checkbox, input[type='hidden'], input[type='tel'], input[type='email']",argToString:function(t){return t.getDate?[t.getMonth()+1,t.getDate(),t.getFullYear()].join("/"):t+""},debugPrivates:!1},{}),patterns:{integer:/^\d+$/,date:/^((0?\d)|(1[012]))[\/-]([012]?\d|30|31)[\/-]\d{1,4}$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,usd:/^\$?((\d{1,3}(,\d{3})*)|\d+)(\.(\d{2})?)?$/,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,number:/^[+-]?(\d+(\.\d*)?|\.\d+)([Ee]-?\d+)?$/,zip:/^\d{5}(-\d{4})?$/,phone:/^[2-9]\d{2}-\d{3}-\d{4}$/,guid:/^(\{?([0-9a-fA-F]){8}-(([0-9a-fA-F]){4}-){3}([0-9a-fA-F]){12}\}?)$/,time12:/^((0?\d)|(1[012])):[0-5]\d?\s?[aApP]\.?[mM]\.?$/,time24:/^(20|21|22|23|[01]\d|\d)(([:][0-5]\d){1,2})$/,nonHtml:/^[^<>]*$/},messages:{require:"#{field} is required.",match:"#{field} is in an invalid format.",integer:"#{field} must be a positive, whole number.",date:"#{field} must be formatted as a date. (mm/dd/yyyy)",email:"#{field} must be formatted as an email.",usd:"#{field} must be formatted as a US Dollar amount.",url:"#{field} must be formatted as a URL.",number:"#{field} must be formatted as a number.",zip:"#{field} must be formatted as a zipcode ##### or #####-####.",phone:"#{field} must be formatted as a phone number ###-###-####.",guid:"#{field} must be formatted as a guid like {3F2504E0-4F89-11D3-9A0C-0305E82C3301}.",time24:"#{field} must be formatted as a 24 hour time: 23:00.",time12:"#{field} must be formatted as a 12 hour time: 12:00 AM/PM",lessThan:"#{field} must be less than #{max}.",lessThanOrEqualTo:"#{field} must be less than or equal to #{max}.",greaterThan:"#{field} must be greater than #{min}.",greaterThanOrEqualTo:"#{field} must be greater than or equal to #{min}.",range:"#{field} must be between #{min} and #{max}.",tooLong:"#{field} cannot be longer than #{max} characters.",tooShort:"#{field} cannot be shorter than #{min} characters.",nonHtml:"#{field} cannot contain HTML characters.",alphabet:"#{field} contains disallowed characters.",minCharClass:"#{field} cannot have more than #{min} #{charClass} characters.",maxCharClass:"#{field} cannot have less than #{min} #{charClass} characters.",equal:"Values don't match.",distinct:"A value was repeated.",sum:"Values don't add to #{sum}.",sumMax:"The sum of the values must be less than #{max}.",sumMin:"The sum of the values must be greater than #{min}.",radioChecked:"The selected value is not valid.",generic:"Invalid."},out:{start:function(){this.defer("start")},end:function(t){this.defer("end",t)},raise:function(t,e){this.defer("raise",t,e)},raiseAggregate:function(t,e){this.defer("raiseAggregate",t,e)},defer:function(t){var e;(e=(e=u.validity).outputs[e.settings.outputMode])[t].apply(e,Array.prototype.slice.call(arguments,1))}},charClasses:{alphabetical:/\w/g,numeric:/\d/g,alphanumeric:/[A-Za-z0-9]/g,symbol:/[^A-Za-z0-9]/g},outputs:{},__private:void 0,setup:function(t){this.settings=u.extend(this.settings,t),this.__private=this.settings.debugPrivates?e:void 0},report:null,isValidating:function(){return!!this.report},start:function(){this.out.start(),this.report={errors:0,valid:!0}},end:function(){var t=this.report||{errors:0,valid:!0};return this.report=null,this.out.end(t),t},clear:function(){this.start(),this.end()}},u.fn.extend({validity:function(i){return this.each(function(){var t=this;if("form"==this.tagName.toLowerCase()){var e=null;"string"==typeof i?e=function(){u(i).require()}:u.isFunction(i)&&(e=i),i&&u(this).bind("submit",function(){return u.validity.start(),e.apply(t),u.validity.end().valid})}})},require:function(t){return o(this,function(t){return!!u(t).val()&&(null!=u(t).val()&&!!u(t).val().length)},t||u.validity.messages.require)},match:function(e,t){return t||(t=u.validity.messages.match,"string"==typeof e&&u.validity.messages[e]&&(t=u.validity.messages[e])),"string"==typeof e&&(e=u.validity.patterns[e]),o(this,u.isFunction(e)?function(t){return!t.value.length||e(t.value)}:function(t){return e.global&&(e.lastIndex=0),!t.value.length||e.test(t.value)},t)},range:function(e,i,t){return o(this,e.getTime&&i.getTime?function(t){return(t=new Date(t.value))>=new Date(e)&&t<=new Date(i)}:e.substring&&i.substring&&Big?function(t){return(t=new Big(t.value)).greaterThanOrEqualTo(new Big(e))&&t.lessThanOrEqualTo(new Big(i))}:function(t){return t=parseFloat(t.value),e<=t&&t<=i},t||s(u.validity.messages.range,{min:u.validity.settings.argToString(e),max:u.validity.settings.argToString(i)}))},greaterThan:function(e,t){return o(this,e.getTime?function(t){return new Date(t.value)>e}:e.substring&&Big?function(t){return new Big(t.value).greaterThan(new Big(e))}:function(t){return parseFloat(t.value)>e},t||s(u.validity.messages.greaterThan,{min:u.validity.settings.argToString(e)}))},greaterThanOrEqualTo:function(e,t){return o(this,e.getTime?function(t){return new Date(t.value)>=e}:e.substring&&Big?function(t){return new Big(t.value).greaterThanOrEqualTo(new Big(e))}:function(t){return parseFloat(t.value)>=e},t||s(u.validity.messages.greaterThanOrEqualTo,{min:u.validity.settings.argToString(e)}))},lessThan:function(e,t){return o(this,e.getTime?function(t){return new Date(t.value)<e}:e.substring&&Big?function(t){return new Big(t.value).lessThan(new Big(e))}:function(t){return parseFloat(t.value)<e},t||s(u.validity.messages.lessThan,{max:u.validity.settings.argToString(e)}))},lessThanOrEqualTo:function(e,t){return o(this,e.getTime?function(t){return new Date(t.value)<=e}:e.substring&&Big?function(t){return new Big(t.value).lessThanOrEqualTo(new Big(e))}:function(t){return parseFloat(t.value)<=e},t||s(u.validity.messages.lessThanOrEqualTo,{max:u.validity.settings.argToString(e)}))},maxLength:function(e,t){return o(this,function(t){return t.value.length<=e},t||s(u.validity.messages.tooLong,{max:e}))},minLength:function(e,t){return o(this,function(t){return t.value.length>=e},t||s(u.validity.messages.tooShort,{min:e}))},alphabet:function(i,t){var n=[];return o(this,function(t){for(var e=0;e<t.value.length;++e)if(-1==i.indexOf(t.value.charAt(e)))return n.push(t.value.charAt(e)),!1;return!0},t||s(u.validity.messages.alphabet,{chars:n.join(", ")}))},minCharClass:function(e,i,t){return"string"==typeof e&&(e=e.toLowerCase(),u.validity.charClasses[e]&&(e=u.validity.charClasses[e])),o(this,function(t){return(t.value.match(e)||[]).length>=i},t||s(u.validity.messages.minCharClass,{min:i,charClass:e}))},maxCharClass:function(e,i,t){return"string"==typeof e&&(e=e.toLowerCase(),u.validity.charClasses[e]&&(e=u.validity.charClasses[e])),o(this,function(t){return(t.value.match(e)||[]).length<=i},t||s(u.validity.messages.maxCharClass,{max:i,charClass:e}))},nonHtml:function(t){return o(this,function(t){return u.validity.patterns.nonHtml.test(t.value)},t||u.validity.messages.nonHtml)},equal:function(t,e){var i=(this.reduction||this).filter(u.validity.settings.elementSupport),n=function(t){return t},o=u.validity.messages.equal;if(i.length){u.isFunction(t)?(n=t,"string"==typeof e&&(o=e)):"string"==typeof t&&(o=t);var a,s=u.map(i,function(t){return n(t.value)}),r=s[0],l=!0;for(a in s)s[a]!=r&&(l=!1);l||(h(i,o),this.reduction=u([]))}return this},distinct:function(t,e){var i=(this.reduction||this).filter(u.validity.settings.elementSupport),n=function(t){return t},o=u.validity.messages.distinct,a=[],s=[],r=!0;if(i.length){u.isFunction(t)?(n=t,"string"==typeof e&&(o=e)):"string"==typeof t&&(o=t);for(var l=u.map(i,function(t){return n(t.value)}),c=0;c<l.length;++c)if(l[c].length){for(var d=0;d<a.length;++d)a[d]==l[c]&&(r=!1,s.push(l[c]));a.push(l[c])}if(!r){for(a=0,r=(s=u.unique(s)).length;a<r;++a)h(i.filter("[value='"+s[a]+"']"),o);this.reduction=u([])}}return this},sum:function(t,e){var i=(this.reduction||this).filter(u.validity.settings.elementSupport);return i.length&&t!=n(i)&&(h(i,e||s(u.validity.messages.sum,{sum:t})),this.reduction=u([])),this},sumMax:function(t,e){var i=(this.reduction||this).filter(u.validity.settings.elementSupport);return i.length&&t<n(i)&&(h(i,e||s(u.validity.messages.sumMax,{max:t})),this.reduction=u([])),this},sumMin:function(t,e){var i=(this.reduction||this).filter(u.validity.settings.elementSupport);return i.length&&t>n(i)&&(h(i,e||s(u.validity.messages.sumMin,{min:t})),this.reduction=u([])),this},radioChecked:function(t,e){var i=(this.reduction||this).filter(u.validity.settings.elementSupport);i.is(":radio")&&i.find(":checked").val()!=t&&h(i,e||u.validity.messages.radioChecked)},radioNotChecked:function(t,e){var i=(this.reduction||this).filter(u.validity.settings.elementSupport);i.is(":radio")&&i.filter(":checked").val()==t&&h(i,e||u.validity.messages.radioChecked)},checkboxChecked:function(t){return o(this,function(t){return!u(t).is(":checkbox")||u(t).is(":checked")},t||u.validity.messages.nonHtml)},assert:function(t,e){var i=this.reduction||this;if(i.length){if(u.isFunction(t))return o(this,t,e||u.validity.messages.generic);t||(h(i,e||u.validity.messages.generic),this.reduction=u([]))}return this},fail:function(t){return this.assert(!1,t)}}),e={validate:o,addToReport:i,raiseError:a,raiseAggregateError:h,numericSum:n,format:s,infer:r,capitalize:l}}(jQuery),function(o){o.validity.outputs.tooltip={tooltipClass:"validity-tooltip",start:function(){o("."+o.validity.outputs.tooltip.tooltipClass).remove()},end:function(t){!t.valid&&o.validity.settings.scrollTo&&o(document).scrollTop(o("."+o.validity.outputs.tooltip.tooltipClass).offset().top)},raise:function(t,e){var i=t.offset();i.left+=t.width()+18,i.top+=8;var n=o('<div class="validity-tooltip">'+e+'<div class="validity-tooltip-outer"><div class="validity-tooltip-inner"></div></div></div>').click(function(){t.focus(),o(this).fadeOut()}).css(i).hide().appendTo("body").fadeIn();o.validity.settings.fadeOutTooltipsOnFocus&&t.on("focus",function(){n.fadeOut()})},raiseAggregate:function(t,e){t.length&&this.raise(t.filter(":last"),e)}}}(jQuery),function(n){function o(t){return t.attr("id").length?t.attr("id"):t.attr("name")}n.validity.outputs.label={cssClass:"error",start:function(){n("."+n.validity.outputs.label.cssClass).remove()},end:function(t){!t.valid&&n.validity.settings.scrollTo&&(location.hash=n("."+n.validity.outputs.label.cssClass+":eq(0)").attr("for"))},raise:function(t,e){var i="."+n.validity.outputs.label.cssClass+"[for='"+o(t)+"']";n(i).length?n(i).text(e):n("<label/>").attr("for",o(t)).addClass(n.validity.outputs.label.cssClass).text(e).click(function(){t.length&&t[0].select()}).insertAfter(t)},raiseAggregate:function(t,e){t.length&&this.raise(n(t.get(t.length-1)),e)}}}(jQuery),function(n){n.validity.outputs.modal={start:function(){n(".validity-modal-msg").remove()},end:function(t){!t.valid&&n.validity.settings.scrollTo&&(location.hash=n(".validity-modal-msg:eq(0)").attr("id"))},raise:function(t,e){if(t.length){var i=t.offset();t.get(0),i={left:parseInt(i.left+t.width()+4,10)+"px",top:parseInt(i.top-10,10)+"px"},n("<div/>").addClass("validity-modal-msg").css(i).text(e).click(n.validity.settings.modalErrorsClickable?function(){n(this).remove()}:null).appendTo("body")}},raiseAggregate:function(t,e){t.length&&this.raise(n(t.get(t.length-1)),e)}}}(jQuery),function(e){var i=[];e.validity.outputs.summary={start:function(){e(".validity-erroneous").removeClass("validity-erroneous"),i=[]},end:function(){if(e(".validity-summary-container").stop().hide().find("ul").html(""),i.length){for(var t=0;t<i.length;++t)e("<li/>").text(i[t]).appendTo(".validity-summary-container ul");e(".validity-summary-container").show(),e.validity.settings.scrollTo&&(location.hash=e(".validity-erroneous:eq(0)").attr("id"))}},raise:function(t,e){i.push(e),t.addClass("validity-erroneous")},raiseAggregate:function(t,e){this.raise(t,e)},container:function(){document.write('<div class="validity-summary-container">The form didn\'t submit for the following reason(s):<ul></ul></div>')}}}(jQuery),function(L){L.extend({tablesorter:new function(){function C(){var t=arguments[0],e=1<arguments.length?Array.prototype.slice.call(arguments):t;"undefined"!=typeof console&&void 0!==console.log?console[/error/i.test(t)?"error":/warn/i.test(t)?"warn":"log"](e):alert(e)}function w(t,e){C(t+" ("+((new Date).getTime()-e.getTime())+"ms)")}function _(t){for(var e in t)return!1;return!0}function S(t,e,i){if(!e)return"";var n,o=t.config,a=o.textExtraction||"",s="basic"===a?L(e).attr(o.textAttribute)||e.textContent||e.innerText||L(e).text()||"":"function"==typeof a?a(e,t,i):"function"==typeof(n=x.getColumnData(t,a,i))?n(e,t,i):e.textContent||e.innerText||L(e).text()||"";return L.trim(s)}function f(t){var e,i,n,o,a,s,r,l,c,d,u,h=t.config,p=h.$tbodies=h.$table.children("tbody:not(."+h.cssInfoBlock+")"),f=0,m="",g=p.length;if(0===g)return h.debug?C("Warning: *Empty table!* Not building a parser cache"):"";for(h.debug&&(u=new Date,C("Detecting parsers for each column")),e=[],i=[];f<g;){if((n=p[f].rows)[f])for(o=h.columns,a=0;a<o;a++){if(s=h.$headers.filter('[data-column="'+a+'"]:last'),r=x.getColumnData(t,h.headers,a),d=x.getParserById(x.getData(s,r,"extractor")),c=x.getParserById(x.getData(s,r,"sorter")),l="false"===x.getData(s,r,"parser"),h.empties[a]=(x.getData(s,r,"empty")||h.emptyTo||(h.emptyToBottom?"bottom":"top")).toLowerCase(),h.strings[a]=(x.getData(s,r,"string")||h.stringTo||"max").toLowerCase(),l&&(c=x.getParserById("no-parser")),d=d||!1,!c)t:{s=t,r=n,l=-1,c=a;var v=void 0,_=x.parsers.length,y=!1,b="";for(v=!0;""===b&&v;)r[++l]?(b=S(s,y=r[l].cells[c],c),s.config.debug&&C("Checking if value was empty on row "+l+", column: "+c+': "'+b+'"')):v=!1;for(;0<=--_;)if((v=x.parsers[_])&&"text"!==v.id&&v.is&&v.is(b,s,y)){c=v;break t}c=x.getParserById("text")}h.debug&&(m+="column:"+a+"; extractor:"+d.id+"; parser:"+c.id+"; string:"+h.strings[a]+"; empty: "+h.empties[a]+"\n"),i[a]=c,e[a]=d}f+=i.length?g:1}h.debug&&(C(m||"No parsers detected"),w("Completed detecting parsers",u)),h.parsers=i,h.extractors=e}function r(t){var e,i,n,o,a,s,r,l,c,d,u,h=t.config,p=h.$table.children("tbody"),f=h.extractors,m=h.parsers;if(h.cache={},h.totalRows=0,!m)return h.debug?C("Warning: *Empty table!* Not building a cache"):"";for(h.debug&&(l=new Date),h.showProcessing&&x.isProcessing(t,!0),a=0;a<p.length;a++)if(u=[],e=h.cache[a]={normalized:[]},!p.eq(a).hasClass(h.cssInfoBlock)){for(c=p[a]&&p[a].rows.length||0,n=0;n<c;++n)if(d={child:[]},r=[],(s=L(p[a].rows[n])).hasClass(h.cssChildRow)&&0!==n)i=e.normalized.length-1,e.normalized[i][h.columns].$row=e.normalized[i][h.columns].$row.add(s),s.prev().hasClass(h.cssChildRow)||s.prev().addClass(x.css.cssHasChild),d.child[i]=L.trim(s[0].textContent||s[0].innerText||s.text()||"");else{for(d.$row=s,d.order=n,o=0;o<h.columns;++o)void 0===m[o]?h.debug&&C("No parser found for cell:",s[0].cells[o],"does it have a header?"):(i=S(t,s[0].cells[o],o),i=void 0===f[o].id?i:f[o].format(i,t,s[0].cells[o],o),i="no-parser"===m[o].id?"":m[o].format(i,t,s[0].cells[o],o),r.push(h.ignoreCase&&"string"==typeof i?i.toLowerCase():i),"numeric"===(m[o].type||"").toLowerCase()&&(u[o]=Math.max(Math.abs(i)||0,u[o]||0)));r[h.columns]=d,e.normalized.push(r)}e.colMax=u,h.totalRows+=e.normalized.length}h.showProcessing&&x.isProcessing(t),h.debug&&w("Building cache for "+c+" rows",l)}function m(t,e){var i,n,o,a,s,r,l=t.config,c=l.widgetOptions,d=t.tBodies,u=[],h=l.cache;if(_(h))return l.appender?l.appender(t,u):t.isUpdating?l.$table.trigger("updateComplete",t):"";for(l.debug&&(r=new Date),s=0;s<d.length;s++)if((i=L(d[s])).length&&!i.hasClass(l.cssInfoBlock)){for(o=x.processTbody(t,i,!0),n=(i=h[s].normalized).length,a=0;a<n;a++)u.push(i[a][l.columns].$row),l.appender&&(!l.pager||l.pager.removeRows&&c.pager_removeRows||l.pager.ajax)||o.append(i[a][l.columns].$row);x.processTbody(t,o,!1)}l.appender&&l.appender(t,u),l.debug&&w("Rebuilt table",r),e||l.appender||x.applyWidget(t),t.isUpdating&&l.$table.trigger("updateComplete",t)}function c(t){return/^d/i.test(t)||1===t}function s(e){var i,n,o,a,s,r,t,l=e.config;l.headerList=[],l.headerContent=[],l.debug&&(t=new Date),l.columns=x.computeColumnIndex(l.$table.children("thead, tfoot").children("tr")),a=l.cssIcon?'<i class="'+(l.cssIcon===x.css.icon?x.css.icon:l.cssIcon+" "+x.css.icon)+'"></i>':"",l.$headers=L(e).find(l.selectorHeaders).each(function(t){n=L(this),i=x.getColumnData(e,l.headers,t,!0),l.headerContent[t]=L(this).html(),""!==l.headerTemplate&&(s=l.headerTemplate.replace(/\{content\}/g,L(this).html()).replace(/\{icon\}/g,a),l.onRenderTemplate&&(o=l.onRenderTemplate.apply(n,[t,s]))&&"string"==typeof o&&(s=o),L(this).html('<div class="'+x.css.headerIn+'">'+s+"</div>")),l.onRenderHeader&&l.onRenderHeader.apply(n,[t]),this.column=parseInt(L(this).attr("data-column"),10),this.order=c(x.getData(n,i,"sortInitialOrder")||l.sortInitialOrder)?[1,0,2]:[0,1,2],this.count=-1,this.lockedOrder=!1,void 0!==(r=x.getData(n,i,"lockedOrder")||!1)&&!1!==r&&(this.order=this.lockedOrder=c(r)?[1,1,1]:[0,0,0]),n.addClass(x.css.header+" "+l.cssHeader),l.headerList[t]=this,n.parent().addClass(x.css.headerRow+" "+l.cssHeaderRow).attr("role","row"),l.tabIndex&&n.attr("tabindex",0)}).attr({scope:"col",role:"columnheader"}),v(e),l.debug&&(w("Built headers:",t),C(l.$headers))}function g(t,e,i){var n=t.config;n.$table.find(n.selectorRemove).remove(),f(t),r(t),k(n.$table,e,i)}function v(i){var n,o,a,s=i.config;s.$headers.each(function(t,e){o=L(e),a=x.getColumnData(i,s.headers,t,!0),n="false"===x.getData(e,a,"sorter")||"false"===x.getData(e,a,"parser"),e.sortDisabled=n,o[n?"addClass":"removeClass"]("sorter-false").attr("aria-disabled",""+n),i.id&&(n?o.removeAttr("aria-controls"):o.attr("aria-controls",i.id))})}function y(t){var e,i,n=t.config,o=n.sortList,a=o.length,s=x.css.sortNone+" "+n.cssNone,r=[x.css.sortAsc+" "+n.cssAsc,x.css.sortDesc+" "+n.cssDesc],l=["ascending","descending"],c=L(t).find("tfoot tr").children().add(n.$extraHeaders).removeClass(r.join(" "));for(n.$headers.removeClass(r.join(" ")).addClass(s).attr("aria-sort","none"),e=0;e<a;e++)if(2!==o[e][1]&&(t=n.$headers.not(".sorter-false").filter('[data-column="'+o[e][0]+'"]'+(1===a?":last":""))).length){for(i=0;i<t.length;i++)t[i].sortDisabled||t.eq(i).removeClass(s).addClass(r[o[e][1]]).attr("aria-sort",l[o[e][1]]);c.length&&c.filter('[data-column="'+o[e][0]+'"]').removeClass(s).addClass(r[o[e][1]])}n.$headers.not(".sorter-false").each(function(){var t=L(this),e=this.order[(this.count+1)%(n.sortReset?3:2)];e=t.text()+": "+x.language[t.hasClass(x.css.sortAsc)?"sortAsc":t.hasClass(x.css.sortDesc)?"sortDesc":"sortNone"]+x.language[0===e?"nextAsc":1===e?"nextDesc":"nextNone"];t.attr("aria-label",e)})}function b(o){var a,t,s,r,e,l,c,d,u,h,p=0,f=o.config,m=f.textSorter||"",g=f.sortList,v=g.length,i=o.tBodies.length;if(!f.serverSideSorting&&!_(f.cache)){for(f.debug&&(e=new Date),t=0;t<i;t++)l=f.cache[t].colMax,f.cache[t].normalized.sort(function(t,e){for(a=0;a<v&&(r=g[a][0],c=g[a][1],p=0===c,!f.sortStable||t[r]!==e[r]||1!==v);a++)if(d=(s=/n/i.test((i=f.parsers,n=r,i&&i[n]&&i[n].type||"")))&&f.strings[r]?(s="boolean"==typeof f.string[f.strings[r]]?(p?1:-1)*(f.string[f.strings[r]]?-1:1):f.strings[r]&&f.string[f.strings[r]]||0,f.numberSorter?f.numberSorter(t[r],e[r],p,l[r],o):x["sortNumeric"+(p?"Asc":"Desc")](t[r],e[r],s,l[r],r,o)):(u=p?t:e,h=p?e:t,"function"==typeof m?m(u[r],h[r],p,r,o):"object"==typeof m&&m.hasOwnProperty(r)?m[r](u[r],h[r],p,r,o):x["sortNatural"+(p?"Asc":"Desc")](t[r],e[r],r,o,f)))return d;var i,n;return t[f.columns].order-e[f.columns].order});f.debug&&w("Sorting on "+g.toString()+" and dir "+c+" time",e)}}function o(t,e){var i=t[0];i.isUpdating&&t.trigger("updateComplete",i),L.isFunction(e)&&e(t[0])}function k(t,e,i){var n=t[0].config.sortList;!1!==e&&!t[0].isProcessing&&n.length?t.trigger("sorton",[n,function(){o(t,i)},!0]):(o(t,i),x.applyWidget(t[0],!1))}function l(u){var h=u.config,p=h.$table;p.unbind("sortReset update updateRows updateCell updateAll addRows updateComplete sorton appendCache updateCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave ".split(" ").join(h.namespace+" ")).bind("sortReset"+h.namespace,function(t,e){t.stopPropagation(),h.sortList=[],y(u),b(u),m(u),L.isFunction(e)&&e(u)}).bind("updateAll"+h.namespace,function(t,e,i){t.stopPropagation(),u.isUpdating=!0,x.refreshWidgets(u,!0,!0),x.restoreHeaders(u),s(u),x.bindEvents(u,h.$headers,!0),l(u),g(u,e,i)}).bind("update"+h.namespace+" updateRows"+h.namespace,function(t,e,i){t.stopPropagation(),u.isUpdating=!0,v(u),g(u,e,i)}).bind("updateCell"+h.namespace,function(t,e,i,n){var o,a,s;t.stopPropagation(),u.isUpdating=!0,p.find(h.selectorRemove).remove(),a=p.find("tbody"),s=L(e),t=a.index(L.fn.closest?s.closest("tbody"):s.parents("tbody").filter(":first")),o=L.fn.closest?s.closest("tr"):s.parents("tr").filter(":first"),e=s[0],a.length&&0<=t&&(a=a.eq(t).find("tr").index(o),s=s.index(),h.cache[t].normalized[a][h.columns].$row=o,o=void 0===h.extractors[s].id?S(u,e,s):h.extractors[s].format(S(u,e,s),u,e,s),e="no-parser"===h.parsers[s].id?"":h.parsers[s].format(o,u,e,s),h.cache[t].normalized[a][s]=h.ignoreCase&&"string"==typeof e?e.toLowerCase():e,"numeric"===(h.parsers[s].type||"").toLowerCase()&&(h.cache[t].colMax[s]=Math.max(Math.abs(e)||0,h.cache[t].colMax[s]||0)),k(p,i,n))}).bind("addRows"+h.namespace,function(t,e,i,n){if(t.stopPropagation(),u.isUpdating=!0,_(h.cache))v(u),g(u,i,n);else{var o,a,s,r,l,c=(e=L(e).attr("role","row")).filter("tr").length,d=p.find("tbody").index(e.parents("tbody").filter(":first"));for(h.parsers&&h.parsers.length||f(u),t=0;t<c;t++){for(a=e[t].cells.length,l=[],r={child:[],$row:e.eq(t),order:h.cache[d].normalized.length},o=0;o<a;o++)s=void 0===h.extractors[o].id?S(u,e[t].cells[o],o):h.extractors[o].format(S(u,e[t].cells[o],o),u,e[t].cells[o],o),s="no-parser"===h.parsers[o].id?"":h.parsers[o].format(s,u,e[t].cells[o],o),l[o]=h.ignoreCase&&"string"==typeof s?s.toLowerCase():s,"numeric"===(h.parsers[o].type||"").toLowerCase()&&(h.cache[d].colMax[o]=Math.max(Math.abs(l[o])||0,h.cache[d].colMax[o]||0));l.push(r),h.cache[d].normalized.push(l)}k(p,i,n)}}).bind("updateComplete"+h.namespace,function(){u.isUpdating=!1}).bind("sorton"+h.namespace,function(t,e,i,n){var o=u.config;t.stopPropagation(),p.trigger("sortStart",this),function(t,e){var i,n,o,a,s,r=t.config,l=e||r.sortList;r.sortList=[],L.each(l,function(t,e){if(a=parseInt(e[0],10),o=r.$headers.filter('[data-column="'+a+'"]:last')[0]){switch(n=(n=(""+e[1]).match(/^(1|d|s|o|n)/))?n[0]:""){case"1":case"d":n=1;break;case"s":n=s||0;break;case"o":i=o.order[(s||0)%(r.sortReset?3:2)],n=0===i?1:1===i?0:2;break;case"n":o.count+=1,n=o.order[o.count%(r.sortReset?3:2)];break;default:n=0}s=0===t?n:s,i=[a,parseInt(n,10)||0],r.sortList.push(i),n=L.inArray(i[1],o.order),o.count=0<=n?n:i[1]%(r.sortReset?3:2)}})}(u,e),y(u),o.delayInit&&_(o.cache)&&r(u),p.trigger("sortBegin",this),b(u),m(u,n),p.trigger("sortEnd",this),x.applyWidget(u),L.isFunction(i)&&i(u)}).bind("appendCache"+h.namespace,function(t,e,i){t.stopPropagation(),m(u,i),L.isFunction(e)&&e(u)}).bind("updateCache"+h.namespace,function(t,e){h.parsers&&h.parsers.length||f(u),r(u),L.isFunction(e)&&e(u)}).bind("applyWidgetId"+h.namespace,function(t,e){t.stopPropagation(),x.getWidgetById(e).format(u,h,h.widgetOptions)}).bind("applyWidgets"+h.namespace,function(t,e){t.stopPropagation(),x.applyWidget(u,e)}).bind("refreshWidgets"+h.namespace,function(t,e,i){t.stopPropagation(),x.refreshWidgets(u,e,i)}).bind("destroy"+h.namespace,function(t,e,i){t.stopPropagation(),x.destroy(u,e,i)}).bind("resetToLoadState"+h.namespace,function(){x.refreshWidgets(u,!0,!0),h=L.extend(!0,x.defaults,h.originalSettings),u.hasInitialized=!1,x.setup(u,h)})}var x=this;x.version="2.17.8",x.parsers=[],x.widgets=[],x.defaults={theme:"default",widthFixed:!1,showProcessing:!1,headerTemplate:"{content}",onRenderTemplate:null,onRenderHeader:null,cancelSelection:!0,tabIndex:!0,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",sortResetKey:"ctrlKey",usNumberFormat:!0,delayInit:!1,serverSideSorting:!1,headers:{},ignoreCase:!0,sortForce:null,sortList:[],sortAppend:null,sortStable:!1,sortInitialOrder:"asc",sortLocaleCompare:!1,sortReset:!1,sortRestart:!1,emptyTo:"bottom",stringTo:"max",textExtraction:"basic",textAttribute:"data-text",textSorter:null,numberSorter:null,widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:!0,initialized:null,tableClass:"",cssAsc:"",cssDesc:"",cssNone:"",cssHeader:"",cssHeaderRow:"",cssProcessing:"",cssChildRow:"tablesorter-childRow",cssIcon:"tablesorter-icon",cssInfoBlock:"tablesorter-infoOnly",selectorHeaders:"> thead th, > thead td",selectorSort:"th, td",selectorRemove:".remove-me",debug:!1,headerList:[],empties:{},strings:{},parsers:[]},x.css={table:"tablesorter",cssHasChild:"tablesorter-hasChildRow",childRow:"tablesorter-childRow",header:"tablesorter-header",headerRow:"tablesorter-headerRow",headerIn:"tablesorter-header-inner",icon:"tablesorter-icon",info:"tablesorter-infoOnly",processing:"tablesorter-processing",sortAsc:"tablesorter-headerAsc",sortDesc:"tablesorter-headerDesc",sortNone:"tablesorter-headerUnSorted"},x.language={sortAsc:"Ascending sort applied, ",sortDesc:"Descending sort applied, ",sortNone:"No sort applied, ",nextAsc:"activate to apply an ascending sort",nextDesc:"activate to apply a descending sort",nextNone:"activate to remove the sort"},x.log=C,x.benchmark=w,x.construct=function(e){return this.each(function(){var t=L.extend(!0,{},x.defaults,e);t.originalSettings=e,!this.hasInitialized&&x.buildTable&&"TABLE"!==this.tagName?x.buildTable(this,t):x.setup(this,t)})},x.setup=function(e,i){if(!e||!e.tHead||0===e.tBodies.length||!0===e.hasInitialized)return i.debug?C("ERROR: stopping initialization! No table, thead, tbody or tablesorter has already been initialized"):"";var t,n="",o=L(e),a=L.metadata;e.hasInitialized=!1,e.isProcessing=!0,e.config=i,L.data(e,"tablesorter",i),i.debug&&L.data(e,"startoveralltimer",new Date),i.supportsDataObject=((t=L.fn.jquery.split("."))[0]=parseInt(t[0],10),1<t[0]||1===t[0]&&4<=parseInt(t[1],10)),i.string={max:1,min:-1,emptymin:1,emptymax:-1,zero:0,none:0,null:0,top:!0,bottom:!1},i.emptyTo=i.emptyTo.toLowerCase(),i.stringTo=i.stringTo.toLowerCase(),/tablesorter\-/.test(o.attr("class"))||(n=""!==i.theme?" tablesorter-"+i.theme:""),i.table=e,i.$table=o.addClass(x.css.table+" "+i.tableClass+n).attr("role","grid"),i.$headers=o.find(i.selectorHeaders),i.namespace=i.namespace?"."+i.namespace.replace(/\W/g,""):".tablesorter"+Math.random().toString(16).slice(2),i.$table.children().children("tr").attr("role","row"),i.$tbodies=o.children("tbody:not(."+i.cssInfoBlock+")").attr({"aria-live":"polite","aria-relevant":"all"}),i.$table.find("caption").length&&i.$table.attr("aria-labelledby","theCaption"),i.widgetInit={},i.textExtraction=i.$table.attr("data-text-extraction")||i.textExtraction||"basic",s(e),function(t){var e,i,n=t.config;n.widthFixed&&0===n.$table.find("colgroup").length&&(e=L("<colgroup>"),i=L(t).width(),L(t.tBodies).not("."+n.cssInfoBlock).find("tr:first").children(":visible").each(function(){e.append(L("<col>").css("width",parseInt(L(this).width()/i*1e3,10)/10+"%"))}),n.$table.prepend(e))}(e),f(e),i.totalRows=0,i.delayInit||r(e),x.bindEvents(e,i.$headers,!0),l(e),i.supportsDataObject&&void 0!==o.data().sortlist?i.sortList=o.data().sortlist:a&&o.metadata()&&o.metadata().sortlist&&(i.sortList=o.metadata().sortlist),x.applyWidget(e,!0),0<i.sortList.length?o.trigger("sorton",[i.sortList,{},!i.initWidgets,!0]):(y(e),i.initWidgets&&x.applyWidget(e,!1)),i.showProcessing&&o.unbind("sortBegin"+i.namespace+" sortEnd"+i.namespace).bind("sortBegin"+i.namespace+" sortEnd"+i.namespace,function(t){clearTimeout(i.processTimer),x.isProcessing(e),"sortBegin"===t.type&&(i.processTimer=setTimeout(function(){x.isProcessing(e,!0)},500))}),e.hasInitialized=!0,e.isProcessing=!1,i.debug&&x.benchmark("Overall initialization time",L.data(e,"startoveralltimer")),o.trigger("tablesorter-initialized",e),"function"==typeof i.initialized&&i.initialized(e)},x.getColumnData=function(t,e,i,n){if(null!=e){var o,a=(t=L(t)[0]).config;if(e[i])return n?e[i]:e[a.$headers.index(a.$headers.filter('[data-column="'+i+'"]:last'))];for(o in e)if("string"==typeof o&&(t=n?a.$headers.eq(i).filter(o):a.$headers.filter('[data-column="'+i+'"]:last').filter(o)).length)return e[o]}},x.computeColumnIndex=function(t){var e,i,n,o,a,s,r,l,c,d,u=[],h=0;for(e=0;e<t.length;e++)for(a=t[e].cells,i=0;i<a.length;i++){for(n=a[i],o=L(n),s=n.parentNode.rowIndex,o.index(),r=n.rowSpan||1,l=n.colSpan||1,void 0===u[s]&&(u[s]=[]),n=0;n<u[s].length+1;n++)if(void 0===u[s][n]){c=n;break}for(h=Math.max(c,h),o.attr({"data-column":c}),n=s;n<s+r;n++)for(void 0===u[n]&&(u[n]=[]),d=u[n],o=c;o<c+l;o++)d[o]="x"}return h+1},x.isProcessing=function(t,e,i){var n=(t=L(t))[0].config,o=i||t.find("."+x.css.header);e?(void 0!==i&&0<n.sortList.length&&(o=o.filter(function(){return!this.sortDisabled&&0<=x.isValueInArray(parseFloat(L(this).attr("data-column")),n.sortList)})),t.add(o).addClass(x.css.processing+" "+n.cssProcessing)):t.add(o).removeClass(x.css.processing+" "+n.cssProcessing)},x.processTbody=function(t,e,i){if(t=L(t)[0],i)return t.isProcessing=!0,e.before('<span class="tablesorter-savemyplace"/>'),L.fn.detach?e.detach():e.remove();i=L(t).find("span.tablesorter-savemyplace"),e.insertAfter(i),i.remove(),t.isProcessing=!1},x.clearTableBody=function(t){L(t)[0].config.$tbodies.children().detach()},x.bindEvents=function(n,o,t){var a,s=(n=L(n)[0]).config;!0!==t&&(s.$extraHeaders=s.$extraHeaders?s.$extraHeaders.add(o):o),o.find(s.selectorSort).add(o.filter(s.selectorSort)).unbind(["mousedown","mouseup","sort","keyup",""].join(s.namespace+" ")).bind(["mousedown","mouseup","sort","keyup",""].join(s.namespace+" "),function(t,e){var i;if(i=t.type,!(1!==(t.which||t.button)&&!/sort|keyup/.test(i)||"keyup"===i&&13!==t.which||"mouseup"===i&&!0!==e&&250<(new Date).getTime()-a)){if("mousedown"===i)return a=(new Date).getTime(),/(input|select|button|textarea)/i.test(t.target.tagName)?"":!s.cancelSelection;s.delayInit&&_(s.cache)&&r(n),i=L.fn.closest?L(this).closest("th, td")[0]:/TH|TD/.test(this.tagName)?this:L(this).parents("th, td")[0],(i=s.$headers[o.index(i)]).sortDisabled||function t(e,i,n){if(e.isUpdating)return setTimeout(function(){t(e,i,n)},50);var o,a,s,r,l=e.config,c=!n[l.sortMultiSortKey],d=l.$table;if(d.trigger("sortStart",e),i.count=n[l.sortResetKey]?2:(i.count+1)%(l.sortReset?3:2),l.sortRestart&&(a=i,l.$headers.each(function(){this===a||!c&&L(this).is("."+x.css.sortDesc+",."+x.css.sortAsc)||(this.count=-1)})),a=i.column,c){if(l.sortList=[],null!==l.sortForce)for(o=l.sortForce,s=0;s<o.length;s++)o[s][0]!==a&&l.sortList.push(o[s]);if((o=i.order[i.count])<2&&(l.sortList.push([a,o]),1<i.colSpan))for(s=1;s<i.colSpan;s++)l.sortList.push([a+s,o])}else{if(l.sortAppend&&1<l.sortList.length)for(s=0;s<l.sortAppend.length;s++)0<=(r=x.isValueInArray(l.sortAppend[s][0],l.sortList))&&l.sortList.splice(r,1);if(0<=x.isValueInArray(a,l.sortList))for(s=0;s<l.sortList.length;s++)r=l.sortList[s],o=l.$headers.filter('[data-column="'+r[0]+'"]:last')[0],r[0]===a&&(r[1]=o.order[i.count],2===r[1]&&(l.sortList.splice(s,1),o.count=-1));else if((o=i.order[i.count])<2&&(l.sortList.push([a,o]),1<i.colSpan))for(s=1;s<i.colSpan;s++)l.sortList.push([a+s,o])}if(null!==l.sortAppend)for(o=l.sortAppend,s=0;s<o.length;s++)o[s][0]!==a&&l.sortList.push(o[s]);d.trigger("sortBegin",e),setTimeout(function(){y(e),b(e),m(e),d.trigger("sortEnd",e)},1)}(n,i,t)}}),s.cancelSelection&&o.attr("unselectable","on").bind("selectstart",!1).css({"user-select":"none",MozUserSelect:"none"})},x.restoreHeaders=function(t){var e=L(t)[0].config;e.$table.find(e.selectorHeaders).each(function(t){L(this).find("."+x.css.headerIn).length&&L(this).html(e.headerContent[t])})},x.destroy=function(t,e,i){if((t=L(t)[0]).hasInitialized){x.refreshWidgets(t,!0,!0);var n=L(t),o=t.config,a=n.find("thead:first"),s=a.find("tr."+x.css.headerRow).removeClass(x.css.headerRow+" "+o.cssHeaderRow),r=n.find("tfoot:first > tr").children("th, td");!1===e&&0<=L.inArray("uitheme",o.widgets)&&(n.trigger("applyWidgetId",["uitheme"]),n.trigger("applyWidgetId",["zebra"])),a.find("tr").not(s).remove(),n.removeData("tablesorter").unbind("sortReset update updateAll updateRows updateCell addRows updateComplete sorton appendCache updateCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave keypress sortBegin sortEnd resetToLoadState ".split(" ").join(o.namespace+" ")),o.$headers.add(r).removeClass([x.css.header,o.cssHeader,o.cssAsc,o.cssDesc,x.css.sortAsc,x.css.sortDesc,x.css.sortNone].join(" ")).removeAttr("data-column").removeAttr("aria-label").attr("aria-disabled","true"),s.find(o.selectorSort).unbind(["mousedown","mouseup","keypress",""].join(o.namespace+" ")),x.restoreHeaders(t),n.toggleClass(x.css.table+" "+o.tableClass+" tablesorter-"+o.theme,!1===e),t.hasInitialized=!1,delete t.config.cache,"function"==typeof i&&i(t)}},x.regex={chunk:/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,chunks:/(^\\0|\\0$)/,hex:/^0x[0-9a-f]+$/i},x.sortNatural=function(t,e){if(t===e)return 0;var i,n,o,a,s,r;if((n=x.regex).hex.test(e)){if((i=parseInt(t.match(n.hex),16))<(o=parseInt(e.match(n.hex),16)))return-1;if(o<i)return 1}for(i=t.replace(n.chunk,"\\0$1\\0").replace(n.chunks,"").split("\\0"),n=e.replace(n.chunk,"\\0$1\\0").replace(n.chunks,"").split("\\0"),r=Math.max(i.length,n.length),s=0;s<r;s++){if(o=isNaN(i[s])?i[s]||0:parseFloat(i[s])||0,a=isNaN(n[s])?n[s]||0:parseFloat(n[s])||0,isNaN(o)!==isNaN(a))return isNaN(o)?1:-1;if(typeof o!=typeof a&&(o+="",a+=""),o<a)return-1;if(a<o)return 1}return 0},x.sortNaturalAsc=function(t,e,i,n,o){return t===e?0:(i=o.string[o.empties[i]||o.emptyTo],""===t&&0!==i?"boolean"==typeof i?i?-1:1:-i||-1:""===e&&0!==i?"boolean"==typeof i?i?1:-1:i||1:x.sortNatural(t,e))},x.sortNaturalDesc=function(t,e,i,n,o){return t===e?0:(i=o.string[o.empties[i]||o.emptyTo],""===t&&0!==i?"boolean"==typeof i?i?-1:1:i||1:""===e&&0!==i?"boolean"==typeof i?i?1:-1:-i||-1:x.sortNatural(e,t))},x.sortText=function(t,e){return e<t?1:t<e?-1:0},x.getTextValue=function(t,e,i){if(i){var n=t?t.length:0,o=i+e;for(i=0;i<n;i++)o+=t.charCodeAt(i);return e*o}return 0},x.sortNumericAsc=function(t,e,i,n,o,a){return t===e?0:(o=(a=a.config).string[a.empties[o]||a.emptyTo],""===t&&0!==o?"boolean"==typeof o?o?-1:1:-o||-1:""===e&&0!==o?"boolean"==typeof o?o?1:-1:o||1:(isNaN(t)&&(t=x.getTextValue(t,i,n)),isNaN(e)&&(e=x.getTextValue(e,i,n)),t-e))},x.sortNumericDesc=function(t,e,i,n,o,a){return t===e?0:(o=(a=a.config).string[a.empties[o]||a.emptyTo],""===t&&0!==o?"boolean"==typeof o?o?-1:1:o||1:""===e&&0!==o?"boolean"==typeof o?o?1:-1:-o||-1:(isNaN(t)&&(t=x.getTextValue(t,i,n)),isNaN(e)&&(e=x.getTextValue(e,i,n)),e-t))},x.sortNumeric=function(t,e){return t-e},x.characterEquivalents={a:"áàâãäąå",A:"ÁÀÂÃÄĄÅ",c:"çćč",C:"ÇĆČ",e:"éèêëěę",E:"ÉÈÊËĚĘ",i:"íìİîïı",I:"ÍÌİÎÏ",o:"óòôõö",O:"ÓÒÔÕÖ",ss:"ß",SS:"ẞ",u:"úùûüů",U:"ÚÙÛÜŮ"},x.replaceAccents=function(t){var e,i="[",n=x.characterEquivalents;if(!x.characterRegex){for(e in x.characterRegexArray={},n)"string"==typeof e&&(i+=n[e],x.characterRegexArray[e]=new RegExp("["+n[e]+"]","g"));x.characterRegex=new RegExp(i+"]")}if(x.characterRegex.test(t))for(e in n)"string"==typeof e&&(t=t.replace(x.characterRegexArray[e],e));return t},x.isValueInArray=function(t,e){var i,n=e.length;for(i=0;i<n;i++)if(e[i][0]===t)return i;return-1},x.addParser=function(t){var e,i=x.parsers.length,n=!0;for(e=0;e<i;e++)x.parsers[e].id.toLowerCase()===t.id.toLowerCase()&&(n=!1);n&&x.parsers.push(t)},x.getParserById=function(t){if("false"==t)return!1;var e,i=x.parsers.length;for(e=0;e<i;e++)if(x.parsers[e].id.toLowerCase()===t.toString().toLowerCase())return x.parsers[e];return!1},x.addWidget=function(t){x.widgets.push(t)},x.hasWidget=function(t,e){return(t=L(t)).length&&t[0].config&&t[0].config.widgetInit[e]||!1},x.getWidgetById=function(t){var e,i,n=x.widgets.length;for(e=0;e<n;e++)if((i=x.widgets[e])&&i.hasOwnProperty("id")&&i.id.toLowerCase()===t.toLowerCase())return i},x.applyWidget=function(i,n){var t,e,o,a=(i=L(i)[0]).config,s=a.widgetOptions,r=[];!1!==n&&i.hasInitialized&&(i.isApplyingWidgets||i.isUpdating)||(a.debug&&(t=new Date),a.widgets.length&&(i.isApplyingWidgets=!0,a.widgets=L.grep(a.widgets,function(t,e){return L.inArray(t,a.widgets)===e}),L.each(a.widgets||[],function(t,e){(o=x.getWidgetById(e))&&o.id&&(o.priority||(o.priority=10),r[t]=o)}),r.sort(function(t,e){return t.priority<e.priority?-1:t.priority===e.priority?0:1}),L.each(r,function(t,e){e&&(!n&&a.widgetInit[e.id]||(a.widgetInit[e.id]=!0,e.hasOwnProperty("options")&&(s=i.config.widgetOptions=L.extend(!0,{},e.options,s)),e.hasOwnProperty("init")&&e.init(i,e,a,s)),!n&&e.hasOwnProperty("format")&&e.format(i,a,s,!1))})),setTimeout(function(){i.isApplyingWidgets=!1},0),a.debug&&(e=a.widgets.length,w("Completed "+(!0===n?"initializing ":"applying ")+e+" widget"+(1!==e?"s":""),t)))},x.refreshWidgets=function(t,e,i){var n,o=(t=L(t)[0]).config,a=o.widgets,s=x.widgets,r=s.length;for(n=0;n<r;n++)s[n]&&s[n].id&&(e||L.inArray(s[n].id,a)<0)&&(o.debug&&C('Refeshing widgets: Removing "'+s[n].id+'"'),s[n].hasOwnProperty("remove")&&o.widgetInit[s[n].id]&&(s[n].remove(t,o,o.widgetOptions),o.widgetInit[s[n].id]=!1));!0!==i&&x.applyWidget(t,e)},x.getData=function(t,e,i){var n,o,a="";return(t=L(t)).length?(n=!!L.metadata&&t.metadata(),o=" "+(t.attr("class")||""),void 0!==t.data(i)||void 0!==t.data(i.toLowerCase())?a+=t.data(i)||t.data(i.toLowerCase()):n&&void 0!==n[i]?a+=n[i]:e&&void 0!==e[i]?a+=e[i]:" "!==o&&o.match(" "+i+"-")&&(a=o.match(new RegExp("\\s"+i+"-([\\w-]+)"))[1]||""),L.trim(a)):""},x.formatFloat=function(t,e){return"string"!=typeof t||""===t?t:(t=(e&&e.config?!1!==e.config.usNumberFormat:void 0===e||e)?t.replace(/,/g,""):t.replace(/[\s|\.]/g,"").replace(/,/g,"."),/^\s*\([.\d]+\)/.test(t)&&(t=t.replace(/^\s*\(([.\d]+)\)/,"-$1")),i=parseFloat(t),isNaN(i)?L.trim(t):i);var i},x.isDigit=function(t){return!isNaN(t)||/^[\-+(]?\d+[)]?$/.test(t.toString().replace(/[,.'"\s]/g,""))}}});var c=L.tablesorter;L.fn.extend({tablesorter:c.construct}),c.addParser({id:"no-parser",is:function(){return!1},format:function(){return""},type:"text"}),c.addParser({id:"text",is:function(){return!0},format:function(t,e){var i=e.config;return t&&(t=L.trim(i.ignoreCase?t.toLocaleLowerCase():t),t=i.sortLocaleCompare?c.replaceAccents(t):t),t},type:"text"}),c.addParser({id:"digit",is:function(t){return c.isDigit(t)},format:function(t,e){var i=c.formatFloat((t||"").replace(/[^\w,. \-()]/g,""),e);return t&&"number"==typeof i?i:t?L.trim(t&&e.config.ignoreCase?t.toLocaleLowerCase():t):t},type:"numeric"}),c.addParser({id:"currency",is:function(t){return/^\(?\d+[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]|[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+\)?$/.test((t||"").replace(/[+\-,. ]/g,""))},format:function(t,e){var i=c.formatFloat((t||"").replace(/[^\w,. \-()]/g,""),e);return t&&"number"==typeof i?i:t?L.trim(t&&e.config.ignoreCase?t.toLocaleLowerCase():t):t},type:"numeric"}),c.addParser({id:"ipAddress",is:function(t){return/^\d{1,3}[\.]\d{1,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(t)},format:function(t,e){var i,n=t?t.split("."):"",o="",a=n.length;for(i=0;i<a;i++)o+=("00"+n[i]).slice(-3);return t?c.formatFloat(o,e):t},type:"numeric"}),c.addParser({id:"url",is:function(t){return/^(https?|ftp|file):\/\//.test(t)},format:function(t){return t?L.trim(t.replace(/(https?|ftp|file):\/\//,"")):t},parsed:!0,type:"text"}),c.addParser({id:"isoDate",is:function(t){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}/.test(t)},format:function(t,e){return t?c.formatFloat(""!==t?new Date(t.replace(/-/g,"/")).getTime()||t:"",e):t},type:"numeric"}),c.addParser({id:"percent",is:function(t){return/(\d\s*?%|%\s*?\d)/.test(t)&&t.length<15},format:function(t,e){return t?c.formatFloat(t.replace(/%/g,""),e):t},type:"numeric"}),c.addParser({id:"usLongDate",is:function(t){return/^[A-Z]{3,10}\.?\s+\d{1,2},?\s+(\d{4})(\s+\d{1,2}:\d{2}(:\d{2})?(\s+[AP]M)?)?$/i.test(t)||/^\d{1,2}\s+[A-Z]{3,10}\s+\d{4}/i.test(t)},format:function(t,e){return t?c.formatFloat(new Date(t.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||t,e):t},type:"numeric"}),c.addParser({id:"shortDate",is:function(t){return/(^\d{1,2}[\/\s]\d{1,2}[\/\s]\d{4})|(^\d{4}[\/\s]\d{1,2}[\/\s]\d{1,2})/.test((t||"").replace(/\s+/g," ").replace(/[\-.,]/g,"/"))},format:function(t,e,i,n){if(t){var o=(i=e.config).$headers.filter("[data-column="+n+"]:last");n=o.length&&o[0].dateFormat||c.getData(o,c.getColumnData(e,i.headers,n),"dateFormat")||i.dateFormat,t=t.replace(/\s+/g," ").replace(/[\-.,]/g,"/"),"mmddyyyy"===n?t=t.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$1/$2"):"ddmmyyyy"===n?t=t.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$2/$1"):"yyyymmdd"===n&&(t=t.replace(/(\d{4})[\/\s](\d{1,2})[\/\s](\d{1,2})/,"$1/$2/$3"))}return t?c.formatFloat(new Date(t).getTime()||t,e):t},type:"numeric"}),c.addParser({id:"time",is:function(t){return/^(([0-2]?\d:[0-5]\d)|([0-1]?\d:[0-5]\d\s?([AP]M)))$/i.test(t)},format:function(t,e){return t?c.formatFloat(new Date("2000/01/01 "+t.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||t,e):t},type:"numeric"}),c.addParser({id:"metadata",is:function(){return!1},format:function(t,e,i){return t=(t=e.config).parserMetadataName?t.parserMetadataName:"sortValue",L(i).metadata()[t]},type:"numeric"}),c.addWidget({id:"zebra",priority:90,format:function(t,e,i){var n,o,a,s,r=new RegExp(e.cssChildRow,"i"),l=e.$tbodies;for(e.debug&&(s=new Date),t=0;t<l.length;t++)o=0,l.eq(t).children("tr:visible").not(e.selectorRemove).each(function(){n=L(this),r.test(this.className)||o++,a=0==o%2,n.removeClass(i.zebra[a?1:0]).addClass(i.zebra[a?0:1])});e.debug&&c.benchmark("Applying Zebra widget",s)},remove:function(t,e,i){var n;e=e.$tbodies;var o=(i.zebra||["even","odd"]).join(" ");for(i=0;i<e.length;i++)(n=L.tablesorter.processTbody(t,e.eq(i),!0)).children().removeClass(o),L.tablesorter.processTbody(t,n,!1)}})}(jQuery);var SCM=SCM||{};SCM.Common={getQueryStringValue:function(t,e){var i,n=e+"=",o=t.indexOf(n);if(-1===o)return null;if(o+=n.length,0<=t.indexOf("&",o)){var a=t.indexOf("&",o);i=t.substring(o,a)}else i=t.substring(o);return i},isDefined:function(t){return void 0!==t&&void 0!==t&&null!=t}};var SCM=SCM||{};SCM.BookBasicInfo=SCM.BookBasicInfo||{},SCM.BookBasicInfo.registerAbstractSnippetReadMore=function(){$(document).on("click",".js-toggle-book-abstract-snippet",function(){$(this).parents(".book-info__abstract").toggleClass("collapsed"),$(this).toggleClass("expanded"),$(this).children(".js-arrow-icon").toggleClass("icon-general_arrow-down icon-general_arrow-up")})},SCM.BookBasicInfo.registerAbstractSnippetReadMore();var SCM=SCM||{};SCM.ToolboxGetCitations=function(n){var o;return{init:function(){if(!n(".js-add-to-citation-download-manager").length&&!n(".js-bulk-citation-manager-add").length)return;o=SCM.ToolboxGetCitations.DataService,function(){var t=n("#main");t.on("click",".js-add-to-citation-download-manager",function(){!function(t){if(t.hasClass("disabled"))return;var e=t.data("resourceId"),i=t.data("resourceTypeId");o.addResourceToCitationManager(e,i)}(n(this))}),t.on("change",".js-checkBoxClass",e),t.on("click",".js-bulk-citation-manager-add",i)}(),o.getResourceIdsAlreadyInCitationManager().then(function(i){n(".js-add-to-citation-download-manager").each(function(){var t=n(this),e=t.data("resourceId")+"-"+t.data("resourceTypeId");-1<i.indexOf(e)&&(t.data("inCitationManager","true"),t.addClass("disabled"))})})},updateAddToCMButton:s};function e(t){var e=n(t.currentTarget).closest("section");e.find(".js-bulk-citation-manager-add").prop("disabled",!function(t){return a(t).length}(e))}function a(t){return t.find(".js-checkBoxClass:checked").map(function(t,e){return{id:n(e).data("resourceId"),typeid:n(e).data("resourceTypeId")}}).get()}function i(t){var i=a(n(t.currentTarget).closest("section"));Array.isArray(i)&&i.length&&o.getResourceIdsAlreadyInCitationManager().then(function(e){var t=i.filter(function(t){return!e.includes(t.id)});t.length?function(t){o.addResourcesToCitationManager(t).then(function(){t.forEach(function(t){s(t.id,t.typeid)})}).catch(function(t){console.error("Failed to add resources to cart.",t)})}(t):alert("No selected resources can be added to your Citation Manager")}).catch(function(t){console.error("Failed to get resourceIds in cart.",t)})}function s(t,e){n(".js-add-to-citation-download-manager[data-resource-id="+t+"][data-resource-type-id="+e+"]").addClass("disabled")}}(jQuery),SCM.ToolboxGetCitations.DataService=function(t){return{addResourceToCitationManager:i,getResourceIdsAlreadyInCitationManager:function(){return t.ajax({type:"POST",url:"/Citation/GetResourcesInCitationManager",cache:!1}).promise().then(function(t){return t.Success?Array.isArray(t.Messages)?t.Messages.length?t.Messages[0].split(","):[]:Promise.reject("Action did not return expected response"):Promise.reject("Action return non-success status")})},addResourcesToCitationManager:function(t){if(!Array.isArray(t)||!t.length)return Promise.reject("No resources provided");var e=[];return t.forEach(function(t){e.push(i(t.id,t.typeid))}),Promise.all(e).then(function(t){return Array.isArray(t)?function(t){return t.sort(function(t,e){return e-t}).shift()}(t):t})}};function i(e,i){e&&i&&t.ajax({type:"POST",url:"/Citation/AddToCitationManagerAjax",dataType:"text",data:{resourceId:e,resourceTypeId:i}}).done(function(t){(t=JSON.parse(t)).Success||console.log("Cannot add citation"),SCM.ToolboxGetCitations.updateAddToCMButton(e,i)})}}(jQuery);var SCM=SCM||{};!function(t,a){function e(t){if(t.preventDefault(),SCM.CitationDownloadManager.getSelectedCitations().length){var e=a(this).data("citation-format"),i=a(".js-download-citation"),n=i.data("action-format")+e;i.attr("action",n);var o=SCM.CitationDownloadManager?JSON.stringify(SCM.CitationDownloadManager.getSelectedCitationsData()):"";a(".js-download-citation-data").attr("value",o),i.submit()}}t.registerDownload=function(){a(".js-citation-format").on("click",e)}}(SCM.CitationDownloadSelector=SCM.CitationDownloadSelector||{},jQuery),jQuery(SCM.CitationDownloadSelector.registerDownload());var SCM=SCM||{};!function(n,i){function t(t){return SCM.CitationDownloadManager.setCheckboxesCheckedTo(this.checked),r(),!1}function e(t){if(n.getSelectedCitations().length){var e={citations:JSON.stringify(SCM.CitationDownloadManager.getSelectedCitationsData())};return i.ajax({type:"POST",url:"/Citation/RemoveFromCitationManager",dataType:"text",data:e}).done(function(t){result=JSON.parse(t),result.Success?window.location.reload():console.warn("Could not remove citation(s). "+t)}),!1}}function o(t){if(n.getSelectedCitations().length){var e=SCM.CitationDownloadManager.getSelectedCitationsData().length,i=document.getElementById("js-prompt");return i&&(i.textContent=e),!1}}function a(e,t,i){var n=document.querySelectorAll(t);if(!n.length)return!1;n.forEach(function(t){t.addEventListener(e,i)})}function s(t){if(r(),!this.classList.contains("js-select-all")){var e=document.querySelectorAll(".js-select-all");e.length&&(this.checked?n.getSelectedCitations().length===i(".js-citation-checkbox").length&&e.forEach(function(t){t.checked=!0}):e.forEach(function(t){t.checked=!1}))}}function r(){var t=i(".js-download-selected");n.getSelectedCitations().length?(t.removeClass("disabled"),t.attr("data-reveal-id","getCitations"),i(".js-remove-selected").removeClass("disabled")):(t.addClass("disabled"),t.attr("data-reveal-id",""),i(".js-remove-selected").addClass("disabled"))}n.getSelectedCitations=function(){return i(".js-citation-checkbox:checked")},n.setCheckboxesCheckedTo=function(e){var t=document.querySelectorAll(".js-citation-checkbox");if(t.length){t.forEach(function(t){t.checked=e});var i=document.querySelectorAll(".js-select-all");i.length&&i.forEach(function(t){t.checked!==e&&(t.checked=e)})}},n.registerEventHandlers=function(){a("click",".js-citation-checkbox",s),a("click",".js-select-all",t),a("click",".js-remove-selected",e),a("click",".js-download-selected",o)},n.getSelectedCitationsData=function(){return n.getSelectedCitations().map(function(){return{ResourceId:this.dataset.resourceid,ResourceType:this.dataset.resourcetype,AddedTime:this.dataset.addedtime,GeoRefId:this.dataset.georefid,CustomCitationUrl:this.dataset.customcitationurl}}).get()}}(SCM.CitationDownloadManager=SCM.CitationDownloadManager||{},jQuery),jQuery(function(){SCM.CitationDownloadManager.setCheckboxesCheckedTo(!1),SCM.CitationDownloadManager.registerEventHandlers()});var SCM=SCM||{};!function(t,e){var i;e.bbq={},e.bbq.getState=i=function(t){var e=window.location.hash,i=e.indexOf(t);if(!(i<0)){i=i+t.length+1;var n=e.indexOf("&",i);return n<0?decodeURI(e.substring(i)):decodeURI(e.substring(i,n))}},e.bbq.removeState=function(t){var e=i(t);e&&location.replace(window.location.hash.replace(t+"="+encodeURI(e),""))},e.deparam={},e.deparam.querystring=function(){for(var t=window.location.search.substring(1).split("&"),e={},i=0;i<t.length;i++){var n=t[i].split("=");2===n.length&&(e[n[0]]=decodeURI(n[1]))}return e}}(0,jQuery);var SCM=SCM||{};SCM.UploadImage_Complete=function(t){var e=$.extend({targetSelector:"#UploadTarget",jsonResultSelector:"#jsonResult",replacementContainerSelector:"#id"},t),i=$(e.targetSelector).contents().find(e.jsonResultSelector);if(1===i.length){var n=$.parseJSON(i.html());if($("[data-valmsg-for]").attr("class","field-validation-valid").html(""),n.Success)e.success&&e.success();else if(0<n.Messages.length){var o="Error \n";n.Messages.forEach(function(t){o+=t+"\n"}),alert(o)}else n.Html?$(e.replacementContainerSelector).replaceWith(n.Html.replace(/{{/g,"&quot;")):n.ValidationErrors.forEach(function(t){var e=$("[data-valmsg-for="+t.Key+"]");e.addClass("field-validation-error").removeClass("field-validation-valid"),t.Errors.forEach(function(t){e.html(e.html()+t+"<br />")})})}},SCM.AjaxHelperSuccessCallback=function(t,e,i){t.RedirectUrl&&0<t.RedirectUrl.length?window.location=t.RedirectUrl:t.Html&&0<t.Html.length?e.replaceWith(t.Html):t.Success?i():e.replaceWith(t)},SCM.AjaxHelperErrorCallback=function(t,e,i){t.RedirectUrl&&0<t.RedirectUrl.length?window.location=t.RedirectUrl:t.Html&&0<t.Html.length?e.replaceWith(t.Html):t.Success?i():e.replaceWith(t)},SCM.showModal=function(){var e=[];"undefined"!=typeof tinyMCE&&tinyMCE.editors.forEach(function(t){$("#divDefaultUpdateTarget").find("#"+t.editorContainer).each(function(){e.push(t.id)})}),$.fancybox({autosize:!0,autoScale:!1,title:"",href:"#divDefaultUpdateTarget"}),"undefined"!=typeof tinyMCE&&e.forEach(function(t){$("#"+t).scmTinyMCE()})},SCM.hideModal=function(){$.fancybox.close()},SCM.refreshModal=function(){$.fancybox.update()},function(){var a=$("body");function r(t,e){return 0===t.indexOf("*.")&&(t=t.replace("*.",e)),t}$(document).ajaxError(function(t,e,i){if(a.removeClass("wait"),e.responseText)try{var n=$.parseJSON(e.responseText);if(null!=n.Success&&!n.Success){var o="There was an error processing the request \n";n.Messages.forEach(function(t){o+=t+"\n"}),alert(o)}}catch(t){console.log("Ajax error occured, responseText is not json: "+t.message)}}),$.validator.addMethod("isDateGreaterThan",function(t,e,i){return 1!=function(t,e){var i=new Date(e),n=new Date(t);{if(i.getFullYear()==n.getFullYear()&&i.getMonth()==n.getMonth()&&i.getDate()==n.getDate())return!1;if(n<i)return!0}return!1}($(e).val(),i)},""),$(document).ajaxStart(function(){a.addClass("wait")}).ajaxStop(function(){a.removeClass("wait")}),a.on("keypress","[data-default-button]",function(t){if(13==t.which)return $("#"+$(this).data("defaultButton")).click(),!1}),$.validator.unobtrusive.adapters.add("dynamicrange",["minvalueproperty","maxvalueproperty"],function(t){t.rules.dynamicrange=t.params,null!=t.message&&($.validator.messages.dynamicrange=t.message)}),$.validator.addMethod("dynamicrange",function(t,e,i){var n=function(t){return t.substr(0,t.lastIndexOf(".")+1)}(e.name),o=parseInt($('input[name="'+r(i.minvalueproperty,n)+'"]').val(),10),a=parseInt($('input[name="'+r(i.maxvalueproperty,n)+'"]').val(),10),s=parseInt(t,10);return!(isNaN(o)||isNaN(a)||isNaN(s)||s<o||a<s)||($.validator.messages.dynamicrange=$.format($(e).attr("data-val-dynamicrange"),o,a),!1)},"")}(),function(s){s.fn.radiobuttonEnable=function(){return this.each(function(){var n=s(this);n.find("*[data-rb-enable-name]").each(function(){var t=s(this),e=n.find('input:radio[name="'+t.data("rbEnableName")+'"]:checked');if(0<e.length){var i=t.data("rbEnableValue");null!=i&&e.val().toString().toLowerCase()!=i.toString().toLowerCase()&&t.prop("disabled",!0),null!=(i=t.data("rbMakeVisibleValue"))&&e.val().toString().toLowerCase()!=i.toString().toLowerCase()&&t.hide()}}),n.find("input:radio").on("change",function(){var n=s(this),t='[data-rb-enable-name="'+n.attr("name")+'"]';s(t).each(function(){var t=s(this),e=tinymce.editors[t[0].id],i=t.data("rbEnableValue");null!=i&&(i.toString().toLowerCase()==n.val().toLowerCase()?(t.prop("disabled",!1),e&&e.getBody().setAttribute("contenteditable",!0)):(t.prop("disabled",!0),e&&e.getBody().setAttribute("contenteditable",!1))),null!=(i=t.data("rbMakeVisibleValue"))&&(i.toString().toLowerCase()==n.val().toLowerCase()&&!t.is(":visible")||i.toString().toLowerCase()!=n.val().toLowerCase()&&t.is(":visible"))&&t.fadeToggle()})})})},s.fn.configureSCMForm=function(t){var i=s.extend({cancelButtonSelector:".cancel",submitButtonSelector:".submit",nextQuestionButtonSelector:".nextQuestion",skipButtonSelector:".skip",validatorIgnores:":disabled, input[type='hidden']",nextQuestion:null,cancel:null,skip:null,validateOnSubmit:null,validateOnKeyUp:!1},t);return this.each(function(){var e=s(this);jQuery.validator.unobtrusive.parse("#"+this.id),e.validate();var t=s.data(e[0],"validator").settings;t.ignore=i.validatorIgnores,!0===i.validateOnKeyUp&&(i.validateOnKeyUp=null),t.onkeyup=i.validateOnKeyUp,t.onsubmit=i.validateOnSubmit,e.find(i.submitButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(t){t.preventDefault(),e.valid()&&e.trigger("submit")}),e.find(i.nextQuestionButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(t){t.preventDefault(),i.nextQuestion()}),e.find(i.skipButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(t){t.preventDefault(),i.skip()}),e.find(i.cancelButtonSelector).off("click.configureSCMForm").on("click.configureSCMForm",function(t){t.preventDefault(),i.cancel?i.cancel():(e.hide(),SCM.hideModal())})})},s.fn.viewMore=function(t){var i=s.extend({hiddenSelector:".read-more",readMoreButtonSelector:"#readMore",readMoreText:"Read More",readLessText:"Read Less"},t);return this.each(function(){var e=s(i.hiddenSelector);e.hide(),s(i.readMoreButtonSelector).on("click",function(t){t.preventDefault(),e.fadeToggle()})})},s.fn.scmTinyMCE=function(){return s(".mceOpen.mce_forecolor").show(),s(".mce_forecolor .mceLast .mceIconOnly").show(),s(".mceOpen.mce_backcolor").show(),s(".mceOpen.mce_backcolor .mceIconOnly").show(),this.each(function(){s(this).tinymce({gecko_spellcheck:!0,theme:"advanced",theme_advanced_buttons1:"bold,italic,underline,|,bullist,numlist,|,sub,sup,|,charmap,|,forecolor,backcolor,|,link",theme_advanced_buttons2:"",theme_advanced_buttons3:"",plugins:"inlinepopups",theme_advanced_statusbar_location:null,oninit:function(t){var e=s("#"+t.editorId+"[data-rb-enable-name]"),i=s('input:radio[name="'+e.data("rbEnableName")+'"]');if(0<i.length&&i.val().toString().toLowerCase()!=e.data("rbEnableValue").toString().toLowerCase()){e.prop("disabled",!0);var n=tinymce.editors[e[0].id];n&&n.getBody().setAttribute("contenteditable",!1)}}})})},s.fn.scmTimer=function(e){return this.each(function(){var i=s(this),n=s.extend({h:0,m:0,s:0,hs:0,stop:!1,milliseconds:150,intervalCheck:null},e);if(n.stop)clearInterval(i.data("scmTimerToken"));else{function t(t){return t<10&&(t="0"+t),t}function o(){i.text(t(n.h)+":"+t(n.m)+":"+t(n.s)+":"+t(n.hs))}var a=(new Date).getTime();o(),i.data("scmTimerToken",setInterval(function(){if(i.is(":visible")){var t=(new Date).getTime(),e=t-a;n.hs+=Math.floor(e/10),a=t,100<=n.hs&&(n.s+=Math.floor(n.hs/100),n.hs=n.hs%100,60<=n.s&&(n.m+=Math.floor(n.s/60),n.s=n.s%60),60<=n.m&&(n.h+=Math.floor(n.m/60),n.m=n.m%60)),o(),!n.intervalCheck||n.intervalCheck(n)||clearInterval(i.data("scmTimerToken"))}else clearInterval(i.data("scmTimerToken"))},n.milliseconds))}})},s.fn.wkTimer=function(e){return this.each(function(){var i=s(this),n=s.extend({h:0,m:0,s:0,hs:0,stop:!1,milliseconds:150,intervalCheck:null},e);if(n.stop)clearInterval(i.data("wkTimerToken"));else{function t(t){return t<10&&(t="0"+t),t}function o(){i.text(t(n.m)+":"+t(n.s))}var a=(new Date).getTime();o(),i.data("wkTimerToken",setInterval(function(){if(i.is(":visible")){var t=(new Date).getTime(),e=t-a;n.hs+=Math.floor(e/10),a=t,100<=n.hs&&(n.s+=Math.floor(n.hs/100),n.hs=n.hs%100,60<=n.s&&(n.m+=Math.floor(n.s/60),n.s=n.s%60),60<=n.m&&(n.h+=Math.floor(n.m/60),n.m=n.m%60)),o(),!n.intervalCheck||n.intervalCheck(n)||clearInterval(i.data("wkTimerToken"))}else clearInterval(i.data("wkTimerToken"))},n.milliseconds))}})}}(jQuery);var SCM=SCM||{};SCM.__namespace=!0,SCM.eventManager=function(a){function t(t,e){return a.pubsub("subscribe",t,e)}function n(t,e){a.pubsub("publish",t,e)}function e(i,n){return t(s,function(t,e){i===e.actionEnum&&n(e.data)})}var o="actionCompleted",i=function(i,n){return t(o,function(t,e){i===e.actionEnum&&n(e)})},s="actionCompleteactionRequest";return{subscribeWidgetRefresh:function(t,e){var n=a.extend({refreshWhenInvisible:!1,messageContainerSelector:"#divMessage"},e),o="";o=i(t,function(e){if(!n.refreshIf||n.refreshIf(e)){var i=a(n.containerSelector);(n.refreshWhenInvisible||i.is(":visible"))&&a.ajax({type:"POST",url:n.url,data:n.data,dataType:"html",success:function(t){a.pubsub("unsubscribe",o),i.replaceWith(t).show(),n.refreshSuccess&&n.refreshSuccess(e)}})}})},subscribe:t,publish:n,publishActionCompleted:function(t,e){var i=a.extend({actionEnum:t},e);n(o,i)},subscribeActionCompleted:i,publishActionRequest:function(t,e){return n(s,{actionEnum:t,data:e})},subscribeActionRequest:e,subscribeActionRequestDisplayResult:function(t,i){return e(t,function(t){var e=a.extend({type:"POST"},t);a.ajax({type:e.type,url:e.url,data:e.data,dataType:"html",success:function(t){a(i).html(t).show()},error:function(t){alert(t)}}),SCM.hideModal()})}}}(jQuery),SCM.eventManager.subscriptionMessages={playVideo:"SCM.PlayVideo"};var SCM=SCM||{};!function(t,e){var n={},o=n.hasOwnProperty;t.subscribe=function(t,e){o.call(n,t)||(n[t]=[]);var i=n[t].push(e)-1;return{remove:function(){delete n[t][i]}}},t.publish=function(t,i){o.call(n,t)&&e.each(n[t],function(t,e){e(void 0!==i?i:{})})}}(SCM.EventEmitter=SCM.EventEmitter||{},jQuery);var isValidBoundedCoordinates=function(t){if(t){var e=t.match(/ENVELOPE\((.*?)\)/);if(Array.isArray(e)&&2===e.length&&t&&0<t.length)return!0}return!1},SCM=SCM||{};SCM.AdvancedSearch={},SCM.AdvancedSearch.configSettings={preSelectSingleBookFacet:"true"};var textCharectorLimit=$("#hfSolrMaxAllowSearchChar").val();function AppendSubscriptionParameterToUrl(t){var e=t;if("true"==$("#hfEnableSubscriptionFilter").val().toLowerCase())e=t+"&subonly=true";return e}function isValidDate(t){var e=/^(\d{2})[-\/](\d{2})[-\/](\d{4})$/.exec(t);if(null==e)return!1;var i=e[2],n=e[1]-1,o=e[3],a=new Date(o,n,i);return a.getDate()==i&&a.getMonth()==n&&a.getFullYear()==o}function isYearOnly(t){var e=/^(\d{4})$/.exec(t);return e&&-1<e[1]}function updateYearOnlyToFullDate(t,e){var i=t.val(),n=null,o=null;return o=e?n="01":(n="12","31"),t.val(n+"/"+o+"/"+i),t.val()}Date.prototype.today=function(){return(this.getMonth()+1<10?"0":"")+(this.getMonth()+1)+"/"+(this.getDate()<10?"0":"")+this.getDate()+"/"+this.getFullYear()},null!=textCharectorLimit&&""!=textCharectorLimit||(textCharectorLimit="255");var micrositeJournalDisplayName="",micrositeJournalId="",solrsearchScope=$("#hfSolrJournalID").val(),solrBookSearchScope=$("#hfSolrBookID").val();void 0===solrsearchScope?solrsearchScope="":null!=solrsearchScope&&(solrsearchScope=solrsearchScope.replace("J","")),void 0===solrBookSearchScope?solrBookSearchScope="":null!=solrBookSearchScope&&(solrBookSearchScope=solrBookSearchScope.replace("B","")),$(document).ready(function(t){function f(t){$(".access-filter-input-radio[value=contentowned]").is(":checked")&&(t.access_openaccess=!0,t.access_free=!0,t.access_unlocked=!0)}function e(t){if(null!=t&&""!=t)if(t.length>parseInt(textCharectorLimit))alert("Please enter a term between 1 to "+textCharectorLimit+" characters");else{var e={};f(e);var i='"'+t+'"';e.allJournals=1,e.q=i,e.fd_ArticleTitle=i,s(e)}else alert("Please enter a term to search")}function i(){$("#contentTypeFilters input:checkbox").prop("checked",!1),$("#advancedSearch #chkAdvancedSearchContentType").each(function(){var t=$(this).attr("value");"Journal Article"===t|"Book"===t|"Book Chapter"===t|"GeoRef Record"===t&&$(this).prop("checked",!0)})}function n(){var t=$("#citationYear").val(),e=$("#citationVolume").val(),i=$("#citationVolume").attr("pattern"),n=$("#citationPage").val(),o=$(".citationJournal").val(),a=$(".citationJournal option:selected").text(),s=!1,r="";$("#citationIssueNo").length&&(r=$("#citationIssueNo").val());var l={},c="";if(null!=o&&""!=o&&"- Select a Journal"!=o||(c="Please select a journal.\n"),null!=t&&""!=t&&"Yr"!=t)if(isNaN(t))c+="Year must be numeric.\n";else{var d="01/01/"+t+" TO 12/31/"+t;l.rg_PublicationDate=d}null!=e&&""!=e&&"Vol"!=e&&(new RegExp(i).test(e)?l.fd_Volume=e:c+="Volume must be alphanumeric without spaces");if(null!==r&&""!==r&&"Issue"!==r&&(l.fd_IssueNo=r),""!=n&&"1st Pg"!=n&&(l.fd_StartPage=n),0<c.length)return alert(c),!1;var u=o.split(",");"C"==u[0]?(l.fl_JournalID=u[1],s=!0):l.fl_JournalHistID=u[2],f(l);var h="/search-results?"+$.param(l);h+=s?"&f_JournalDisplayName="+encodeURIComponent($.trim(a)):"&fd_LegacyJournalDisplayName="+encodeURIComponent($.trim(a));var p=$("#hfSiteURL").val();return window.location.href=window.location.protocol+"//"+p+h+"&searchType=advanced",!1}$(document).on("click",".access-filter-input-radio",function(){"contentowned"===$(this).attr("value")?$("#rbtAllContent").prop("checked",!1):$("#rbtContentOwned").prop("checked",!1)}),null==solrBookSearchScope||""==solrBookSearchScope?($("#advancedSearch input.advancedSearchBook[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$(".advancedAuthorSearch input.advancedSearchBook[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$("input.rbPublication[type=radio]").each(function(){"B*"==$(this).attr("value")?$(this).prop("checked",!1):$(this).prop("checked",!0)})):($("#advancedSearch input.advancedSearchJournal[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$(".advancedAuthorSearch input.advancedSearchJournal[type=checkbox]").each(function(){$(this).prop("checked",!1),$(this).prop("disabled",!0)}),$("input.rbPublication[type=radio]").each(function(){"J*"==$(this).attr("value")?$(this).prop("checked",!1):$(this).prop("checked",!0)})),(null!=solrsearchScope&&""!=solrsearchScope||null!=solrBookSearchScope&&""!=solrBookSearchScope)&&($(".advancedAuthorSearch input:checkbox").each(function(){var t=$(this).attr("currentjournaldisplayname"),e=$(this).attr("text"),i=$(this).attr("jid"),n=$(this).attr("bid");if(null!=t&null!=e&&t==e){if(i==solrsearchScope)return this.checked=!0,micrositeJournalDisplayName=e,micrositeJournalId=i,!1}else null!=n&&""!=n&&(n!=solrBookSearchScope&&"*"!==solrBookSearchScope||(this.checked=!0))}),$("#advancedSearch input:checkbox").each(function(){var t=$(this).attr("currentjournaldisplayname"),e=$(this).attr("text"),i=$(this).attr("jid"),n=$(this).attr("bid");if(null!=t&null!=e&&t==e){if(i==solrsearchScope)return this.checked=!0,micrositeJournalDisplayName=e,micrositeJournalId=i,!1}else null!=n&&""!=n&&(n!=solrBookSearchScope&&"*"!==solrBookSearchScope||(this.checked=!0))}),$(".citationJournal").each(function(){$("option",this).each(function(){var t=$(this).val().split(",");null!=t&&"C"==t[0]&&t[1]==solrsearchScope&&$(this).prop("selected",!0)})})),i(),$(document).on("click","#btnAdvancedTitleSearch",function(){e($("#articleTitle").val())}),$(document).on("keydown","#articleTitle",function(t){13==t.keyCode&&e($("#articleTitle").val())}),$(document).on("click","#btnAdvancedCitationSearch",function(){n()}),$("#btnAdvancedCitationSearch").keyup(function(t){13==t.keyCode&&(t.preventDefault(),n())}),$(document).on("click","#btnAdvancedSearch",function(){var t={};f(t),function(t){var e=null;$("#advancedSearch #chkAdvancedSearchContentType:checked").each(function(){this.checked&&(e?0<e.length&&(e+=" OR "+$(this).attr("value")):e=$(this).attr("value"))}),e&&(t.fl_ContentType=e)}(t),function(t){var e=function(){var i=[];$("#js_qb_groups .js_qb_group").each(function(){var e={};$(this).children(".row").children(".js_qb_data").each(function(){var t=$(this).attr("data-qb-json-element");e[t]=$(this).val()});var t=[];$(this).find(".js_qb_term").each(function(){var e={};$(this).find(".js_qb_data").each(function(){var t=$(this).attr("data-qb-json-element");e[t]="exactMatch"===t?$(this).is(":checked"):$(this).val()}),e.input&&e.input.length&&t.push(e)}),t.length&&(t[0].condition&&delete t[0].condition,e.terms=t,i.push(e))}),!i.length||i[0].condition&&delete i[0].condition;return i}();e.length&&(t.cqb=JSON.stringify(e))}(t),function(t){var e=$("#txtBoundCordNorth"),i=$("#txtBoundCordEast"),n=$("#txtBoundCordWest"),o=$("#txtBoundCordSouth");if(null!=e.val()&&0<e.val().length&&null!=i.val()&&0<i.val().length&&null!=n.val()&&0<n.val().length&&null!=o.val()&&0<o.val().length){var a=parseFloat(e.val()),s=parseFloat(i.val()),r=parseFloat(n.val()),l=parseFloat(o.val()),c=r.toString(),d=s.toString(),u=l.toString(),h=a.toString();t.exPrm_fq='data_geo_marker:"Intersects(ENVELOPE('+c+","+d+","+h+","+u+'))"',t.boundCoordSearch=!0}}(t),function(t){var e=$("#startDateAuthor").val();if(e&&e.length){isYearOnly(e)&&(e=updateYearOnlyToFullDate($("#startDateAuthor"),!0)),isValidDate(e)||(alert("please enter valid start date"),t.error=!0);var i=$("#endDateAuthor").val();i&&i.length?(isYearOnly(i)&&(i=updateYearOnlyToFullDate($("#endDateAuthor"),!1)),(!isValidDate(i)||new Date(i)<new Date(e))&&(alert("please enter valid end date"),t.error=!0)):($("#endDateAuthor").val((new Date).today()),i=$("#endDateAuthor").val()),t.rg_PublicationDate=e+" TO "+i}}(t),function(t){var e=[],i=[],n=null,o=null,a=!1;if($(".advancedAuthorSearch #chkAuthorJournal:checked").each(function(){a=!0,o=$(this).attr("currentjournaldisplayname"),n=$(this).attr("text"),i.push($(this).attr("value")),e.push($(this).attr("jid"))}),a){var s=i.join(" OR "),r=e.join(" OR ");if(t.restypeid=3,1===i.length){var l=n;n===o?(t.fl_JournalID=r,t.f_JournalDisplayName=l):(t.fl_JournalID=r,t.f_JournalDisplayName=o,t.fd_LegacyJournalDisplayName=l)}else 1<i.length?t.fl_JournalHistID=s:0===i.length&&(t.allJournals=1)}}(t),s(t)}),$(document).on("click","#btnAdvancedSearchClear",function(){$(".access-filter-option input:radio").prop("checked",!1),$(".access-filter-option input:radio[default]").prop("checked",!1),i(),$("#advancedAuthorSearch input:text").val(""),$("#journalFiltersAuthorSearch input:checkbox").prop("checked",!1),$("#js_qb_groups .js_qb_group:not(:first)").remove(),$("#js_qb_groups .js_qb_terms_list li").slice(2).remove(),$("#js_qb_groups .js_qb_advanced_search_text").val(""),$("#js_qb_groups #exactMatch").prop("checked",!1),$("#js_qb_groups .js_qb_filter_select").each(function(t,e){var i=$(this).find("[default]").val();$(this).val(i)}),$("#js_qb_groups .js_qb_data[name=boolOperator]").val(0),SCM.BoundingCoordinates.loadBoundCoordScript()}),$(document).on("click","#btnAdvancedSearchLimiterSearch",function(){!function(){var t={q:""},e="/search-results?"+$.param(t),i=[],n=$(".limiter-language option:selected").val(),o=$(".limiter-bibliographic option:selected").val(),a=$(".limiter-document-type");0<n.length&&"No Preference"!==n&&(e=e+"&fl_Language="+n);0<o.length&&"No Preference"!==o&&(e=e+"&fl_GeoRefBibliographicLevel="+o);if(a.each(function(){var t=$(this);t.is(":checked")&&i.push(t.val())}),0<i.length){var s=-1<i.indexOf("Meeting Abstracts")?"&fl_GeoRefSummaryOnly=true":"";-1<i.indexOf("Conference document")&&-1<i.indexOf("Meeting Abstracts")&&i.splice($.inArray("Conference document",i),1);var r=i.join(" OR ");r=r.replace("Meeting Abstracts","Conference document"),e=e+"&fl_GeoRefDocumentType="+encodeURIComponent(r)+s}var l=$("#hfSiteURL").val();window.location.href=window.location.protocol+"//"+l+e+"&f_ContentType=GeoRef Record&searchType=advanced"}()}),$(document).on("click","#btnAdvancedSearchLimiterSearchClear",function(){$(".widget-GeoRefLimiterSearch select").val(0),$(".widget-GeoRefLimiterSearch input:checkbox").prop("checked",!1)}),$(document).on("click","#btnAdvancedSearchCategoryCodeFilterSearch",function(){!function(){var t={q:""},e="/search-results?"+$.param(t),i=$("#categorycodefilter-dropdown :selected").val();if(0<i.length&&"No Preference"!==i){e=e+"&f_GeoRefCategoryCode="+i;var n=$("#hfSiteURL").val();window.location.href=window.location.protocol+"//"+n+e+"&searchType=advanced"}}()}),$(document).on("keydown","#Doi",function(t){13==t.keyCode&&(GetDoiUrl(),$("#aDoiSearch").click())}),$(document).on("click",".toggle-expanded",function(){$(this).parents(".search-module").toggleClass("collapsed").toggleClass("expanded")});function o(){var t=$("#js_qb_term_template").html();$(this).siblings(".js_qb_terms_list").append(t)}function a(){$(".js_qb_add_term").off("click",o),$(document).on("click",".js_qb_add_term",o)}function s(t){if(t.error)return"";t.searchType="advanced",t.adv=!0;var e=$("#hfSiteURL").val()+"/search-results?"+$.param(t);window.location.href=window.location.protocol+"//"+e}$(document).on("click",".js_qb_add_group",function(){var t=$("#js_qb_group_template").html();$(this).siblings("#js_qb_groups").append(t),a()}),a(),function(){var t=document.referrer;if(t){var e=$.deparam.querystring(t);!function(t){(t.access_openaccess||t.access_free||t.access_unlocked)&&$("#rbtContentOwned").click()}(e),function(t){if(t.fl_ContentType){$(".advanced-search-content-type").prop("checked",!1),t.fl_ContentType.split(/\sOR\s/).forEach(function(t){$('.advanced-search-content-type[value="'+t+'"]').prop("checked",!0)})}}(e),function(t){if(t.cqb){for(var e=decodeURIComponent(t.cqb),i=JSON.parse(e),n=i.length-1,o=0;o<n;o++)$(".js_qb_add_group").click();for(o=0;o<i.length;o++){var a=i[o],s=$("#js_qb_groups .js_qb_group").eq(o);a.condition&&s.find('select[data-qb-json-element="condition"]').val(a.condition);for(var r=a.terms.length-2,l=0;l<r;l++)s.find(".js_qb_add_term").click();for(l=0;l<a.terms.length;l++){var c=a.terms[l],d=s.find(".js_qb_term").eq(l);c.condition&&d.find('select[data-qb-json-element="condition"]').val(c.condition),d.find('select[data-qb-json-element="filter"]').val(c.filter),d.find('input[data-qb-json-element="input"]').val(c.input),c.exactMatch&&d.find('input[data-qb-json-element="exactMatch"]').click()}}}}(e),function(t){var e=t.exPrm_fq;if(isValidBoundedCoordinates(e)){var i=e.match(/ENVELOPE\((.*?)\)/)[1].split(",");$("#txtBoundCordWest").val(i[0]),$("#txtBoundCordEast").val(i[1]),$("#txtBoundCordNorth").val(i[2]),$("#txtBoundCordSouth").val(i[3])}}(e),function(t){if(t.rg_PublicationDate){var e=t.rg_PublicationDate.split(/\sTO\s/);$("#startDateAuthor").val(e[0]),$("#endDateAuthor").val(e[1])}}(e),function(t){t.fl_JournalID&&$('.advancedSearchJournal[jid="'+t.fl_JournalID+'"]').click();if(t.fl_JournalHistID){t.fl_JournalHistID.split(/\sOR\s/).forEach(function(t){$('.advancedSearchJournal[value="'+t+'"]').click()})}}(e),function(t){t.f_GeoRefCategoryCode&&$("#categorycodefilter-dropdown").val(t.f_GeoRefCategoryCode)}(e),function(t){t.fl_Language&&$("#limiter-language").val(t.fl_Language);t.fl_GeoRefBibliographicLevel&&$("#limiter-bibliographic").val(t.fl_GeoRefBibliographicLevel);if(t.fl_GeoRefDocumentType){t.fl_GeoRefDocumentType.split(/\sOR\s/).forEach(function(t){$('.limiter-document-type[value="'+t+'"]').click()})}}(e)}}()}),$(function(){try{$("#startDateSemanticSearch").on("keydown",function(t){if(13==t.which&&isYearOnly($("#startDateSemanticSearch").val()))return updateYearOnlyToFullDate($("#startDateSemanticSearch"),!0),t.preventDefault(),t.stopImmediatePropagation(),!1}),$("#endDateSemanticSearch").on("keydown",function(t){if(13==t.which&&isYearOnly($("#endDateSemanticSearch").val()))return updateYearOnlyToFullDate($("#endDateSemanticSearch"),!0),t.preventDefault(),t.stopImmediatePropagation(),!1}),$("#startDateAuthor").on("keydown",function(t){if(13==t.which&&isYearOnly($("#startDateAuthor").val()))return updateYearOnlyToFullDate($("#startDateAuthor"),!0),t.preventDefault(),t.stopImmediatePropagation(),!1}),$("#endDateAuthor").on("keydown",function(t){if(13==t.which&&isYearOnly($("#endDateAuthor").val()))return updateYearOnlyToFullDate($("#endDateAuthor"),!0),t.preventDefault(),t.stopImmediatePropagation(),!1})}catch(t){}});var SCM=SCM||{};!function(pdf,$){function formatIssuePurchaseLink(t,e){var i=t;if(0<=t.toLowerCase().indexOf("resourceid=")){i=t.replace(/resourceID=\{0\}|resourceID=\d+/i,"resourceid="+e)}return i}function logErrors(jqXHR,textStatus,errorThrown){if(window.console){var err=eval("("+jqXHR.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}function openPDF(t){window.location.href=t}function openNoAccessModalArticle(t,e){t.attr({"data-reveal-id":"noAccessReveal","data-reveal":""}).removeAttr("data-ajax-url");var i="/article.aspx?articleid="+e+"#purchaseSubscriptionBox";pdf.$noAccessModal.find("#articleLinkToPurchase").attr("href",i),SCM.Utilities.Reveal.open(pdf.$noAccessModal)}function openNoAccessModalArticleSeo(t,e,i){if(t.attr({"data-reveal-id":"noAccessReveal","data-reveal":""}).removeAttr("data-ajax-url"),"DO_NOT_USE"===i)pdf.$noAccessModal.find("#articleLinkToPurchase").remove();else{var n=i;pdf.$noAccessModal.find("#articleLinkToPurchase").attr("href",n)}SCM.Utilities.Reveal.open(pdf.$noAccessModal)}pdf.$noAccessModal=$("#noAccessReveal"),pdf.checkArticlePDFAccess=function(e){var i=e.attr("data-article-id"),n=e.attr("data-article-url"),t=e.attr("data-ajax-url"),o=$("#hfSiteURL"),a="";null!==e.attr("data-article-seo-url")&&(a=e.attr("data-article-seo-url")),void 0!==o&&void 0!==o.val()&&""!==o&&(t="//"+o.val()+t);var s=i,r={};r.aId=s,$.ajax({type:"POST",url:t,data:r,traditional:!0,success:function(t){t.Success?openPDF(n):0<a.length?openNoAccessModalArticleSeo(e,i,a):openNoAccessModalArticle(e,i)},error:function(t,e,i){logErrors(t,e,i)}})},pdf.checkIssuePDFAccess=function(n){if(n.length){var t=n.attr("data-issue-id"),e=n.attr("data-ajax-issue-url");$.ajax({type:"POST",url:e,data:{issueId:t},traditional:!0,success:function(t){t.Success?n.show():n.hide()},error:function(t,e,i){n.hide()}})}},pdf.bindUiEvents=function(){$(document).on("click",".al-link.pdfaccess",function(){SCM.Utilities.Reveal.close(pdf.$noAccessModal),pdf.$noAccessModal.find("#articleLinkToPurchase").show(),pdf.$noAccessModal.find(".issue-purchase-modal").hide(),$(this).attr("data-reveal-id")||pdf.checkArticlePDFAccess($(this))}),pdf.checkIssuePDFAccess($(".js-issue-pdfLink"))},pdf.init=function(){pdf.bindUiEvents()}}(SCM.PDFAccess=SCM.PDFAccess||{},jQuery);var SCM=SCM||{};SCM.ArticleListResources=SCM.ArticleListResources||{},SCM.ArticleListResources.registerSnippetViewMore=function(){$(document).on("click",".al-article-snippet-view-more",function(){$(this).parent(".al-article-snippet").toggleClass("collapsed expanded")})},SCM.ArticleListResources.getArticleDetails=function(){$(document).ready(function(){var t="";$(".al-article-items[data-article-id]").has(".Locked").each(function(){0<t.length&&(t+=","),t+=$(this).attr("data-article-id")});if(0<t.length){var e=$(".article-list-resources").first().attr("data-journalIds");$.post("/Article/ArticleListResourcesDetails",{journalIds:e,accessCheckArticleIds:t},function(t){for(var e in t){$('.al-article-items[data-article-id="'+e+'"]').find(".article-accessType").removeClass("Locked").addClass(t[e])}},"json")}})},SCM.ArticleListResources.registerSnippetViewMore(),SCM.ArticleListResources.getArticleDetails();var SCM=SCM||{};SCM.QueryBuilder={},SCM.QueryBuilder.defaults={runSearch:function(t){window.location.hash="#"+t}},SCM.QueryBuilder.configure=function(){function i(t){var e=t,i=e.closest(".querybuilder-instance");e.hasClass("filter-citation")?(i.find(a).addClass("hide"),i.find(s).removeClass("hide")):(i.find(s).addClass("hide"),i.find(a).removeClass("hide"))}var e,t=$(".querybuilder-filter"),n=$(".querybuilder-filter-current-wrap"),o=$(".querybuilder-filter-dropdown"),a=$(".querybuilder-input-standard"),s=$(".querybuilder-input-citation"),r=$(".querybuilder-instance"),l=$(".querybuilder-add");function c(i,n){r.each(function(){var t=r.attr("id"),e=$(this).find("li[data-fieldname='Citation']");t===i&&null!==i||(n?e.show():e.hide())})}(e=jQuery)(".querybuilder-instance").each(function(){e(this).hasClass("hide")}),t.each(function(){var t=e(this);t.hasClass("selected")&&(t.closest(n).find(".querybuilder-filter-label-text").text(t.text()),i(t))}),n.off("click"),n.on("click",function(t){$(".sort-order-list").addClass("hide"),t.stopPropagation();var e=$(this).find(o);o.not(e).addClass("hide"),e.hasClass("hide")?e.removeClass("hide"):e.addClass("hide")}),$(document).off("click",".pg_searchresults"),$(document).on("click",".pg_searchresults",function(){o.addClass("hide")}),t.off("click"),t.on("click",function(){var t=$(this),e=t.closest(".querybuilder-filter-dropdown");($thisLabel=t.closest(n).find(".querybuilder-filter-label-text"),e.children(t).removeClass("selected"),t.addClass("selected"),$thisLabel.text(t.text()),i(t),t.hasClass("filter-citation"))?c(t.closest(".querybuilder-instance").attr("id)"),!1):function(){var t=function(){var t=null;return r.each(function(){if(!$(this).hasClass("hide")&&!$(this).find(s).hasClass("hide"))return t=$(this).attr("id"),!1}),t}();c(t,null===t)}()}),$(".querybuilder-input, .citation-input").on("keyup",function(){$("#queryBuilderSubmit").addClass("btn-green").removeAttr("style"),function(t){!function(t){var e=t;if(e.hasClass("citation-input")){var i=e.find(".citation-year").val().replace(/\'/g,"").trim().length,n=e.find(".citation-volume").val().replace(/\'/g,"").trim().length,o=e.find(".citation-issue").val().replace(/\'/g,"").trim().length,a=e.find(".citation-page").val().replace(/\'/g,"").trim().length;if(0<i||0<n||0<o||0<a)return!0;if(0===i&&0===n&&0===o&&0===a)return!1}else{var s=e.val().replace(/\'/g,"").trim().length;if(0===s)return!1;if(0<s)return!0}}(t)?l.removeClass("valid").prop("disabled",!0):l.addClass("valid").prop("disabled",!1)}($(this))}),l.off("click"),l.on("click",function(){if($(this).prop("disabled"))alert("A value must be entered before adding another filter.");else{var t=1;r.each(function(){$(this).hasClass("hide")||(0,t++)}),$("#qbInstance"+t).removeClass("hide"),l.removeClass("valid").prop("disabled",!0)}}),$(".querybuilder-submit").off("click"),$(".querybuilder-submit").on("click",function(){$(this).removeClass("btn-green").attr("style","opacity: 0.3;")})},$(".js-main").off("click",".querybuilder-submit"),$(".js-main").on("click",".querybuilder-submit",function(){var t="",y=$("#hfCurrentSearchTerm").val(),b=$(".querybuilder-submit").attr("data-current-url"),C=new Object,w=1,S=!1;function k(t,e){var i="",n="";if(0<=e.indexOf("q=")){var o=SCM.Common.getQueryStringValue(e,"q");o.startsWith("(")||(i="("),i=o.endsWith(")")?i+o.slice(0,-1)+" AND "+t+")":i+o+" AND "+t+")",n=e.replace(o,i)}else n="q="+t+"&"+e;return n}$(".querybuilder-wrap .querybuilder-instance").each(function(t){if(!$(this).hasClass("hide")){var e=$(this).find(".querybuilder-filter-dropdown li.selected").text(),i=$(this).find(".querybuilder-filter-dropdown li.selected").attr("data-fieldname"),n=!1;if(1===w){if(null==i||""===$.trim(i)){var o=$(this).find("#instance_QueryBuilderSearchTerm").val().trim();if(o=o.replace("&",encodeURIComponent("&")),y!==o){var a=b.indexOf("q=");if(0<=a){var s=0<=b.indexOf("&",a)?"&":"",r=SCM.Common.getQueryStringValue(b,"q");b=null!==r&&""!==r?(r="q="+r+s,b.replace(r,"q="+o+s)):"q="+o+"&"+b}else b="q="+o+"&"+b}return C.q=o,w++,S=!0}var l=SCM.Common.getQueryStringValue(b,"q");if(null!==l&&""!==l){l="q="+l;var c=b.indexOf(l)+l.length;l+="&"===b[c]?"&":"",b=b.replace(l,"")}n=!0}var d="";switch(e){case"":var u="q"+w;""!==(d=(d=$(this).find("#instance_QueryBuilderSearchTerm").val().trim()).replace("&",encodeURIComponent("&")))&&(b=k(d,b),C[u]=d,S=!0);break;case"All":if(""!==(d=(d=$(this).find("#instance_QueryBuilderSearchTerm").val().trim()).replace("&",encodeURIComponent("&"))))b=k(d,b),(1===w&&n||1!==w)&&(C["All"+w]=d,S=!0);break;case"Citation":var h=new Object,p="Citation"+w,f=$(this).find("#instance_CitationYear").val().trim(),m=$(this).find("#instance_CitationVolume").val().trim(),g=$(this).find("#instance_CitationIssueNo").val().trim(),v=$(this).find("#instance_CitationPage").val().trim();""===f&&""===m&&""===g&&""===v||(C[p]=h,S=!0,null!==f&&""!==f&&(h.Year=f),null!==m&&""!==m&&(h.Volume=m),null!==g&&""!==g&&(h.IssueNo=g),null!==v&&""!==v&&(h.StartPage=v));break;default:var _=i+w;""!==(d=(d=$(this).find("#instance_QueryBuilderSearchTerm").val().trim()).replace("&",encodeURIComponent("&")))&&(C[_]=d,S=!0)}}w++});var e=SCM.Common.getQueryStringValue(b,"page");if("page=1"===b&&(b="&page=1"),null!==e&&""!==e&&(b=b.replace("page="+e+"&","page=1&")),t=b,S){var i=JSON.stringify(C);i=-1!==i.indexOf("&")?encodeURIComponent(i):i;var n=SCM.Common.getQueryStringValue(b,"qb");if(n)t=t.replace(n,i);else t=t+("&"===t[t.length-1]?"qb=":"&qb=")+i}SCM.QueryBuilder.defaults.runSearch(t)}),$(".querybuilder-input").keyup(function(t){var e=t.which;13===e&&t.preventDefault();var i=$.trim($(this).val());if(13===e&&""!==i)return $(".querybuilder-submit").click(),!1}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.indexOf(t,e)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var i=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;var n=i.lastIndexOf(t,e);return-1!==n&&n===e}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(S){function n(t,e){var i,n,o,a=t.nodeName.toLowerCase();return"area"===a?(n=(i=t.parentNode).name,!(!t.href||!n||"map"!==i.nodeName.toLowerCase())&&(!!(o=S("img[usemap='#"+n+"']")[0])&&s(o))):(/^(input|select|textarea|button|object)$/.test(a)?!t.disabled:"a"===a&&t.href||e)&&s(t)}function s(t){return S.expr.filters.visible(t)&&!S(t).parents().addBack().filter(function(){return"hidden"===S.css(this,"visibility")}).length}function t(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},S.extend(this._defaults,this.regional[""]),this.regional.en=S.extend(!0,{},this.regional[""]),this.regional["en-US"]=S.extend(!0,{},this.regional.en),this.dpDiv=i(S("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function i(t){var e="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(e,"mouseout",function(){S(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&S(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&S(this).removeClass("ui-datepicker-next-hover")}).delegate(e,"mouseover",a)}function a(){S.datepicker._isDisabledDatepicker(c.inline?c.dpDiv.parent()[0]:c.input[0])||(S(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),S(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&S(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&S(this).addClass("ui-datepicker-next-hover"))}function u(t,e){for(var i in S.extend(t,e),e)null==e[i]&&(t[i]=e[i]);return t}var e,o,r,l,c;S.ui=S.ui||{},S.extend(S.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),S.fn.extend({scrollParent:function(t){var e=this.css("position"),i="absolute"===e,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=S(this);return(!i||"static"!==t.css("position"))&&n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&o.length?o:S(this[0].ownerDocument||document)},uniqueId:(l=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++l)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&S(this).removeAttr("id")})}}),S.extend(S.expr[":"],{data:S.expr.createPseudo?S.expr.createPseudo(function(e){return function(t){return!!S.data(t,e)}}):function(t,e,i){return!!S.data(t,i[3])},focusable:function(t){return n(t,!isNaN(S.attr(t,"tabindex")))},tabbable:function(t){var e=S.attr(t,"tabindex"),i=isNaN(e);return(i||0<=e)&&n(t,!i)}}),S("<a>").outerWidth(1).jquery||S.each(["Width","Height"],function(t,i){function n(t,e,i,n){return S.each(o,function(){e-=parseFloat(S.css(t,"padding"+this))||0,i&&(e-=parseFloat(S.css(t,"border"+this+"Width"))||0),n&&(e-=parseFloat(S.css(t,"margin"+this))||0)}),e}var o="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),s={innerWidth:S.fn.innerWidth,innerHeight:S.fn.innerHeight,outerWidth:S.fn.outerWidth,outerHeight:S.fn.outerHeight};S.fn["inner"+i]=function(t){return void 0===t?s["inner"+i].call(this):this.each(function(){S(this).css(a,n(this,t)+"px")})},S.fn["outer"+i]=function(t,e){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){S(this).css(a,n(this,t,!0,e)+"px")})}}),S.fn.addBack||(S.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),S("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(S.fn.removeData=(r=S.fn.removeData,function(t){return arguments.length?r.call(this,S.camelCase(t)):r.call(this)})),S.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),S.fn.extend({focus:(o=S.fn.focus,function(e,i){return"number"==typeof e?this.each(function(){var t=this;setTimeout(function(){S(t).focus(),i&&i.call(t)},e)}):o.apply(this,arguments)}),disableSelection:(e="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(e+".ui-disableSelection",function(t){t.preventDefault()})}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var e,i,n=S(this[0]);n.length&&n[0]!==document;){if(("absolute"===(e=n.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(n.css("zIndex"),10),!isNaN(i)&&0!==i))return i;n=n.parent()}return 0}}),S.ui.plugin={add:function(t,e,i){var n,o=S.ui[t].prototype;for(n in i)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([e,i[n]])},call:function(t,e,i,n){var o,a=t.plugins[e];if(a&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(o=0;a.length>o;o++)t.options[a[o][0]]&&a[o][1].apply(t.element,i)}},S.extend(S.ui,{datepicker:{version:"1.11.4"}}),S.extend(t.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return u(this._defaults,t||{}),this},_attachDatepicker:function(t,e){var i,n,o;n="div"===(i=t.nodeName.toLowerCase())||"span"===i,t.id||(this.uuid+=1,t.id="dp"+this.uuid),(o=this._newInst(S(t),n)).settings=S.extend({},e||{}),"input"===i?this._connectDatepicker(t,o):n&&this._inlineDatepicker(t,o)},_newInst:function(t,e){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?i(S("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,e){var i=S(t);e.append=S([]),e.trigger=S([]),i.hasClass(this.markerClassName)||(this._attachments(i,e),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(e),S.data(t,"datepicker",e),e.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,e){var i,n,o,a=this._get(e,"appendText"),s=this._get(e,"isRTL");e.append&&e.append.remove(),a&&(e.append=S("<span class='"+this._appendClass+"'>"+a+"</span>"),t[s?"before":"after"](e.append)),t.unbind("focus",this._showDatepicker),e.trigger&&e.trigger.remove(),"focus"!==(i=this._get(e,"showOn"))&&"both"!==i||t.focus(this._showDatepicker),"button"!==i&&"both"!==i||(n=this._get(e,"buttonText"),o=this._get(e,"buttonImage"),e.trigger=S(this._get(e,"buttonImageOnly")?S("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):S("<button type='button'></button>").addClass(this._triggerClass).html(o?S("<img/>").attr({src:o,alt:n,title:n}):n)),t[s?"before":"after"](e.trigger),e.trigger.click(function(){return S.datepicker._datepickerShowing&&S.datepicker._lastInput===t[0]?S.datepicker._hideDatepicker():(S.datepicker._datepickerShowing&&S.datepicker._lastInput!==t[0]&&S.datepicker._hideDatepicker(),S.datepicker._showDatepicker(t[0])),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,o,a=new Date(2009,11,20),s=this._get(t,"dateFormat");s.match(/[DM]/)&&(e=function(t){for(o=n=i=0;t.length>o;o++)t[o].length>i&&(i=t[o].length,n=o);return n},a.setMonth(e(this._get(t,s.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(e(this._get(t,s.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),t.input.attr("size",this._formatDate(t,a).length)}},_inlineDatepicker:function(t,e){var i=S(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(e.dpDiv),S.data(t,"datepicker",e),this._setDate(e,this._getDefaultDate(e),!0),this._updateDatepicker(e),this._updateAlternate(e),e.settings.disabled&&this._disableDatepicker(t),e.dpDiv.css("display","block"))},_dialogDatepicker:function(t,e,i,n,o){var a,s,r,l,c,d=this._dialogInst;return d||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=S("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),S("body").append(this._dialogInput),(d=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},S.data(this._dialogInput[0],"datepicker",d)),u(d.settings,n||{}),e=e&&e.constructor===Date?this._formatDate(d,e):e,this._dialogInput.val(e),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(s=document.documentElement.clientWidth,r=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[s/2-100+l,r/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),S.blockUI&&S.blockUI(this.dpDiv),S.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(t){var e,i=S(t),n=S.data(t,"datepicker");i.hasClass(this.markerClassName)&&(e=t.nodeName.toLowerCase(),S.removeData(t,"datepicker"),"input"===e?(n.append.remove(),n.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==e&&"span"!==e||i.removeClass(this.markerClassName).empty(),c===n&&(c=null))},_enableDatepicker:function(e){var t,i,n=S(e),o=S.data(e,"datepicker");n.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==t&&"span"!==t||((i=n.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=S.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var t,i,n=S(e),o=S.data(e,"datepicker");n.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==t&&"span"!==t||((i=n.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=S.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(t){try{return S.data(t,"datepicker")}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,e,i){var n,o,a,s,r=this._getInst(t);return 2===arguments.length&&"string"==typeof e?"defaults"===e?S.extend({},S.datepicker._defaults):r?"all"===e?S.extend({},r.settings):this._get(r,e):null:(n=e||{},"string"==typeof e&&((n={})[e]=i),void(r&&(this._curInst===r&&this._hideDatepicker(),o=this._getDateDatepicker(t,!0),a=this._getMinMaxDate(r,"min"),s=this._getMinMaxDate(r,"max"),u(r.settings,n),null!==a&&void 0!==n.dateFormat&&void 0===n.minDate&&(r.settings.minDate=this._formatDate(r,a)),null!==s&&void 0!==n.dateFormat&&void 0===n.maxDate&&(r.settings.maxDate=this._formatDate(r,s)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(S(t),r),this._autoSize(r),this._setDate(r,o),this._updateAlternate(r),this._updateDatepicker(r))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(t){var e,i,n,o=S.datepicker._getInst(t.target),a=!0,s=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,S.datepicker._datepickerShowing)switch(t.keyCode){case 9:S.datepicker._hideDatepicker(),a=!1;break;case 13:return(n=S("td."+S.datepicker._dayOverClass+":not(."+S.datepicker._currentClass+")",o.dpDiv))[0]&&S.datepicker._selectDay(t.target,o.selectedMonth,o.selectedYear,n[0]),(e=S.datepicker._get(o,"onSelect"))?(i=S.datepicker._formatDate(o),e.apply(o.input?o.input[0]:null,[i,o])):S.datepicker._hideDatepicker(),!1;case 27:S.datepicker._hideDatepicker();break;case 33:S.datepicker._adjustDate(t.target,t.ctrlKey?-S.datepicker._get(o,"stepBigMonths"):-S.datepicker._get(o,"stepMonths"),"M");break;case 34:S.datepicker._adjustDate(t.target,t.ctrlKey?+S.datepicker._get(o,"stepBigMonths"):+S.datepicker._get(o,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&S.datepicker._clearDate(t.target),a=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&S.datepicker._gotoToday(t.target),a=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&S.datepicker._adjustDate(t.target,s?1:-1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&S.datepicker._adjustDate(t.target,t.ctrlKey?-S.datepicker._get(o,"stepBigMonths"):-S.datepicker._get(o,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&S.datepicker._adjustDate(t.target,-7,"D"),a=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&S.datepicker._adjustDate(t.target,s?-1:1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&S.datepicker._adjustDate(t.target,t.ctrlKey?+S.datepicker._get(o,"stepBigMonths"):+S.datepicker._get(o,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&S.datepicker._adjustDate(t.target,7,"D"),a=t.ctrlKey||t.metaKey;break;default:a=!1}else 36===t.keyCode&&t.ctrlKey?S.datepicker._showDatepicker(this):a=!1;a&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var e,i,n=S.datepicker._getInst(t.target);return S.datepicker._get(n,"constrainInput")?(e=S.datepicker._possibleChars(S.datepicker._get(n,"dateFormat")),i=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||i<" "||!e||-1<e.indexOf(i)):void 0},_doKeyUp:function(t){var e=S.datepicker._getInst(t.target);if(e.input.val()!==e.lastVal)try{S.datepicker.parseDate(S.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,S.datepicker._getFormatConfig(e))&&(S.datepicker._setDateFromField(e),S.datepicker._updateAlternate(e),S.datepicker._updateDatepicker(e))}catch(t){}return!0},_showDatepicker:function(t){var e,i,n,o,a,s,r;"input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=S("input",t.parentNode)[0]),S.datepicker._isDisabledDatepicker(t)||S.datepicker._lastInput===t||(e=S.datepicker._getInst(t),S.datepicker._curInst&&S.datepicker._curInst!==e&&(S.datepicker._curInst.dpDiv.stop(!0,!0),e&&S.datepicker._datepickerShowing&&S.datepicker._hideDatepicker(S.datepicker._curInst.input[0])),!1!==(n=(i=S.datepicker._get(e,"beforeShow"))?i.apply(t,[t,e]):{})&&(u(e.settings,n),e.lastVal=null,S.datepicker._lastInput=t,S.datepicker._setDateFromField(e),S.datepicker._inDialog&&(t.value=""),S.datepicker._pos||(S.datepicker._pos=S.datepicker._findPos(t),S.datepicker._pos[1]+=t.offsetHeight),o=!1,S(t).parents().each(function(){return!(o|="fixed"===S(this).css("position"))}),a={left:S.datepicker._pos[0],top:S.datepicker._pos[1]},S.datepicker._pos=null,e.dpDiv.empty(),e.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),S.datepicker._updateDatepicker(e),a=S.datepicker._checkOffset(e,a,o),e.dpDiv.css({position:S.datepicker._inDialog&&S.blockUI?"static":o?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),e.inline||(s=S.datepicker._get(e,"showAnim"),r=S.datepicker._get(e,"duration"),e.dpDiv.css("z-index",function(t){for(var e,i;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}(S(t))+1),S.datepicker._datepickerShowing=!0,S.effects&&S.effects.effect[s]?e.dpDiv.show(s,S.datepicker._get(e,"showOptions"),r):e.dpDiv[s||"show"](s?r:null),S.datepicker._shouldFocusInput(e)&&e.input.focus(),S.datepicker._curInst=e)))},_updateDatepicker:function(t){this.maxRows=4,(c=t).dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var e,i=this._getNumberOfMonths(t),n=i[1],o=t.dpDiv.find("."+this._dayOverClass+" a");0<o.length&&a.apply(o.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),1<n&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",17*n+"em"),t.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===S.datepicker._curInst&&S.datepicker._datepickerShowing&&S.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(e=t.yearshtml,setTimeout(function(){e===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),e=t.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(t,e,i){var n=t.dpDiv.outerWidth(),o=t.dpDiv.outerHeight(),a=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,r=document.documentElement.clientWidth+(i?0:S(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:S(document).scrollTop());return e.left-=this._get(t,"isRTL")?n-a:0,e.left-=i&&e.left===t.input.offset().left?S(document).scrollLeft():0,e.top-=i&&e.top===t.input.offset().top+s?S(document).scrollTop():0,e.left-=Math.min(e.left,e.left+n>r&&n<r?Math.abs(e.left+n-r):0),e.top-=Math.min(e.top,e.top+o>l&&o<l?Math.abs(o+s):0),e},_findPos:function(t){for(var e,i=this._getInst(t),n=this._get(i,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||S.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return[(e=S(t).offset()).left,e.top]},_hideDatepicker:function(t){var e,i,n,o,a=this._curInst;!a||t&&a!==S.data(t,"datepicker")||this._datepickerShowing&&(e=this._get(a,"showAnim"),i=this._get(a,"duration"),n=function(){S.datepicker._tidyDialog(a)},S.effects&&(S.effects.effect[e]||S.effects[e])?a.dpDiv.hide(e,S.datepicker._get(a,"showOptions"),i,n):a.dpDiv["slideDown"===e?"slideUp":"fadeIn"===e?"fadeOut":"hide"](e?i:null,n),e||n(),this._datepickerShowing=!1,(o=this._get(a,"onClose"))&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),S.blockUI&&(S.unblockUI(),S("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(S.datepicker._curInst){var e=S(t.target),i=S.datepicker._getInst(e[0]);(e[0].id===S.datepicker._mainDivId||0!==e.parents("#"+S.datepicker._mainDivId).length||e.hasClass(S.datepicker.markerClassName)||e.closest("."+S.datepicker._triggerClass).length||!S.datepicker._datepickerShowing||S.datepicker._inDialog&&S.blockUI)&&(!e.hasClass(S.datepicker.markerClassName)||S.datepicker._curInst===i)||S.datepicker._hideDatepicker()}},_adjustDate:function(t,e,i){var n=S(t),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,e+("M"===i?this._get(o,"showCurrentAtPos"):0),i),this._updateDatepicker(o))},_gotoToday:function(t){var e,i=S(t),n=this._getInst(i[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(e=new Date,n.selectedDay=e.getDate(),n.drawMonth=n.selectedMonth=e.getMonth(),n.drawYear=n.selectedYear=e.getFullYear()),this._notifyChange(n),this._adjustDate(i)},_selectMonthYear:function(t,e,i){var n=S(t),o=this._getInst(n[0]);o["selected"+("M"===i?"Month":"Year")]=o["draw"+("M"===i?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(t,e,i,n){var o,a=S(t);S(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||((o=this._getInst(a[0])).selectedDay=o.currentDay=S("a",n).html(),o.selectedMonth=o.currentMonth=e,o.selectedYear=o.currentYear=i,this._selectDate(t,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(t){var e=S(t);this._selectDate(e,"")},_selectDate:function(t,e){var i,n=S(t),o=this._getInst(n[0]);e=null!=e?e:this._formatDate(o),o.input&&o.input.val(e),this._updateAlternate(o),(i=this._get(o,"onSelect"))?i.apply(o.input?o.input[0]:null,[e,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var e,i,n,o=this._get(t,"altField");o&&(e=this._get(t,"altFormat")||this._get(t,"dateFormat"),i=this._getDate(t),n=this.formatDate(e,i,this._getFormatConfig(t)),S(o).each(function(){S(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[0<e&&e<6,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(i,a,t){if(null==i||null==a)throw"Invalid arguments";if(""===(a="object"==typeof a?""+a:a+""))return null;function s(t){var e=i.length>r+1&&i.charAt(r+1)===t;return e&&r++,e}function e(t){var e=s(t),i="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n=RegExp("^\\d{"+("y"===t?i:1)+","+i+"}"),o=a.substring(u).match(n);if(!o)throw"Missing number at position "+u;return u+=o[0].length,parseInt(o[0],10)}function n(t,e,i){var n=-1,o=S.map(s(t)?i:e,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(S.each(o,function(t,e){var i=e[1];return a.substr(u,i.length).toLowerCase()===i.toLowerCase()?(n=e[0],u+=i.length,!1):void 0}),-1!==n)return n+1;throw"Unknown name at position "+u}function o(){if(a.charAt(u)!==i.charAt(r))throw"Unexpected literal at position "+u;u++}var r,l,c,d,u=0,h=(t?t.shortYearCutoff:null)||this._defaults.shortYearCutoff,p="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),f=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,m=(t?t.dayNames:null)||this._defaults.dayNames,g=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,v=(t?t.monthNames:null)||this._defaults.monthNames,_=-1,y=-1,b=-1,C=-1,w=!1;for(r=0;i.length>r;r++)if(w)"'"!==i.charAt(r)||s("'")?o():w=!1;else switch(i.charAt(r)){case"d":b=e("d");break;case"D":n("D",f,m);break;case"o":C=e("o");break;case"m":y=e("m");break;case"M":y=n("M",g,v);break;case"y":_=e("y");break;case"@":_=(d=new Date(e("@"))).getFullYear(),y=d.getMonth()+1,b=d.getDate();break;case"!":_=(d=new Date((e("!")-this._ticksTo1970)/1e4)).getFullYear(),y=d.getMonth()+1,b=d.getDate();break;case"'":s("'")?o():w=!0;break;default:o()}if(a.length>u&&(c=a.substr(u),!/^\s+/.test(c)))throw"Extra/unparsed characters found in date: "+c;if(-1===_?_=(new Date).getFullYear():_<100&&(_+=(new Date).getFullYear()-(new Date).getFullYear()%100+(_<=p?0:-100)),-1<C)for(y=1,b=C;!(b<=(l=this._getDaysInMonth(_,y-1)));)y++,b-=l;if((d=this._daylightSavingAdjust(new Date(_,y-1,b))).getFullYear()!==_||d.getMonth()+1!==y||d.getDate()!==b)throw"Invalid date";return d},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(i,t,e){if(!t)return"";function o(t){var e=i.length>s+1&&i.charAt(s+1)===t;return e&&s++,e}function n(t,e,i){var n=""+e;if(o(t))for(;i>n.length;)n="0"+n;return n}function a(t,e,i,n){return o(t)?n[e]:i[e]}var s,r=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,l=(e?e.dayNames:null)||this._defaults.dayNames,c=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,d=(e?e.monthNames:null)||this._defaults.monthNames,u="",h=!1;if(t)for(s=0;i.length>s;s++)if(h)"'"!==i.charAt(s)||o("'")?u+=i.charAt(s):h=!1;else switch(i.charAt(s)){case"d":u+=n("d",t.getDate(),2);break;case"D":u+=a("D",t.getDay(),r,l);break;case"o":u+=n("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=n("m",t.getMonth()+1,2);break;case"M":u+=a("M",t.getMonth(),c,d);break;case"y":u+=o("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":o("'")?u+="'":h=!0;break;default:u+=i.charAt(s)}return u},_possibleChars:function(i){function t(t){var e=i.length>n+1&&i.charAt(n+1)===t;return e&&n++,e}var n,e="",o=!1;for(n=0;i.length>n;n++)if(o)"'"!==i.charAt(n)||t("'")?e+=i.charAt(n):o=!1;else switch(i.charAt(n)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":t("'")?e+="'":o=!0;break;default:e+=i.charAt(n)}return e},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,o=this._getDefaultDate(t),a=o,s=this._getFormatConfig(t);try{a=this.parseDate(i,n,s)||o}catch(t){n=e?"":n}t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),t.currentDay=n?a.getDate():0,t.currentMonth=n?a.getMonth():0,t.currentYear=n?a.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(r,t,e){var i,n,o=null==t||""===t?e:"string"==typeof t?function(t){try{return S.datepicker.parseDate(S.datepicker._get(r,"dateFormat"),t,S.datepicker._getFormatConfig(r))}catch(t){}for(var e=(t.toLowerCase().match(/^c/)?S.datepicker._getDate(r):null)||new Date,i=e.getFullYear(),n=e.getMonth(),o=e.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,s=a.exec(t);s;){switch(s[2]||"d"){case"d":case"D":o+=parseInt(s[1],10);break;case"w":case"W":o+=7*parseInt(s[1],10);break;case"m":case"M":n+=parseInt(s[1],10),o=Math.min(o,S.datepicker._getDaysInMonth(i,n));break;case"y":case"Y":i+=parseInt(s[1],10),o=Math.min(o,S.datepicker._getDaysInMonth(i,n))}s=a.exec(t)}return new Date(i,n,o)}(t):"number"==typeof t?isNaN(t)?e:(i=t,(n=new Date).setDate(n.getDate()+i),n):new Date(t.getTime());return(o=o&&"Invalid Date"==""+o?e:o)&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(t){return t?(t.setHours(12<t.getHours()?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,o=t.selectedMonth,a=t.selectedYear,s=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=s.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=s.getMonth(),t.drawYear=t.selectedYear=t.currentYear=s.getFullYear(),o===t.selectedMonth&&a===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(t){var e=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){S.datepicker._adjustDate(i,-e,"M")},next:function(){S.datepicker._adjustDate(i,+e,"M")},hide:function(){S.datepicker._hideDatepicker()},today:function(){S.datepicker._gotoToday(i)},selectDay:function(){return S.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return S.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return S.datepicker._selectMonthYear(i,this,"Y"),!1}};S(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,o,a,s,r,l,c,d,u,h,p,f,m,g,v,_,y,b,C,w,S,k,x,L,M,D,T,P,A,I,E,j,$,U,F,O,R,B=new Date,z=this._daylightSavingAdjust(new Date(B.getFullYear(),B.getMonth(),B.getDate())),N=this._get(t,"isRTL"),q=this._get(t,"showButtonPanel"),Z=this._get(t,"hideIfNoPrevNext"),H=this._get(t,"navigationAsDateFormat"),W=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),G=this._get(t,"stepMonths"),J=1!==W[0]||1!==W[1],Y=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(t,"min"),K=this._getMinMaxDate(t,"max"),X=t.drawMonth-V,tt=t.drawYear;if(X<0&&(X+=12,tt--),K)for(e=this._daylightSavingAdjust(new Date(K.getFullYear(),K.getMonth()-W[0]*W[1]+1,K.getDate())),e=Q&&e<Q?Q:e;this._daylightSavingAdjust(new Date(tt,X,1))>e;)--X<0&&(X=11,tt--);for(t.drawMonth=X,t.drawYear=tt,i=this._get(t,"prevText"),i=H?this.formatDate(i,this._daylightSavingAdjust(new Date(tt,X-G,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,tt,X)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(N?"e":"w")+"'>"+i+"</span></a>":Z?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(N?"e":"w")+"'>"+i+"</span></a>",o=this._get(t,"nextText"),o=H?this.formatDate(o,this._daylightSavingAdjust(new Date(tt,X+G,1)),this._getFormatConfig(t)):o,a=this._canAdjustMonth(t,1,tt,X)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(N?"w":"e")+"'>"+o+"</span></a>":Z?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+o+"'><span class='ui-icon ui-icon-circle-triangle-"+(N?"w":"e")+"'>"+o+"</span></a>",s=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?Y:z,s=H?this.formatDate(s,r,this._getFormatConfig(t)):s,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",c=q?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(N?l:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+s+"</button>":"")+(N?"":l)+"</div>":"",d=parseInt(this._get(t,"firstDay"),10),d=isNaN(d)?0:d,u=this._get(t,"showWeek"),h=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),_=this._get(t,"selectOtherMonths"),y=this._getDefaultDate(t),b="",w=0;W[0]>w;w++){for(S="",this.maxRows=4,k=0;W[1]>k;k++){if(x=this._daylightSavingAdjust(new Date(tt,X,t.selectedDay)),L=" ui-corner-all",M="",J){if(M+="<div class='ui-datepicker-group",1<W[1])switch(k){case 0:M+=" ui-datepicker-group-first",L=" ui-corner-"+(N?"right":"left");break;case W[1]-1:M+=" ui-datepicker-group-last",L=" ui-corner-"+(N?"left":"right");break;default:M+=" ui-datepicker-group-middle",L=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+L+"'>"+(/all|left/.test(L)&&0===w?N?a:n:"")+(/all|right/.test(L)&&0===w?N?n:a:"")+this._generateMonthYearHeader(t,X,tt,Q,K,0<w||0<k,f,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",D=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",C=0;C<7;C++)D+="<th scope='col'"+(5<=(C+d+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+h[T=(C+d)%7]+"'>"+p[T]+"</span></th>";for(M+=D+"</tr></thead><tbody>",P=this._getDaysInMonth(tt,X),tt===t.selectedYear&&X===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,P)),A=(this._getFirstDayOfMonth(tt,X)-d+7)%7,I=Math.ceil((A+P)/7),E=J&&this.maxRows>I?this.maxRows:I,this.maxRows=E,j=this._daylightSavingAdjust(new Date(tt,X,1-A)),$=0;$<E;$++){for(M+="<tr>",U=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(j)+"</td>":"",C=0;C<7;C++)F=g?g.apply(t.input?t.input[0]:null,[j]):[!0,""],R=(O=j.getMonth()!==X)&&!_||!F[0]||Q&&j<Q||K&&K<j,U+="<td class='"+(5<=(C+d+6)%7?" ui-datepicker-week-end":"")+(O?" ui-datepicker-other-month":"")+(j.getTime()===x.getTime()&&X===t.selectedMonth&&t._keyEvent||y.getTime()===j.getTime()&&y.getTime()===x.getTime()?" "+this._dayOverClass:"")+(R?" "+this._unselectableClass+" ui-state-disabled":"")+(O&&!v?"":" "+F[1]+(j.getTime()===Y.getTime()?" "+this._currentClass:"")+(j.getTime()===z.getTime()?" ui-datepicker-today":""))+"'"+(O&&!v||!F[2]?"":" title='"+F[2].replace(/'/g,"&#39;")+"'")+(R?"":" data-handler='selectDay' data-event='click' data-month='"+j.getMonth()+"' data-year='"+j.getFullYear()+"'")+">"+(O&&!v?"&#xa0;":R?"<span class='ui-state-default'>"+j.getDate()+"</span>":"<a class='ui-state-default"+(j.getTime()===z.getTime()?" ui-state-highlight":"")+(j.getTime()===Y.getTime()?" ui-state-active":"")+(O?" ui-priority-secondary":"")+"' href='#'>"+j.getDate()+"</a>")+"</td>",j.setDate(j.getDate()+1),j=this._daylightSavingAdjust(j);M+=U+"</tr>"}11<++X&&(X=0,tt++),S+=M+="</tbody></table>"+(J?"</div>"+(0<W[0]&&k===W[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}b+=S}return b+=c,t._keyEvent=!1,b},_generateMonthYearHeader:function(t,e,i,n,o,a,s,r){var l,c,d,u,h,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),_=this._get(t,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",b="";if(a||!g)b+="<span class='ui-datepicker-month'>"+s[e]+"</span>";else{for(l=n&&n.getFullYear()===i,c=o&&o.getFullYear()===i,b+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",d=0;d<12;d++)(!l||d>=n.getMonth())&&(!c||o.getMonth()>=d)&&(b+="<option value='"+d+"'"+(d===e?" selected='selected'":"")+">"+r[d]+"</option>");b+="</select>"}if(_||(y+=b+(!a&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",a||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),h=(new Date).getFullYear(),f=(p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?h+parseInt(t,10):parseInt(t,10);return isNaN(e)?h:e})(u[0]),m=Math.max(f,p(u[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=o?Math.min(m,o.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";f<=m;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",y+=t.yearshtml,t.yearshtml=null}return y+=this._get(t,"yearSuffix"),_&&(y+=(!a&&g&&v?"":"&#xa0;")+b),y+"</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),o=t.drawMonth+("M"===i?e:0),a=Math.min(t.selectedDay,this._getDaysInMonth(n,o))+("D"===i?e:0),s=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,o,a)));t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),o=i&&e<i?i:e;return n&&n<o?n:o},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var o=this._getNumberOfMonths(t),a=this._daylightSavingAdjust(new Date(i,n+(e<0?e:o[0]*o[1]),1));return e<0&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(t,a)},_isInRange:function(t,e){var i,n,o=this._getMinMaxDate(t,"min"),a=this._getMinMaxDate(t,"max"),s=null,r=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),s=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(s+=n),i[1].match(/[+\-].*/)&&(r+=n)),(!o||e.getTime()>=o.getTime())&&(!a||e.getTime()<=a.getTime())&&(!s||e.getFullYear()>=s)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var o=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),o,this._getFormatConfig(t))}}),S.fn.datepicker=function(t){if(!this.length)return this;S.datepicker.initialized||(S(document).mousedown(S.datepicker._checkExternalClick),S.datepicker.initialized=!0),0===S("#"+S.datepicker._mainDivId).length&&S("body").append(S.datepicker.dpDiv);var e=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?S.datepicker["_"+t+"Datepicker"].apply(S.datepicker,[this[0]].concat(e)):this.each(function(){"string"==typeof t?S.datepicker["_"+t+"Datepicker"].apply(S.datepicker,[this].concat(e)):S.datepicker._attachDatepicker(this,t)}):S.datepicker["_"+t+"Datepicker"].apply(S.datepicker,[this[0]].concat(e))},S.datepicker=new t,S.datepicker.initialized=!1,S.datepicker.uuid=(new Date).getTime(),S.datepicker.version="1.11.4",S.datepicker});var SCM=SCM||{};!function(t,s,n){var e,r,o,a;function l(){!function(){if(s(".tab-item").parent("li").show(),s(".tabs-content").length){var e="";s(".tabs-content > .content").each(function(){var t=s(this);t.hasClass("active")&&(e=t.attr("id"))}),s("#ViewsDrop li").show(),s("#ViewsDrop").find('[data-tab="#'+e+'"]').closest("li").hide()}}(),function(){var t=s(".item-with-dropdown");t.show(),t.each(function(){var e=!1,i=s(this),t=i.hasClass("item-pdf");i.find("ul li").each(function(){var t="none"===i.css("display");i.is(":visible")?e=!0:t||(e=!0)}),e||t||i.hide()})}()}function i(){if(s("#ContentTab .widget-ArticleFulltext").length){var t=s('.widget-items[data-widgetname="ArticleFulltext"]').find(".js-article-section"),e={$articleTopSections:s('.widget-items[data-widgetname="ArticleFulltext"]').children(),$contentSections:t,$figuresTablesSections:t.has(".table-wrap, .fig-section"),$videoSections:t.has(".video-section"),$audioSections:t.has(".audio-section"),$supplementaryData:s(".widget-ArticleDataSupplements, .supplementary-material"),$commentsSection:s("#ContentTab").find("div.comments")};!function(t){r.find('.article-content-filter[data-content-filter="article-content"]').hide(),t.$figuresTablesSections.length||r.find('.article-content-filter[data-content-filter="figures-tables"]').remove();t.$videoSections.length||r.find('.article-content-filter[data-content-filter="video"]').remove();t.$audioSections.length||r.find('.article-content-filter[data-content-filter="audio"]').remove();t.$supplementaryData.length||r.find('.article-content-filter[data-content-filter="supplementary-data"]').remove()}(e),function(n){var o=s("#ContentTab").find("div.downloadImagesppt"),a=s(".article-metadata-standalone-panel");r.children(".article-content-filter").on("click",function(){var t=s(this);t.hide(),t.siblings().show();var e=t.attr("data-content-filter"),i=null;"figures-tables"===e?i=n.$figuresTablesSections:"video"===e?i=n.$videoSections:"audio"===e?i=n.$audioSections:"supplementary-data"===e&&(i=n.$supplementaryData),i&&i.length?(n.$articleTopSections.hide(),n.$contentSections.hide(),n.$supplementaryData.hide(),function(t){if(!t||!t.each)return;t.each(function(t,e){!function(t){if(!t||1!==t.length||!t.show)return;t.show();var e=t.parent();for(;e&&e.length&&!e.is("#ContentTab");)e.show(),e=e.parent()}(s(e))})}(i),n.$commentsSection.hide(),function(t,e){t.filter(".fig-section:not(:has(a[restricted]))").length?e.show():e.hide()}(i,o)):(n.$articleTopSections.show(),n.$contentSections.show(),1<a.length?a.show():a.hide(),n.$supplementaryData.show(),n.$commentsSection.show(),o.hide()),SCM.SiteJS.restrictedImages()})}(e)}}t.closeDropDownIfChildItemClicked=function(){s("#Toolbar .f-dropdown > li").on("click",function(){s(this).closest(".toolbar-item").trigger("click")})},t.removeTabLinkIfTabIsEmpty=function(t){s(t).find(".tab-trigger").each(function(){var t=s(this),e=t.attr("data-tab");if("#ContentTab"!==e&&s(e).find("*").length<20){var i=s(e).html();0===(void 0!==i?s.trim(i.replace(/(<([^>]+)>)/gi,"")):1).length&&t.parent("li").remove()}})},t.hideTabIfDropdownIsEmpty=function(){for(var t=[$pdfDrop,o,a],e=0;e<t.length;e++){var i=t[e];i.children("li").length<1&&i.parent().hide()}r.children("li").length<2&&r.parent().hide()},t.toggleTabContent=function(){s(".tab-trigger").on("click",function(t){t.preventDefault();var e=s(this).attr("data-tab"),i=s(e);i.siblings().removeClass("active"),i.addClass("active"),"#FigureTab"===e&&n.trigger("scroll"),l()})},t.styleToolbarStates=function(){e.on("click",".toolbar-item",function(){var t=s(this);t.addClass("clicked"),t.siblings().removeClass("clicked")}),n.on("click",function(){s(".toolbar-item").each(function(){var t=s(this);t.find("ul").hasClass("open")||t.removeClass("clicked")})})},t.init=function(){(e=s("#Toolbar")).length&&(r=s("#ViewsDrop"),o=s("#ShareDrop"),a=s("#ToolsDrop"),$pdfDrop=s("#PdfDrop"),l(),t.removeTabLinkIfTabIsEmpty(r),t.styleToolbarStates(),t.toggleTabContent(),i(),t.hideTabIfDropdownIsEmpty())}}(SCM.Toolbar=SCM.Toolbar||{},jQuery,$(document)),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(lt){lt.fn.jScrollPane=function(i){function n(c,t){function d(t){var e,i,n,o,a,s,r=!1,l=!1;if(M=t,void 0===D)a=c.scrollTop(),s=c.scrollLeft(),c.css({overflow:"hidden",padding:0}),T=c.innerWidth()+ot,P=c.innerHeight(),c.width(T),D=lt('<div class="jspPane" />').css("padding",nt).append(c.children()),A=lt('<div class="jspContainer" />').css({width:T+"px",height:P+"px"}).append(D).appendTo(c);else{if(c.css("width",""),r=M.stickToBottom&&function(){var t=E-P;return 20<t&&t-x()<10}(),l=M.stickToRight&&function(){var t=I-T;return 20<t&&t-k()<10}(),(o=c.innerWidth()+ot!=T||c.outerHeight()!=P)&&(T=c.innerWidth()+ot,P=c.innerHeight(),A.css({width:T+"px",height:P+"px"})),!o&&at==I&&D.outerHeight()==E)return void c.width(T);at=I,D.css("width",""),c.width(T),A.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}D.css("overflow","auto"),I=t.contentWidth?t.contentWidth:D[0].scrollWidth,E=D[0].scrollHeight,D.css("overflow",""),U=1<($=E/P),(F=1<(j=I/T))||U?(c.addClass("jspScrollable"),(e=M.maintainPosition&&(B||q))&&(i=k(),n=x()),U&&(A.append(lt('<div class="jspVerticalBar" />').append(lt('<div class="jspCap jspCapTop" />'),lt('<div class="jspTrack" />').append(lt('<div class="jspDrag" />').append(lt('<div class="jspDragTop" />'),lt('<div class="jspDragBottom" />'))),lt('<div class="jspCap jspCapBottom" />'))),Z=A.find(">.jspVerticalBar"),H=Z.find(">.jspTrack"),O=H.find(">.jspDrag"),M.showArrows&&(G=lt('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",f(0,-1)).bind("click.jsp",L),J=lt('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",f(0,1)).bind("click.jsp",L),M.arrowScrollOnHover&&(G.bind("mouseover.jsp",f(0,-1,G)),J.bind("mouseover.jsp",f(0,1,J))),p(H,M.verticalArrowPositions,G,J)),W=P,A.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){W-=lt(this).outerHeight()}),O.hover(function(){O.addClass("jspHover")},function(){O.removeClass("jspHover")}).bind("mousedown.jsp",function(t){lt("html").bind("dragstart.jsp selectstart.jsp",L),O.addClass("jspActive");var e=t.pageY-O.position().top;return lt("html").bind("mousemove.jsp",function(t){v(t.pageY-e,!1)}).bind("mouseup.jsp mouseleave.jsp",g),!1}),u()),F&&(A.append(lt('<div class="jspHorizontalBar" />').append(lt('<div class="jspCap jspCapLeft" />'),lt('<div class="jspTrack" />').append(lt('<div class="jspDrag" />').append(lt('<div class="jspDragLeft" />'),lt('<div class="jspDragRight" />'))),lt('<div class="jspCap jspCapRight" />'))),Y=A.find(">.jspHorizontalBar"),Q=Y.find(">.jspTrack"),z=Q.find(">.jspDrag"),M.showArrows&&(tt=lt('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",f(-1,0)).bind("click.jsp",L),et=lt('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",f(1,0)).bind("click.jsp",L),M.arrowScrollOnHover&&(tt.bind("mouseover.jsp",f(-1,0,tt)),et.bind("mouseover.jsp",f(1,0,et))),p(Q,M.horizontalArrowPositions,tt,et)),z.hover(function(){z.addClass("jspHover")},function(){z.removeClass("jspHover")}).bind("mousedown.jsp",function(t){lt("html").bind("dragstart.jsp selectstart.jsp",L),z.addClass("jspActive");var e=t.pageX-z.position().left;return lt("html").bind("mousemove.jsp",function(t){y(t.pageX-e,!1)}).bind("mouseup.jsp mouseleave.jsp",g),!1}),K=A.innerWidth(),h()),function(){if(F&&U){var t=Q.outerHeight(),e=H.outerWidth();W-=t,lt(Y).find(">.jspCap:visible,>.jspArrow").each(function(){K+=lt(this).outerWidth()}),K-=e,P-=e,T-=t,Q.parent().append(lt('<div class="jspCorner" />').css("width",t+"px")),u(),h()}F&&D.width(A.outerWidth()-ot+"px"),E=D.outerHeight(),$=E/P,F&&((X=Math.ceil(1/j*K))>M.horizontalDragMaxWidth?X=M.horizontalDragMaxWidth:X<M.horizontalDragMinWidth&&(X=M.horizontalDragMinWidth),z.width(X+"px"),N=K-X,b(q)),U&&((V=Math.ceil(1/$*W))>M.verticalDragMaxHeight?V=M.verticalDragMaxHeight:V<M.verticalDragMinHeight&&(V=M.verticalDragMinHeight),O.height(V+"px"),R=W-V,_(B))}(),e&&(w(l?I-T:i,!1),C(r?E-P:n,!1)),D.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(t){S(t.target,!1)}),A.unbind(rt).bind(rt,function(t,e,i,n){var o=q=q||0,a=B=B||0,s=t.deltaFactor||M.mouseWheelSpeed;return st.scrollBy(i*s,-n*s,!1),o==q&&a==B}),function(){var o,a,s,r,l,c=!1;A.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(t){var e=t.originalEvent.touches[0];o=k(),a=x(),s=e.pageX,r=e.pageY,c=!(l=!1)}).bind("touchmove.jsp",function(t){if(c){var e=t.originalEvent.touches[0],i=q,n=B;return st.scrollTo(o+s-e.pageX,a+r-e.pageY),l=l||5<Math.abs(s-e.pageX)||5<Math.abs(r-e.pageY),i==q&&n==B}}).bind("touchend.jsp",function(){c=!1}).bind("click.jsp-touchclick",function(){return l?l=!1:void 0})}(),M.enableKeyboardNavigation&&function(){function n(){var t=q,e=B;switch(o){case 40:st.scrollByY(M.keyboardSpeed,!1);break;case 38:st.scrollByY(-M.keyboardSpeed,!1);break;case 34:case 32:st.scrollByY(P*M.scrollPagePercent,!1);break;case 33:st.scrollByY(-P*M.scrollPagePercent,!1);break;case 39:st.scrollByX(M.keyboardSpeed,!1);break;case 37:st.scrollByX(-M.keyboardSpeed,!1)}return a=t!=q||e!=B}var o,a,s=[];F&&s.push(Y[0]),U&&s.push(Z[0]),D.bind("focus.jsp",function(){c.focus()}),c.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(t){if(t.target===this||s.length&&lt(t.target).closest(s).length){var e=q,i=B;switch(t.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:o=t.keyCode,n();break;case 35:C(E-P),o=null;break;case 36:C(0),o=null}return!(a=t.keyCode==o&&e!=q||i!=B)}}).bind("keypress.jsp",function(t){return t.keyCode==o&&n(),t.target===this||s.length&&lt(t.target).closest(s).length?!a:void 0}),M.hideFocus?(c.css("outline","none"),"hideFocus"in A[0]&&c.attr("hideFocus",!0)):(c.css("outline",""),"hideFocus"in A[0]&&c.attr("hideFocus",!1))}(),M.clickOnTrack&&(m(),U&&H.bind("mousedown.jsp",function(o){if(void 0===o.originalTarget||o.originalTarget==o.currentTarget){var a,s=lt(this),t=s.offset(),r=o.pageY-t.top-B,l=!0,c=function(){var t=s.offset(),e=o.pageY-t.top-V/2,i=P*M.scrollPagePercent,n=R*i/(E-P);if(r<0)e<B-n?st.scrollByY(-i):v(e);else{if(!(0<r))return void d();B+n<e?st.scrollByY(i):v(e)}a=setTimeout(c,l?M.initialDelay:M.trackClickRepeatFreq),l=!1},d=function(){a&&clearTimeout(a),a=null,lt(document).unbind("mouseup.jsp",d)};return c(),lt(document).bind("mouseup.jsp",d),!1}}),F&&Q.bind("mousedown.jsp",function(o){if(void 0===o.originalTarget||o.originalTarget==o.currentTarget){var a,s=lt(this),t=s.offset(),r=o.pageX-t.left-q,l=!0,c=function(){var t=s.offset(),e=o.pageX-t.left-X/2,i=T*M.scrollPagePercent,n=N*i/(I-T);if(r<0)e<q-n?st.scrollByX(-i):y(e);else{if(!(0<r))return void d();q+n<e?st.scrollByX(i):y(e)}a=setTimeout(c,l?M.initialDelay:M.trackClickRepeatFreq),l=!1},d=function(){a&&clearTimeout(a),a=null,lt(document).unbind("mouseup.jsp",d)};return c(),lt(document).bind("mouseup.jsp",d),!1}})),function(){if(location.hash&&1<location.hash.length){var t,e,i=escape(location.hash.substr(1));try{t=lt("#"+i+', a[name="'+i+'"]')}catch(t){return}t.length&&D.find(i)&&(0===A.scrollTop()?e=setInterval(function(){0<A.scrollTop()&&(S(t,!0),lt(document).scrollTop(A.position().top),clearInterval(e))},50):(S(t,!0),lt(document).scrollTop(A.position().top)))}}(),M.hijackInternalLinks&&(lt(document.body).data("jspHijack")||(lt(document.body).data("jspHijack",!0),lt(document.body).delegate('a[href*="#"]',"click",function(t){var e,i,n,o,a,s=this.href.substr(0,this.href.indexOf("#")),r=location.href;if(-1!==location.href.indexOf("#")&&(r=location.href.substr(0,location.href.indexOf("#"))),s===r){e=escape(this.href.substr(this.href.indexOf("#")+1));try{i=lt("#"+e+', a[name="'+e+'"]')}catch(t){return}i.length&&((n=i.closest(".jspScrollable")).data("jsp").scrollToElement(i,!0),n[0].scrollIntoView&&(o=lt(window).scrollTop(),((a=i.offset().top)<o||a>o+lt(window).height())&&n[0].scrollIntoView()),t.preventDefault())}})))):(c.removeClass("jspScrollable"),D.css({top:0,left:0,width:A.width()-ot}),A.unbind(rt),D.find(":input,a").unbind("focus.jsp"),c.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),D.unbind(".jsp"),m()),M.autoReinitialise&&!it?it=setInterval(function(){d(M)},M.autoReinitialiseDelay):!M.autoReinitialise&&it&&clearInterval(it),a&&c.scrollTop(0)&&C(a,!1),s&&c.scrollLeft(0)&&w(s,!1),c.trigger("jsp-initialised",[F||U])}function u(){H.height(W+"px"),B=0,e=M.verticalGutter+H.outerWidth(),D.width(T-e-ot);try{0===Z.position().left&&D.css("margin-left",e+"px")}catch(t){}}function h(){A.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){K-=lt(this).outerWidth()}),Q.width(K+"px"),q=0}function p(t,e,i,n){var o,a="before",s="after";"os"==e&&(e=/Mac/.test(navigator.platform)?"after":"split"),e==a?s=e:e==s&&(a=e,o=i,i=n,n=o),t[a](i)[s](n)}function f(t,e,i){return function(){return function(t,e,i,n){i=lt(i).addClass("jspActive");var o,a,s=!0,r=function(){0!==t&&st.scrollByX(t*M.arrowButtonSpeed),0!==e&&st.scrollByY(e*M.arrowButtonSpeed),a=setTimeout(r,s?M.initialDelay:M.arrowRepeatFreq),s=!1};r(),o=n?"mouseout.jsp":"mouseup.jsp",(n=n||lt("html")).bind(o,function(){i.removeClass("jspActive"),a&&clearTimeout(a),a=null,n.unbind(o)})}(t,e,this,i),this.blur(),!1}}function m(){Q&&Q.unbind("mousedown.jsp"),H&&H.unbind("mousedown.jsp")}function g(){lt("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),O&&O.removeClass("jspActive"),z&&z.removeClass("jspActive")}function v(t,e){if(U){t<0?t=0:R<t&&(t=R);var i=new lt.Event("jsp-will-scroll-y");if(c.trigger(i,[t]),!i.isDefaultPrevented()){var n=t||0,o=0===n,a=n==R,s=-(t/R)*(E-P);void 0===e&&(e=M.animateScroll),e?st.animate(O,"top",t,_,function(){c.trigger("jsp-user-scroll-y",[-s,o,a])}):(O.css("top",t),_(t),c.trigger("jsp-user-scroll-y",[-s,o,a]))}}}function _(t){void 0===t&&(t=O.position().top),A.scrollTop(0);var e=0===(B=t||0),i=B==R,n=-(t/R)*(E-P);o==e&&s==i||(o=e,s=i,c.trigger("jsp-arrow-change",[o,s,a,r])),function(t,e){M.showArrows&&(G[t?"addClass":"removeClass"]("jspDisabled"),J[e?"addClass":"removeClass"]("jspDisabled"))}(e,i),D.css("top",n),c.trigger("jsp-scroll-y",[-n,e,i]).trigger("scroll")}function y(t,e){if(F){t<0?t=0:N<t&&(t=N);var i=new lt.Event("jsp-will-scroll-x");if(c.trigger(i,[t]),!i.isDefaultPrevented()){var n=t||0,o=0===n,a=n==N,s=-(t/N)*(I-T);void 0===e&&(e=M.animateScroll),e?st.animate(z,"left",t,b,function(){c.trigger("jsp-user-scroll-x",[-s,o,a])}):(z.css("left",t),b(t),c.trigger("jsp-user-scroll-x",[-s,o,a]))}}}function b(t){void 0===t&&(t=z.position().left),A.scrollTop(0);var e=0===(q=t||0),i=q==N,n=-(t/N)*(I-T);a==e&&r==i||(a=e,r=i,c.trigger("jsp-arrow-change",[o,s,a,r])),function(t,e){M.showArrows&&(tt[t?"addClass":"removeClass"]("jspDisabled"),et[e?"addClass":"removeClass"]("jspDisabled"))}(e,i),D.css("left",n),c.trigger("jsp-scroll-x",[-n,e,i]).trigger("scroll")}function C(t,e){v(t/(E-P)*R,e)}function w(t,e){y(t/(I-T)*N,e)}function S(t,e,i){var n,o,a,s,r,l,c,d,u,h=0,p=0;try{n=lt(t)}catch(t){return}for(o=n.outerHeight(),a=n.outerWidth(),A.scrollTop(0),A.scrollLeft(0);!n.is(".jspPane");)if(h+=n.position().top,p+=n.position().left,n=n.offsetParent(),/^body|html$/i.test(n[0].nodeName))return;l=(s=x())+P,h<s||e?d=h-M.horizontalGutter:l<h+o&&(d=h-P+o+M.horizontalGutter),isNaN(d)||C(d,i),c=(r=k())+T,p<r||e?u=p-M.horizontalGutter:c<p+a&&(u=p-T+a+M.horizontalGutter),isNaN(u)||w(u,i)}function k(){return-D.position().left}function x(){return-D.position().top}function L(){return!1}var M,D,T,P,A,I,E,j,$,U,F,O,R,B,z,N,q,Z,H,e,W,V,G,J,Y,Q,K,X,tt,et,it,nt,ot,at,st=this,o=!0,a=!0,s=!1,r=!1,i=c.clone(!1,!1).empty(),rt=lt.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";ot="border-box"===c.css("box-sizing")?nt=0:(nt=c.css("paddingTop")+" "+c.css("paddingRight")+" "+c.css("paddingBottom")+" "+c.css("paddingLeft"),(parseInt(c.css("paddingLeft"),10)||0)+(parseInt(c.css("paddingRight"),10)||0)),lt.extend(st,{reinitialise:function(t){d(t=lt.extend({},M,t))},scrollToElement:function(t,e,i){S(t,e,i)},scrollTo:function(t,e,i){w(t,i),C(e,i)},scrollToX:function(t,e){w(t,e)},scrollToY:function(t,e){C(t,e)},scrollToPercentX:function(t,e){w(t*(I-T),e)},scrollToPercentY:function(t,e){C(t*(E-P),e)},scrollBy:function(t,e,i){st.scrollByX(t,i),st.scrollByY(e,i)},scrollByX:function(t,e){y((k()+Math[t<0?"floor":"ceil"](t))/(I-T)*N,e)},scrollByY:function(t,e){v((x()+Math[t<0?"floor":"ceil"](t))/(E-P)*R,e)},positionDragX:function(t,e){y(t,e)},positionDragY:function(t,e){v(t,e)},animate:function(t,e,i,n,o){var a={};a[e]=i,t.animate(a,{duration:M.animateDuration,easing:M.animateEase,queue:!1,step:n,complete:o})},getContentPositionX:function(){return k()},getContentPositionY:function(){return x()},getContentWidth:function(){return I},getContentHeight:function(){return E},getPercentScrolledX:function(){return k()/(I-T)},getPercentScrolledY:function(){return x()/(E-P)},getIsScrollableH:function(){return F},getIsScrollableV:function(){return U},getContentPane:function(){return D},scrollToBottom:function(t){v(R,t)},hijackInternalLinks:lt.noop,destroy:function(){!function(){var t=x(),e=k();c.removeClass("jspScrollable").unbind(".jsp"),D.unbind(".jsp"),c.replaceWith(i.append(D.children())),i.scrollTop(t),i.scrollLeft(e),it&&clearInterval(it)}()}}),d(t)}return i=lt.extend({},lt.fn.jScrollPane.defaults,i),lt.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){i[this]=i[this]||i.speed}),this.each(function(){var t=lt(this),e=t.data("jsp");e?e.reinitialise(i):(lt("script",t).filter('[type="text/javascript"],:not([type])').remove(),e=new n(t,i),t.data("jsp",e))})},lt.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(h){var p,f,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],m=Array.prototype.slice;if(h.event.fixHooks)for(var i=t.length;i;)h.event.fixHooks[t[--i]]=h.event.mouseHooks;var g=h.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=e.length;t;)this.addEventListener(e[--t],n,!1);else this.onmousewheel=n;h.data(this,"mousewheel-line-height",g.getLineHeight(this)),h.data(this,"mousewheel-page-height",g.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=e.length;t;)this.removeEventListener(e[--t],n,!1);else this.onmousewheel=null;h.removeData(this,"mousewheel-line-height"),h.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var e=h(t),i=e["offsetParent"in h.fn?"offsetParent":"parent"]();return i.length||(i=h("body")),parseInt(i.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(t){return h(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function n(t){var e,i=t||window.event,n=m.call(arguments,1),o=0,a=0,s=0,r=0,l=0;if((t=h.event.fix(i)).type="mousewheel","detail"in i&&(s=-1*i.detail),"wheelDelta"in i&&(s=i.wheelDelta),"wheelDeltaY"in i&&(s=i.wheelDeltaY),"wheelDeltaX"in i&&(a=-1*i.wheelDeltaX),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(a=-1*s,s=0),o=0===s?a:s,"deltaY"in i&&(o=s=-1*i.deltaY),"deltaX"in i&&(a=i.deltaX,0===s&&(o=-1*a)),0!==s||0!==a){if(1===i.deltaMode){var c=h.data(this,"mousewheel-line-height");o*=c,s*=c,a*=c}else if(2===i.deltaMode){var d=h.data(this,"mousewheel-page-height");o*=d,s*=d,a*=d}if(e=Math.max(Math.abs(s),Math.abs(a)),(!f||e<f)&&_(i,f=e)&&(f/=40),_(i,e)&&(o/=40,a/=40,s/=40),o=Math[1<=o?"floor":"ceil"](o/f),a=Math[1<=a?"floor":"ceil"](a/f),s=Math[1<=s?"floor":"ceil"](s/f),g.settings.normalizeOffset&&this.getBoundingClientRect){var u=this.getBoundingClientRect();r=t.clientX-u.left,l=t.clientY-u.top}return t.deltaX=a,t.deltaY=s,t.deltaFactor=f,t.offsetX=r,t.offsetY=l,t.deltaMode=0,n.unshift(t,o,a,s),p&&clearTimeout(p),p=setTimeout(v,200),(h.event.dispatch||h.event.handle).apply(this,n)}}function v(){f=null}function _(t,e){return g.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}h.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})});var SCM=SCM||{};SCM.ClientStatsMaster=function(r){function l(t,e,i,n,o,a){this.SourceType=t,this.ActionType=e,this.ActionDescription=i,this.ActionUrl=n,this.SearchData=o,this.IsTurnaway=a}function o(t,e){this.ActionFilterKey=t,this.ActionFilterValue=e}function a(t,e,i){this.SessionID=t,this.ClientID=e,this.SiteID=i}function s(t,e,i,n){this.UserSessionItem=new a("",0,r("#hdnSiteID").val()),this.ActionFilterType=new o(t,e),this.ActionDescription=i,this.ActionURL=n}function n(t,e,i,n,o,a){var s=new l(t,e,i,n,o,a).toJson();r.ajax({type:"POST",url:"/Services/UserActionService.svc/TrackUserAction",data:s,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,processData:!0}).fail(function(t,e){window.console&&(console.log("jqXhr.responseText: "+t.responseText),console.log("status: "+e))})}return l.prototype.toJson=function(){return JSON.stringify(this)},s.prototype.toJson=function(){return JSON.stringify(this)},{trackContentTabEvents:function(){var t=r("#Toolbar"),e={"#FigureTab":"FiguresClicked","#TableTab":"TablesClicked","#ContentTab":"ArticleClicked","#SupplementTab":"SupplementClicked","#MultimediaTab":"MultimediaClicked"};t.on("click",".tab-trigger",function(){var t=r(this).attr("data-tab");t in e&&n(22,"View",e[t],window.location.href,"",!1)})},trackShares:function(){var t=r("#ShareDrop"),e={addthis_button_email:"EmailClicked",addthis_button_share:"TwitterClicked",addthis_button_facebook:"FacebookClicked"};t.on("click","a",function(){var t=r(this).attr("class");t in e&&n(22,"Share",e[t],window.location.href,"",!1)})},trackSingleAction:function(t,e,i){t.on("click",function(){n(22,e,i,window.location.href,"",!1)})},trackGdprCookieAcceptance:function(t,e,i){!function(t,e,i,n){var o=new s(t,e,i,n).toJson();r.ajax({type:"POST",url:"/ClientTrackingHandler.ashx",data:o,contentType:"application/json; charset=utf-8",async:!0,processData:!0}).fail(function(t,e){window.console&&(console.log("jqXhr.responseText: "+t.responseText),console.log("status: "+e))})}(t,e,i,window.location.href)}}}(jQuery),$(window).on("load",function(){SCM.ClientStatsMaster.trackContentTabEvents(),SCM.ClientStatsMaster.trackShares(),SCM.ClientStatsMaster.trackSingleAction($('a[data-reveal-id="getCitation"]'),"Tools","GetCitationClicked"),SCM.ClientStatsMaster.trackSingleAction($("div.toolboxGetAlertsWidget"),"Tools","AlertsClicked"),SCM.ClientStatsMaster.trackSingleAction($("div#getAlertsConfirmation"),"Tools","AlertAdded"),SCM.ClientStatsMaster.trackSingleAction($("#PermissionsLink"),"Tools","GetPermissionsClicked"),SCM.ClientStatsMaster.trackSingleAction($("a.tablelink").filter(":parent"),"ViewLargeImage","ViewLargeImageClicked")});var SCM=SCM||{};SCM.JumpLinks=function(o){var n,i=500;return{init:function(){if(!(n=o(".jumplink-list, .jumplink-list-flyout, .list-issue-jumplinks")).length)return;o("body").on("click",'a[href*="#"]:not([href="#"])',function(t){if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname){t.preventDefault();var e=o(this).data("scrollto");e=a(e);var i=o("[data-legacyid="+e+"]");if(i.length)s(i);else{var n=this.hash;n=a(n),s(o(n))}}else o(this).hasClass("SupplementaryDataLink")&&(t.preventDefault(),window.location=o(this).attr("href"))}),o(".pg_ChapterStandard").length&&o(window).on("scroll",function(){var n=o(this).scrollTop();o(".book-chapter-body").length&&o("h2").each(function(){var t=o(this).offset().top,e=o(this).data("magellan-destination"),i=o('.section-jump-link a[href="#'+e+'"]');t-150<n&&o(i).length&&(o(".section-jump-link.active").removeClass("active"),o(i).closest(".section-jump-link").addClass("active"))})}),(o(".pg_Article").length||o(".pg_Issue").length||o(".pg_ConferenceVolume").length||o(".pg_proceeding").length)&&o(window).on("scroll",debounce(t,100)),o(document).on("click","a.js-sec-jumplink",function(t){if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname){var e=o(this).data("scrollto");0<e.indexOf(" ")&&(e=e.split(" ")[0]),e=a(e),s(o("[data-legacyid="+e+"]"))}}),o(".pg_Article").length&&o(".jumplink-list-flyout").length&&(o(".js-jumplink-flyout-trigger").on("click",function(t){t.stopPropagation(),o(".jumplink-list-flyout-container").toggleClass("active")}),o(document.body).on("click",function(){o(".jumplink-list-flyout-container").removeClass("active")})),[{titleElementSelector:".authorNotes-section-title",wrapperClass:"author-notes-jumplink",targetId:"authorNotesSectionTitle"},{titleElementSelector:".footNotes-section-title",wrapperClass:"foot-notes-jumplink",targetId:"footNotesSectionTitle"},{titleElementSelector:".coiStatement-section-title",wrapperClass:"coi-statement-jumplink",targetId:"coiStatementSectionTitle"},{titleElementSelector:".supplementary-data-section-title",wrapperClass:"datasupplements-section-jumplink",targetId:"supplementary-data"},{titleElementSelector:".js-comments-title",wrapperClass:"usercomments-section-jumplink",targetId:"usercomments",linkHtmlSelector:".js-comments-jumplink"}].forEach(function(t){var e=o(t.titleElementSelector).first().text().trim(),i=o(t.linkHtmlSelector).first().length?o(t.linkHtmlSelector).first().html():void 0;e&&function(t){var e=t.linkHtml?t.linkHtml:'<a class="jumplink scrollTo" href = "#'+t.targetId+'">'+t.title+"</a>",i='<li class="section-jump-link head-1 '+t.wrapperClass+'"><div class="section-jump-link__link-wrap">'+e+"</div></li> ";n.append(i)}({title:e,targetId:t.targetId,wrapperClass:t.wrapperClass,linkHtml:i})}),function(){var i=n.find("li").has(".jumplink");if(!i.length)return;var t=o("#ContentTab [scrollto-destination]");if(!t.length)return;var e=t.map(function(t,e){return i.has('[href="#'+e.getAttribute("scrollto-destination")+'"]').first().get()});n.children().detach(),n.empty().append(e)}(),function(){if(!n.find("li").length){var t=n.parents(".widget-ArticleJumpLinks");t.length&&!t.find(".js-jumplink").length&&t.hide()}}(),function(){var e=o(".tab-split-view-comments-pane");e.length&&o(".js-comments-jumplink .js-jumplink").on("click",function(t){t.preventDefault(),e.hasClass("active")||e.click()})}()}};function a(t){return t=t&&t.replace(/[.]/g,"\\.")}function s(t){t.length&&(o(".pg_articlesplitview").length?function(t){var e=o(".js-content-splitview");e.length?e.animate({scrollTop:t.offset().top+e.scrollTop()-e.offsetParent().offset().top},i):o("html,body").animate({scrollTop:t.offset().top},i)}(t):function(t){o(".toolbar-wrap").length?o(".toolbar-stuck").length?o("html,body").animate({scrollTop:t.offset().top-65},i):o("html,body").animate({scrollTop:t.offset().top-130},i):o("html,body").animate({scrollTop:t.offset().top-65},i)}(t))}function t(){var n=o(this).scrollTop();o(".articleClientType").each(function(){var t=o(this).offset().top,e=o(this).attr("id"),i=o('.section-jump-link__link-wrap a[href="#'+e+'"]');t-80<n&&(o(i).length&&o(".list-issue-jumplinks li").removeClass("active"),o(i).closest(".section-jump-link").addClass("active"))}),o(".article-body").length&&o("h2").each(function(){var t=o(this).offset().top,e=o(this).attr("id"),i=o('.section-jump-link__link-wrap a[href="#'+e+'"]');t-80<n&&(o(i).length&&o(".jumplink-list li, .jumplink-list-flyout li").removeClass("active"),o(i).closest(".section-jump-link").addClass("active"),o(".active-section").length&&o(".active-section").text(o(".section-jump-link.active a").text()))})}}(jQuery);var SCM=SCM||{};SCM.StickyElements=SCM.StickyElements||{},SCM.StickyElements=function(t){var e,i,n,o,a,s,r,l="",c=window.scrollY||window.pageYOffset,d=!1;return{init:function(){e=t("body"),o=t(".page-column--left"),a=t(".toolbar-wrap"),s=t(".page-column--left, .toolbar-wrap, .sr-filters, .article-browse-mobile-nav"),r=t("section.master-header").height(),e.hasClass("pg_article")&&(l="article",i=t(".article-browse-mobile-nav"));e.hasClass("pg_issue")&&(l="issue",n=t(".issue-browse-mobile-nav"));e.hasClass("pg_solr/searchresults")&&(l="search",$srFilters=t(".sr-filters"));window.addEventListener("scroll",u,!1),h()}};function u(){c=window.scrollY||window.pageYOffset,d||(requestAnimationFrame(h),d=!0)}function h(){d=!1,1023<SCM.SiteJS.getViewportWidth()&&"article"===l&&r-25<=c&&a.addClass("fixed"),r-25<=c?("article"===l&&(o.addClass("fixed"),i.addClass("fixed")),"search"===l&&SCM.SiteJS.getViewportWidth()<=1023&&$srFilters.addClass("fixed")):"article"!==l&&"search"!==l||s.removeClass("fixed"),r+175<=c&&"issue"===l?o.addClass("fixed"):"issue"===l&&o.removeClass("fixed"),r+190<=c&&"issue"===l?n.addClass("fixed"):"issue"===l&&n.removeClass("fixed")}}(jQuery);var SCM=SCM||{};!function(t,r){t.setAccessIcons=function(s){s=s||SCM.AccessIcons;var t=r("[data-resource-id-access]");t.length&&s&&t.each(function(t,e){var i=r(this),n=i.data("resourceIdAccess"),o=SCM.SiteJS.getAccessIcon(n,s);if(o){var a=i.find(".js-access-icon-placeholder");a.removeClass(o.icon).addClass(o.icon),a.attr("title",o.title)}})},t.getAccessIcon=function(i,t){var n;return(t=t||SCM.AccessIcons).map(function(t,e){if(t.id===i)return n=t,!1}),n}}(SCM.SiteJS=SCM.SiteJS||{},jQuery);var SCM=SCM||{};!function(c,u,a){c.checkForJS=function(){u("html").removeClass("no-js")},c.detectIfIE=function(){var t,e,i=(t=window.navigator.userAgent,0<(e=t.indexOf("MSIE"))?parseInt(t.substring(e+5,t.indexOf(".",e))):navigator.userAgent.match(/trident/gi)?11:navigator.userAgent.match(/edge/gi)?13:0);if(0<i&&i<13)u("html").addClass("IE IE-"+i);else{if(!(12<i))return;u("html").addClass("IE IE-Edge")}},c.detectIfFirefox=function(){null==window.mozInnerScreenX||u("html").addClass("firefox")};var t=u("body"),n=(u(".article-browse-mobile-nav"),u(".article-browse-mobile-nav-inner"),u(".search-wrap-filters")),e=!1,o=!1,s=!1,r=(u("#noAccessReveal"),u(".toolbar-wrap"),u(".toolbar-inner-wrap"),"Basic");u("#hfViewOption").val(),c.skipToMainContent=function(){u(".skipnav").on("click",function(){u("#skipNav").focus()})},c.globalNavDropdown=function(){u(".js-dropdown-trigger").on("click",function(t){u("body").addClass("on-canvas");var e=u(this).next(".js-dropdown");t.stopPropagation(),u("div, nav").not(e).removeClass("expanded"),e.toggleClass("expanded"),u(document.body).on("click",function(t){u(".js-dropdown").removeClass("expanded"),u("body").removeClass("on-canvas")})})},c.tabletMenuDropdown=function(){u(".js-tablet-menu-toggle").on("click",function(t){u(this);var e=u(this).closest(".tablet-menu-trigger_wrap").next(".tablet-menu");t.stopPropagation(),e.slideToggle("fast",function(){u(this).is(":visible")&&u(this).css("display","flex")})})},c.mobileSiteMenuDropdown=function(){u(".js-mobile-site-menu-toggle").on("click",function(t){var e=u(this).next(".navbar-menu");t.stopPropagation(),e.slideToggle("fast",function(){u(this).is(":visible")&&u(this).css("display","block")})})},c.closeModals=function(){u(document).on("click",".close-reveal-modal",function(){u(".reveal-modal").removeClass("open"),u("body").removeClass("on-canvas")}),u("body").on("click",function(t){u(t.target).is(".mobile-mask")&&(u(".reveal-modal").removeClass("open"),u("body").removeClass("on-canvas"))})},c.setAllLinksTarget=function(){u('a:not([target="_blank"])').each(function(){(function(t){return t&&(t.startsWith("http")||t.startsWith("/"))&&!t.startsWith("#")})(this.href)&&function(t){if(t.startsWith("/"))return!1;return!new RegExp("/"+window.location.host+"/").test(t)}(this.href)&&(this.target="_blank")})},c.getNewSelectedFilter=function(){var e=n.children("li");e.on("click",function(){var t=u(this);e.removeClass("selected"),t.addClass("selected"),SCM.SiteJS.setSelectedSearchFilter()})},c.initSelfServeNavigation=function(){var t=u('.widget-SelfServeContentNavigationMenu a[href="'+window.location.pathname+'"]');t.addClass("ss-currentPage"),t.parents("ul.selfserve-nav-menu-child-list").addClass("open"),t.parents("ul.selfserve-nav-menu-child-list").siblings("button.selfserve-subnav-toggle").removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down")},c.toggleSelfServeNavigation=function(){u(".selfserve-subnav-toggle, .selfserve-parent-toggle").on("click",function(t){var e=u(this),i=u(this).siblings(".selfserve-sublist");t.preventDefault(),e.hasClass("icon-general-arrow-filled-right")?e.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down"):e.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right"),i.hasClass("open")?i.removeClass("open"):i.addClass("open")})},c.getViewportWidth=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},c.initLazyLoad=function(){SCM.Utilities.LazyLoad.init("contentFigures"),SCM.Utilities.LazyLoad.init("inlineGraphics"),SCM.Utilities.LazyLoad.init("lazy")},c.loadAllImagesIfUserIsAboutToUseJumpLinks=function(){u("#LeftNavSticker").hover(function(){u(".lazy").each(function(){var t=u(this);t.attr("src",t.attr("data-original"))})})},c.showAuthorInfo=function(){u(".js-linked-name").on("click",function(t){var e=u(this).siblings(".al-author-info-wrap");t.stopPropagation(),u(".al-author-info-wrap").not(e).removeClass("open"),u(e).toggleClass("open")})},c.hideAuthorInfo=function(){u(document.body).on("click",function(t){u(t.target).parents(".al-author-info-wrap").length||u(".al-author-info-wrap").removeClass("open")})},c.showArticleHistory=function(){u(".js-history-dropdown-trigger").on("click",function(t){var e=u(this).next(".history-dropdown");t.stopPropagation(),u(e).toggleClass("expanded")})},c.hideArticleHistory=function(){u(document.body).on("click",function(t){u(t.target).parents(".ww-citation-history-wrap").length||u(".history-dropdown").removeClass("expanded")})},c.addAuthorFootnote=function(){u(".al-author-name").each(function(){var t=u(this).find(".info-card-note .xref-fn");t.length&&"*"===t.text()&&(u("<sup/>").append(t.html()).insertAfter(u(this).find(".linked-name")),t.remove());u(this).find(".info-author-correspondence").length&&u(this).find(".linked-name").append('<i class="icon-corresponding_author"></i>')})},c.showHideDropDown=function(){u(".selectDropdown").on("click",function(t){u(".dropdown").hide().removeClass("open"),t.stopPropagation(),u(this).siblings(".dropdown").slideToggle("300","linear").toggleClass("open")}),u(document).click(function(){u(".dropdown").hide().removeClass("open")})},c.showMoreRelatedContent=function(t,e){u(t).click(function(){var t=u(this);t.closest(".related-section-box, .widget-RelatedBookContent").find(e).toggleClass("show-item"),t.toggleClass("show-less").find("i").toggleClass("icon-show").toggleClass("icon-hide"),t.hasClass("show-less")?t.find("span").text("See Less"):t.find("span").text("See More")})},c.showRelatedBookWidgetIfHasContent=function(){u(".widget-RelatedBookContent").each(function(){var t=u(this);5<t.find("*").length&&t.addClass("show")})},c.showSpinner=function(){u(".pagination, .querybuilder-submit").on("click",function(){u(".preloader-wrap").removeClass("hide").addClass("active")})},c.setSelectedSearchFilter=function(){var t=n.children(".selected").text();u(".selected-text").text(t)},c.initFilterClickEvent=function(){u(".filter-wrap").on("click",function(t){n.hide(),t.stopPropagation(),n.toggle()}),u(document).click(function(){n.hide()})},c.isLoggedIn=function(){return 0<App.LoginUserInfo.isIndividualLoggedIn},c.toggleSearchCover=function(){u(".sf-facet").length&&u(".sf-facet").click(function(){u(document).ajaxStart(function(){u(".info-inner-cover").removeClass("uncovered"),u(".info-inner-cover").addClass("covered")}),u(document).ajaxComplete(function(){u(".info-inner-cover").removeClass("covered"),u(".info-inner-cover").addClass("uncovered")})})},c.calculateResetState=function(t){e=!!t,SCM.SiteJS.resetMobileSiteNav(e)},c.toggleMobileLanguageSubmenu=function(){u(".mobile-header-language").on("click",function(){u(".mobile-language-submenu").slideToggle()})},c.toggleMobileSiteMenuSubnav=function(){u("div.dropdown-menu ul.site-menu li.site-menu-item").on("click",function(){var t=u(this),e=t.children(".mobile-nav-arrow");t.children("ul.site-menu").slideToggle(),e.hasClass("icon-general_arrow-right")?e.removeClass("icon-general_arrow-right").addClass("icon-general_arrow-down"):e.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right")})},c.toggleMobileSignInForm=function(){var t=u(".mobile-login"),e=u(".mobile-signin-nav-arrow");u(".mobile-menu-link-wrap").on("click",function(){t.hasClass("open")||(t.addClass("open").slideToggle(),e.hide())}),u(".site-menu .mobile-login-form").on("click",".mobile-login-icon",function(){t.removeClass("open").slideToggle(),e.show()})},c.resetMobileSearchFilters=function(){u(".sf-facets, .sf-facet-list").removeAttr("style"),u(".sf-group-header-icon").removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right")},c.resetMobileSiteNav=function(t){u(".header-bottom, .navigation, #MicrositeSearch, .arrow-nav, .arrow-search, .mobile-language-submenu").removeAttr("style"),u(".mobile-search-toggle, .mobile-menu-toggle, .arrow-nav, .arrow-search").removeClass("active"),u("#MicrositeSearch").removeClass("active-tablet"),t&&(s=o=!1)},c.mobileSearchDropdown=function(){u(".js-mobile-search_toggle").click(function(t){u(this);var e=u(this).closest(".mobile-menu-trigger_wrap").next(".js-mobile-search-dropdown");t.stopPropagation(),u("div, nav").not(e).removeClass("expanded"),e.toggleClass("expanded"),e.slideToggle("fast")})},c.toggleResponsiveLeftColumn=function(){u(document.body).removeClass("noscroll"),u("main").on("click",".toggle-left-col__search, .toggle-left-col__article",function(t){t.preventDefault(),u(document.body).addClass("noscroll"),u(".page-column--left").show(),u(document).ajaxComplete(function(){u(document.body).removeClass("noscroll")})}),u(".toggle-left-col__issue").on("click",function(t){t.preventDefault(),u(document.body).addClass("noscroll"),u(".issue-dropdown-wrap").hide(),u(".responsive-issue-nav").show()}),u(".toggle-left-col__close").on("click",function(t){t.preventDefault(),u(document.body).removeClass("noscroll"),u(".page-column--left, .responsive-issue-nav, .issue-dropdown-wrap").removeAttr("style")})},c.toggleMobileMenu=function(){u(".mobile-menu-toggle").on("click",function(){SCM.SiteJS.calculateResetState(s,o),o=!1===o,SCM.SiteJS.toggleResponsiveMenus(u(".mobile-menu-toggle, .arrow-nav"),o,u(".navigation"))})},c.toggleResponsiveMenus=function(t,e,i){var n=u(".header-bottom");e?(t.addClass("active"),i.show(),n.slideToggle()):(t.removeClass("active"),n.toggle(),i.delay(50).hide())},c.togglePubHistory=function(){var t=u(".ww-history");u(".ww-citation-history-wrap").on("click",function(){t.slideToggle()}),u(".ww-history-close").on("click",function(){t.slideToggle()})},c.initDatePicker=function(){u(".pg_AdvancedSearch, .pg_advancedsearch").length&&u("#startDateAuthor").length&&u("#startDateAuthor, #endDateAuthor, #startDateSemanticSearch, #endDateSemanticSearch").datepicker()},c.showFullAuthorList=function(){var e=u(".meta-authors--etal"),i=u(".meta-authors--remaining");e.on("click",function(t){t.preventDefault(),e.removeClass("is-active"),e.attr("aria-hidden",!0),i.addClass("is-active"),i.attr("aria-hidden",!1)})},c.showImages=function(t){t.find(".contentFigures").each(function(){var t=u(this);0<=t.attr("src").toLowerCase().indexOf("grey.gif")&&t.attr("src",t.attr("data-original"))})},c.openRevealModal=function(t){var e=u("#revealModal");e.find("#revealContent").empty().prepend(t.children().clone()),e.closest(".reveal-modal").addClass("open"),u(document.body).addClass("on-canvas"),SCM.SiteJS.showImages(e),SCM.SiteJS.restrictedImages()},c.revealFigsTablesInModal=function(){var l=u("#NeedSubscription");t.on("click",".xref-bibr, .xref-fn, .link-reveal, .table-graphic, .caption-title",function(){var t=u(this),e=t.attr("reveal-id")?t.attr("reveal-id"):t.attr("data-id"),i=u('[content-id="'+e+'"]').first();if(i=i.length?i:u('[content-id="'+e.toLowerCase()+'"]').first(),e.length&&!i.length){var n=e.split(" ");if(3===n.length){var o=u("<div/>"),a=n[0],s=n[2],r=u('[content-id="'+a+'"]').first();(r=r.length?r:u('[content-id="'+a.toLowerCase()+'"]').first()).length&&(o.append(r.children().clone()),o=c.getAllReferencesInRange(r,o,s)),i=0<o.html().length?o:""}}u(i).hasClass("video-modal")||u(i).hasClass("audio-modal")?SCM.Utilities.Reveal.open(i):i.length?SCM.SiteJS.openRevealModal(i):SCM.Utilities.Reveal.open(l)})},c.getAllReferencesInRange=function(t,e,i){var n=t.next(),o=n.attr("content-id");o.length&&(e.append(n.children().clone()),o===i||o===i.toLowerCase()||c.getAllReferencesInRange(n,e,i));return e},c.showUnAuthenticatedSpans=function(){u(document).ready(function(){var t=u('div[data-widgetname="ArticleFulltext"] span#UserHasAccess').attr("data-userHasAccess");t&&t.length&&"false"===t.toLowerCase()&&u('div[data-widgetname="ArticleFulltext"] a[data-reveal-id]').each(function(){u(this).replaceWith(function(){return"<span>"+this.innerHTML+"</span>"})})})},c.siteThemeHeaderDropdowns=function(){u(".mobile-search-toggle").on("click",function(t){t.preventDefault();var e=u(this);SCM.SiteJS.manageMobileDropdowns(e,".mobile-search-dropdown")}),u(".mobile-account-toggle").on("click",function(t){t.preventDefault();var e=u(this);SCM.SiteJS.manageMobileDropdowns(e,".mobile-account-dropdown")}),u(".mobile-nav-toggle").on("click",function(t){t.preventDefault();var e=u(this);SCM.SiteJS.manageMobileDropdowns(e,".mobile-nav-dropdown")})},c.manageMobileDropdowns=function(t,e){u(".dropdown-panel").hasClass("is-active")?t.hasClass("is-active")?(u(e).slideToggle().removeClass("is-active"),t.removeClass("is-active")):(u(".mobile-dropdown-toggle").removeClass("is-active"),u(".dropdown-panel-wrap").children(".is-active").slideToggle().removeClass("is-active"),t.addClass("is-active"),u(e).delay(400).slideToggle().addClass("is-active")):(t.addClass("is-active"),u(e).slideToggle().addClass("is-active"))};var l=!(c.toggleMobileDropdownSubnav=function(){u(".dummy-link, .mobile-nav-dropdown .site-menu-item .mobile-nav-arrow, .mobile-account-dropdown .site-menu-item .mobile-nav-arrow").on("click",function(t){t.preventDefault();var e=u(this),i=e;i=e.hasClass("mobile-nav-arrow")?e:e.siblings(".mobile-nav-arrow"),e.siblings(".site-menu-lvl-1").slideToggle(),i.hasClass("icon-general_arrow-down")?i.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-up"):i.removeClass("icon-general_arrow-up").addClass("icon-general_arrow-down")})});c.loadSignInForm=function(){var e=u(".mobile-account-dropdown ul li ul"),i=u(".dropdown-panel-signin"),t=(u("#sign-in-page"),SCM.SiteJS.getDefaultReturnUrl());if(l)c.setAutoLoginCookieUponSSOLinkClick();else{var n=(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/SignIn/LoginForm/LoginFormPopup?returnUrl="+encodeURIComponent(t);u.ajax({url:n,cache:!1,success:function(t){i.html(t),e.html(t),SCM.AddReturnUrlToSocietyLinks(),l=!0,c.setAutoLoginCookieUponSSOLinkClick()}})}},c.initSigninForm=function(){var e=u(".mobile-account-dropdown ul li .mobile-account-signin"),i=u(".mobile-account-dropdown ul li i.mobile-nav-arrow"),n=(u(".mobile-account-dropdown ul li ul"),u(".dropdown-panel-signin")),o=u(".dropdown-panel-institution");u(".site-theme-header-menu-item .dropdown-toggle.signin").on("click",function(t){t.preventDefault(),n.hasClass("active")?u(".dropdown-panel-signin").hide().removeClass("active"):u(".dropdown-panel-signin").show().addClass("active"),c.loadSignInForm()}),u(".dropdown-toggle.institution").on("click",function(t){t.preventDefault(),o.hasClass("active")?o.hide().removeClass("active"):o.show().addClass("active")}),u(document).on("mouseup",function(t){var e=u(".dropdown-panel-signin, .dropdown-panel-institution");u(e).is(t.target)||0!==u(e).has(t.target).length||u(e).hide()}),e.on("click",function(t){t.preventDefault(),c.loadSignInForm(),i.hasClass("icon-general_arrow-down")?i.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-up"):i.removeClass("icon-general_arrow-up").addClass("icon-general_arrow-down"),e.hasClass("active")?e.removeClass("active"):e.addClass("active")}),u(document).on("click",".signin-form .signin-button",function(t){var e=u(this).closest(".signin-form"),i=e.find(".preloader-wrap");t.preventDefault(),t.stopPropagation(),SCM.SiteJS.Login(e,i)}),u(document).on("keypress",".signin-form input.username, .signin-form input.password",function(t){var e=u(this).closest(".signin-form"),i=e.find(".preloader-wrap");13===(t.keyCode||t.which)&&(t.preventDefault(),SCM.SiteJS.Login(e,i))}),u(document).on("click",".signout-button",function(t){t.preventDefault(),window.top.location.assign("/LogoutHandler.ashx")}),u(document).on("click","a.institutional-login-link",function(t){t.preventDefault();var e=u(this).attr("href"),i=e.toLowerCase();if(!(0<i.indexOf("returnurl=")||0<=window.top.location.href.toLowerCase().indexOf(i))){var n=u.deparam.querystring().returnUrl;null==n&&(n=window.top.location.href),null!=n&&0<n.length&&(e=u.param.querystring(e,"returnUrl="+encodeURIComponent(n)))}window.top.location.assign(e)}),u(document).on("click","a.shibboleth-signin",function(t){var e=window.top.location,i=e.origin+"/SHIBBOLETH?dest="+encodeURIComponent(e.pathname+e.search),n=u(this).data("target").replace("{0}",encodeURIComponent(i));window.top.location=n})},c.initLoginFormDropdown=function(){u(".signin-form").on("click",'a[data-target="register"]',function(t){t.preventDefault();var e=u.deparam.querystring().returnUrl;null==e&&(e=location.pathname+location.search),window.top.location.assign("/my-account/register?returnUrl="+encodeURIComponent(e))})},c.Login=function(e,i){var t=e.find("input.username").val(),n=e.find("input.password").val();if(0!==t.length&&0!==n.length){i.removeClass("hide");u.post("/LoginHandler.ashx",{user:t,pass:n},function(t){"1"==t?SCM.SiteJS.loginReturnBack():(e.find(".error").show(),i.addClass("hide"))})}else e.find(".error").show()},c.loginReturnBack=function(){var t=SCM.SiteJS.getDefaultReturnUrl();if(/^\/((\w+\/)?sign-in|my-account\/forgot-password|my-account\/reset-password|my-account\/register|institutional-login)/i.test(t)&&(t="/"),"/"!==t){var e=t.match(/\/\/([^/]+\.)?([^./]+\.[^./]+)/i);null!==e&&e[2].toLowerCase()!==window.top.location.hostname.match(/(.*\.)?([^.]+\.[^.]+)/i)[2].toLowerCase()&&(t="/")}window.top.location.assign(t)},c.setAutoLoginCookieUponSSOLinkClick=function(){u(".widget-ExternalLogin a").off("click").on("click",function(t){var e=u(this).attr("href");if(e&&e.length&&e.indexOf("elpId=")<0){var i=new Date;i.setTime(i.getTime()+36e5);var n="; expires="+i.toGMTString();document.cookie="ForceAutoLogin=AutoLogin=GeoScienceWorld"+n}})},c.getDefaultReturnUrl=function(){var t=u.deparam.querystring(!0).returnUrl;return null!=(t=t&&decodeURIComponent(t))&&0!==t.length||(t=u.deparam.querystring().redirectUrl),null!=t&&0!==t.length||(t=SCM.SiteJS.getCanonicalUrl()),null!=t&&0!==t.length||(t=window.top.location.pathname+window.top.location.search),t},c.getCanonicalUrl=function(){var t=u("link[rel='canonical']").attr("href");return null==t||0===t.length?"":t},c.contactUsSubmit=function(){u(".widget-contact-us #btnSubmit").on("click",function(){var o=u(".widget-contact-us"),t=o.find("#FirstName").val(),e=o.find("#LastName").val(),i=o.find("#EmailAddress").val(),n=o.find("#Subject").val(),a=o.find("#IsLibrarian").prop("checked"),s=o.find("#Reason").val(),r=o.find("#Journal").val(),l=o.find("#Comment").val(),c=o.find("#g-recaptcha-response").val(),d=JSON.stringify({FirstName:t,LastName:e,EmailAddress:i,Subject:n,IsLibrarian:a,Reason:s,Journal:r,Comment:l,CaptchaResponse:c});u.ajax({type:"POST",url:"/Common/ContactUsForm",data:d,success:function(t){if(t.Success){var e=o.find(".message-success"),i=u("<div/>");u.each(t.Messages,function(t,e){i.append(e)}),o.find(".widget-contact-us-form").hide(),e.html(i.html()).show()}else if(null!=t.Messages&&t.Messages.length){var n=u("<ul></ul>");u.each(t.Messages,function(t,e){n.append("<li>"+e+"</li>")}),o.find(".error-message").html(n).show()}},contentType:"application/json"})})},c.alertLinks=function(){function n(t){return t.parent().hasClass("alertType-MarketingLink")}function o(t){return t.data("additionalurl")}u(".userAlert a").each(function(){var i=u(this);i.off("click").on("click",function(t){if(t.preventDefault(),SCM.SiteJS.isLoggedIn(i))n(i)?function(t){window.location=o(t)}(i):SCM.SiteJS.showSignUpAlertInfo(i);else{var e=SCM.SiteJS.getDefaultReturnUrl();e=n(i)?o(i):function(t,e){var i=t.data("alerttype");void 0!==i&&(e=e+"#trigger-alerttype="+i);return e}(i,e),window.location="/sign-in?returnUrl="+encodeURIComponent(e)}})})},c.showSignUpAlertInfo=function(i){u.ajax({url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/Toolbox/AlertsSignUp/AlertsSignUpPopup",cache:!1,data:{alertType:i.data("alerttype"),resourceId:i.data("alertresourceid"),resourceType:i.data("alertresourcetype"),email:i.data("alertuseremail"),resourceName:i.data("alertresourcename")},dataType:"html",success:function(t){u(".userAlertSignUp").html(t);var e=u(".userAlertSignUpModal");SCM.Utilities.Reveal.open(e),u(".addUserAlert").on("click",function(){SCM.SiteJS.addSignUpAlert(i)}),u(".userAlertClose").on("click",function(){SCM.Utilities.Reveal.close(e)})}})},c.addSignUpAlert=function(t){u.ajax({url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/Toolbox/AddAlertsSignUp/AddAlertsSignUpPopup",cache:!1,data:{alertType:t.data("alerttype"),resourceId:t.data("alertresourceid"),resourceType:t.data("alertresourcetype"),email:t.data("alertuseremail"),resourceName:t.data("alertresourcename")},dataType:"html",success:function(t){u(".userAlertSignUp").html(t);var e=u(".userAlertSignUpModal");SCM.Utilities.Reveal.open(e),u(".userAlertClose").on("click",function(){SCM.Utilities.Reveal.close(e)})}})},c.triggerAlertModalOnRedirect=function(){var t=u.bbq.getState("trigger-alerttype");void 0!==t&&(u('.userAlert a[data-userloggedin="True"][data-alerttype='+t+"]").click(),u.bbq.removeState("trigger-alerttype"))},c.triggerSaveSearchModelOnRedirect=function(){"1"===u.bbq.getState("triggerSaveSearch")&&(u(".lnkSaveSolrSearch").click(),u.bbq.removeState("triggerSaveSearch"))},c.initPaginationListener=function(){u(".al-pageNumber,.sr-nav-previous,.sr-nav-next").on("click",function(){if(!u(this).hasClass("currentPage")){u(".preloader-wrap").removeClass("hide");var t=u(this).attr("data-url");SCM.SearchResults.doSolrSearch({queryString:t})}})},c.initSearchResultsSort=function(){var t=u(".sort-order-select-option"),e=u(".sort-order-select"),i=u(".preloader-wrap");e.on("change",function(){var t=u(this).val();SCM.SearchResults.doSolrSearch({queryString:t,source:"searchresults"})}),t.on("click",function(){u(this).find("option[value]").length&&i.removeClass("hide"),sessionStorage.detailsState=r}),c.initPaginationListener()},c.restrictedImages=function(){u("a.fig-link[restricted]").each(function(){var t=u(this).parent("div.graphic-wrap"),e=u(t).children(".copy-right-statement");t.attr("restricted",""),t.off("contextmenu").on("contextmenu",function(){return u(e).toggle(),!1}),u(this).click(function(){return u(e).toggle(),!1}),u(e).click(function(){return u(e).toggle(),!1})})},c.registerArticleListNewAndPopularCombinedMode=function(){u(".articleListNewAndPopular-mode").each(function(){var o=u(this);o.on("click",function(t){t.preventDefault(),u(".articleListNewAndPopular-mode").removeClass("active"),o.addClass("active");var e=o.data("mode"),i=u(".articleListNewAndPopular-ContentView-"+e),n=o.data("instancename");i.hasClass("hasContent")||(SCM.SiteJS.getArticleListNewAndPopularContent(e,i,n),i.addClass("hasContent")),u('section[class*="articleListNewAndPopular-ContentView-"]').hide(),i.removeClass("hide"),i.show()})})},c.getArticleListNewAndPopularContent=function(t,e,i){u.ajax({url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/PlatformArticle/ArticleListNewAndPopularContent/"+i,cache:!1,data:{mode:t},dataType:"html",success:function(t){e.html(t)}})},c.moveSubmitCommentLink=function(){var t=u(".submitCommentPlaceHolder"),e=u(".widget-UserComment");t.append(e)},c.addUserCommentJumpLink=function(){var t=u(".content-nav");if(t.length){var e=u(".comments-jumplink");t.append(e)}},c.toggleSearchResultsDetails=function(){var e=u("#switch-container"),i=u("#switch-post"),n=u(".sri-expandedView");"Expanded"===(r=sessionStorage.detailsState?sessionStorage.detailsState:"undefined"!=typeof clientViewOption&&""!==clientViewOption?clientViewOption:u("#hfViewOption").val())?(e.removeClass("off").addClass("on"),i.removeClass("off").addClass("on"),n.removeClass("hide")):"Basic"===r&&n.addClass("hide"),u(".pagination").on("click",function(){sessionStorage.detailsState=r}),e.off("click").on("click",function(t){t.stopPropagation(),r="Expanded"===r?"Basic":"Expanded",e.toggleClass("on off"),i.toggleClass("on off"),n.hasClass("hide")?n.removeClass("hide"):n.addClass("hide")})},c.adjustRelatedTagsDisplay=function(){u(".article-metadata-panel:not(:last)").remove();var t=u(".article-metadata-panel").last(),e=[u(".kwd-group"),u(".related-topic-tags"),u(".article-metadata-taxonomies"),u(".article-metadata-tocSections")];for(0===t.length&&(t=u(".article-metadata-standalone-panel")),i=0;i<e.length;i++)e[i].length&&t.append(e[i]);t.html()&&t.show()},c.showPdfOnlyLink=function(){u(".PdfOnlyLink").length&&u(".toolbar-item.item-pdf").length&&u(".toolbar-item.item-pdf").children().clone().appendTo(".PdfOnlyLink")},c.ariaToggleTable=function(e){var i=u(e+"-button"),n=i.children(".collapse-icon");i.on("click",function(t){t.preventDefault(),"true"===i.attr("aria-expanded")?i.attr("aria-expanded","false"):i.attr("aria-expanded","true"),n.hasClass("icon-general-arrow-filled-down")?n.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right"):n.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down"),u(e).toggleClass("hide"),"false"===u(e).attr("aria-hidden")?u(e).attr("aria-hidden","true"):u(e).attr("aria-hidden","false")})},c.initAriaControls=function(){u("[id^=collapsible-table-]").each(function(t){SCM.SiteJS.ariaToggleTable("#collapsible-table-"+t)})},c.abstractMathJax=function(){u(".abstract-response-placeholder").length&&MathJax.Hub.Queue(["Typeset",MathJax.Hub,".abstract-response-placeholder"])},c.initializeArticlePdfLinks=function(){var t=u("#ArticleList h5.item-title");function o(t){t.off("click")}null!=t&&t.each(function(t,e){var i=u(this),n=i.parent().find(".article-pdfLink");null!=n&&(function(t){var e=t.data("resourceIdAccess");if(null==a||null==e)return!1;var i=SCM.SiteJS.getAccessIcon(e,a);return null!=i&&"icon-availability_cart"!==i.icon}(i)||SCM.SiteJS.isLoggedIn()?function(t){o(t);var e=App.SiteURL+"HTTPHandlers/ArticlePdfHandler.ashx",i=t.data("journal"),n=t.data("pdf-id");null!=n&&null!=i&&t.on("click",function(t){t.preventDefault(),window.open(e+"?journal="+i+"&multimediaId="+n,"_blank")})}(n):function(t){o(t);var i=SCM.SiteJS.getDefaultReturnUrl();t.on("click",function(t){t.preventDefault();var e=u(this).parents(".al-article-items").find(".viewArticleLink").attr("href");window.location=e||"/sign-in?returnUrl="+encodeURIComponent(i)})}(n))})},c.triggerFppOnRedirect=function(){"undefined"!=typeof IsUserFromRedirectSite&&"true"==IsUserFromRedirectSite&&u(".firstPagePreviewImage").click()},c.articleUserComments=function(){var o=u(".comment-form__modal .preloader-wrap"),a=u(".content-form__response--error");u("#comment-modal-opener").click(function(t){if(t.preventDefault(),"True"!==SCM.UserCommentView.isUserLoggedIn){var e=SCM.UserCommentView.divId;SCM.Utilities.Reveal.open(u("#"+e))}else resetCommentForm(),SCM.Utilities.Reveal.open(u("#divCommentModal"))}),u("#divCommentModal .btnUserCommentSubmit").click(function(t){t.preventDefault(),validateCommentForm()&&(o.removeClass("hide"),submitCommentValues())}),u("#divCommentModal .btnModalCancel, #divCommentModal .btnCommentModalExit, .comment-form__close").click(function(t){t.preventDefault(),SCM.Utilities.Reveal.close(u("#divCommentModal"))}),u('input[name="NoConflicts"]').change(function(){u(this).is(":checked")?u(".disclosureBox").show():u(".disclosureBox").hide()}),validateCommentForm=function(){var t=!1;resetCommentFormValidation(),u.validity.setup({outputMode:"label"}),u.validity.start(),u("#divCommentModal .required").require();var e=u.validity.end(),i=u("#divUserCommentForm").find("textarea#Comment"),n=i.val(),o=parseInt(i.attr("maxlength"));if(0<o&&n.length>o&&(n=n.substring(0,o)),t="true"===SCM.UserCommentView.bShowDisclosure&&u('input[name="NoConflicts"]').is(":checked")&&""===u('textarea[name="Disclosure"]').val()?(u("#divCommentModal .lbldisclosure.errors").show(),!1):e.valid){var a=u("#divUserCommentForm input#termsAndConditions");a.length&&!a.is(":checked")&&(u("#divUserCommentForm .lblTermsAndConditions.errors").show(),t=!1)}return t},resetCommentForm=function(){u("#divUserCommentForm").show();var t=u("#divCommentModal");t.find("input, textarea").val(""),t.find("#displayAlert, div.captchaAlert").hide(),u('input[name="NoConflicts"]').prop("checked",!1),u('input[name="termsAndConditions"]').prop("checked",!1),u(".disclosureBox").hide(),u("#divCommentModal .btnCommentModalExit").hide(),u("#recaptcha_reload").trigger("click");var e=t.find("#Author");e.attr("value",e.attr("dataauthorvalue")),resetCommentFormValidation()},resetCommentFormValidation=function(){var t=u("#divCommentModal");t.find(".error").not(".lbldisclosure.errors").remove(),t.find(".lbldisclosure.errors").hide(),u("#divUserCommentForm .lblTermsAndConditions.errors").hide(),a.text("")},submitCommentValues=function(){var e=u("#divUserCommentForm"),t=SCM.UserCommentView.articleId,i="",n="";"true"===SCM.UserCommentView.showAffiliations&&(i=e.find("input#AffInstitution").val()),"true"===SCM.UserCommentView.bShowDisclosure&&(n=e.find("textarea#Disclosure").val()),u.ajax({type:"POST",url:"/Content/SubmitUserComment",data:{author:e.find("input#Author").val(),affInstitutions:i,disclosure:n,title:e.find("input#Title").val(),comment:e.find("textarea#Comment").val(),articleid:t,recaptchaChallege:u("#recaptcha_challenge_field").val(),recaptchaResponse:u("#recaptcha_response_field").val()},success:function(t){o.addClass("hide"),!0===t.Success?(e.hide(),u("#divCommentModal #displayAlert").show(),u("#divCommentModal .btnCommentModalExit").show(),"true"===SCM.UserCommentView.isNotModerated.toLowerCase()&&location.reload()):(o.addClass("hide"),u("div.captchaAlert").show())},error:function(t){o.addClass("hide"),a.html("Comments not saved. Please Try Again.")}})}},c.modalManager=function(){for(var t in modalArray={"#revealModal":"#revealContent",".js-open-saveSearch-modal":".solrSearchSaveModel",".js-add-edit-trigger":"#journalAddEditDiv",'.js-open-alert-modal[data-userloggedin="True"]':".userAlertSignUpModal",'[data-reveal-id="addArticleUpdateAlert"]':"#AddAlert",'[data-reveal-id="emailUsernameModal"]':"#emailUserName",".firstPagePreviewImage":"#divFirstPagePreview",'[data-reveal-id="getCitations"]':"#getCitations"},addOnClickBehavior=function(e,i){u(document.body).on("click",e,function(){var t=u(e).data("userloggedin");".js-open-saveSearch-modal"===e&&t||".js-open-saveSearch-modal"===e&&"false"===t.toLowerCase()||(u(i).closest(".reveal-modal").addClass("open"),u(document.body).addClass("on-canvas"))})},modalArray)addOnClickBehavior(t,modalArray[t])},c.init=function(){c.checkForJS(),c.detectIfIE(),c.tabletMenuDropdown(),c.mobileSiteMenuDropdown(),c.detectIfFirefox(),c.skipToMainContent(),c.globalNavDropdown(),c.articleUserComments(),c.initAriaControls(),c.initFilterClickEvent(),c.initSearchResultsSort(),c.initLazyLoad(),c.showAuthorInfo(),c.hideAuthorInfo(),c.showArticleHistory(),c.hideArticleHistory(),c.showFullAuthorList(),c.addAuthorFootnote(),c.showHideDropDown(),c.showRelatedBookWidgetIfHasContent(),c.showMoreRelatedContent(".grw-viewmorelink",".grw-hide-me"),c.showMoreRelatedContent(".mrw-viewmorelink",".mrw-hide-me"),c.showSpinner(),c.toggleMobileLanguageSubmenu(),c.toggleMobileMenu(),SCM.SiteJS.toggleMobileSignInForm(),c.toggleMobileDropdownSubnav(),c.toggleMobileSiteMenuSubnav(),c.mobileSearchDropdown(),c.toggleResponsiveLeftColumn(),c.togglePubHistory(),c.restrictedImages(),c.moveSubmitCommentLink(),c.addUserCommentJumpLink(),c.alertLinks(),c.registerArticleListNewAndPopularCombinedMode(),c.siteThemeHeaderDropdowns(),c.initSigninForm(),c.initSelfServeNavigation(),c.toggleSelfServeNavigation(),c.setAllLinksTarget(),c.showPdfOnlyLink(),c.contactUsSubmit(),SCM.gdprCookieBanner.init()},c.windowLoadInit=function(){c.initDatePicker(),c.revealFigsTablesInModal(),c.setSelectedSearchFilter(),c.getNewSelectedFilter(),c.loadAllImagesIfUserIsAboutToUseJumpLinks(),c.showUnAuthenticatedSpans(),c.toggleSearchResultsDetails(),c.toggleSearchCover(),c.modalManager(),c.triggerAlertModalOnRedirect(),c.triggerFppOnRedirect(),c.closeModals()},c.initArticleTopInfoAccessOptions=function(){var t=window.location.pathname.substring(0,window.location.pathname.indexOf("/",2))+"/sign-in?returnUrl="+encodeURIComponent(window.location.pathname+window.location.search);u(".article-top-info-user-restricted-options").find(".article-top-info-sign-in").attr("href",t)}}(SCM.SiteJS=SCM.SiteJS||{},jQuery,SCM.AccessIcons),function(n){var e,i=n(".page-column--left");$currentHeaderHeight=n("section.master-header").height();function o(){SCM.SiteJS.getViewportWidth()<=1023?i.addClass("mobile"):i.removeClass("mobile")}n(window).on("resize",function(t){clearTimeout(e),e=setTimeout(function(){o(),1023<=SCM.SiteJS.getViewportWidth()&&n(".dropdown-panel, .site-menu").removeAttr("style"),n(document.body).removeClass("noscroll"),i.hide(),n(".responsive-issue-nav").hide(),n(".page-column--left, .responsive-issue-nav, .issue-dropdown-wrap").removeAttr("style")},10)}),n(window).on("load",function(){SCM.SiteJS.windowLoadInit(),SCM.SiteJS.adjustRelatedTagsDisplay()}),n(function(){o(),SCM.SiteJS.init(),SCM.Toolbar.init(),SCM.PDFAccess.init(),SCM.SiteJS.setAccessIcons(),SCM.SiteJS.initializeArticlePdfLinks(),SCM.JumpLinks.init(),SCM.AddReturnUrlToSocietyLinks(),0<n(".widget-ArticleFulltext").length&&SCM.ArticleFulltext.init(),SCM.SiteJS.triggerSaveSearchModelOnRedirect(),SCM.SiteJS.initLazyLoad()}),n(document).ajaxStart(function(){n("body").css("cursor","wait")}).ajaxComplete(function(t,e,i){SCM.SiteJS.initSearchResultsSort(),SCM.SolrSearch.ajaxComplete(),SCM.SiteJS.setAccessIcons(),SCM.SiteJS.initializeArticlePdfLinks(),SCM.SiteJS.setAllLinksTarget(),n("body").css("cursor","default"),SCM.SiteJS.abstractMathJax(),SCM.SiteJS.alertLinks(),SCM.SiteJS.initLazyLoad(),SCM.SiteJS.initPaginationListener()})}(jQuery);var SCM=SCM||{};!function(t,r){t.setActiveJumplink=function(){r(".section-jump-link").on("click",function(){r(".section-jump-link").removeClass("active"),r(this).closest(".section-jump-link").addClass("active")})},t.toggleNestedJumplinks=function(){r(".section-jump-link .list-toggle, .section-jump-link .mobile-list-toggle").on("click",function(t){t.preventDefault();var e=r(this),i=e.parents(".section-jump-link__link-wrap").siblings("ul.section-jump-link__sublist"),n="icon-general-arrow-filled-right",o="icon-general-arrow-filled-down",a="icon-general_arrow-right",s="icon-general_arrow-down";e.hasClass("list-toggle")&&(e.hasClass(n)?e.removeClass(n).addClass(o):e.removeClass(o).addClass(n)),e.hasClass("mobile-list-toggle")&&(e.hasClass(a)?e.removeClass(a).addClass(s):e.removeClass(s).addClass(a)),"false"===e.attr("aria-expanded")?e.attr("aria-expanded","true"):e.attr("aria-expanded","false"),i.slideToggle(),"false"===i.attr("aria-hidden")?i.attr("aria-hidden","true"):i.attr("aria-hidden","false")})},t.filterTopicTerms=function(){r(".issue-topic__input").keyup(function(){r(".issue-topic__term").hide();for(var t=r(this).val(),e=[t.charAt(0).toUpperCase()+t.substr(1),t.toLowerCase()],i=0;i<e.length;i++)r(".issue-topic__term:contains('"+e[i]+"')").show();null!==t&&""!==t||r(".issue-topic__term").show()})},t.updateIssueBrowseOnChange=function(){r(".issue-browse-select").on("change",function(){window.location.href=r(this).val()})}}(SCM.Issues=SCM.Issues||{},jQuery),jQuery(document).ready(function(t){SCM.Issues.filterTopicTerms(),SCM.Issues.toggleNestedJumplinks(),SCM.Issues.updateIssueBrowseOnChange()});var SCM=SCM||{};!function(ns,$){var baseSiteUrl=$("#hfSiteURL");ns.initMyAccount=function(){var e,i=$(".myaccount-tabs-inner-wrap");$(".mobile-nav-icon");$(window).on("scroll",function(t){clearTimeout(e),e=setTimeout(function(){i.removeAttr("style")},50)}),$(window).on("resize",function(t){clearTimeout(e),e=setTimeout(function(){i.removeAttr("style")},50)});var t=location.pathname,n=t.indexOf("/","/my-account/".length);0<n&&(t=t.substring(0,n));var o=$(".myaccount-tabs-inner-wrap").find("li").has('a[href="'+t+'"]');o.addClass("is-active"),$("#myaccount-tabs").find(".myaccount-current-label").html(o.text()),$(document).on("click","#myaccount-tabs-content #updatePersonalDetailsBtn",function(){var e=$("#myaccount-tabs-content");e.find(".success-message").html("").hide(),e.find(".error-message").html("").hide();var t=e.find("#Title").val(),i=e.find("#FirstName").val(),n=e.find("#LastName").val(),o=e.find("#Phone").val(),a=e.find("#CountryList").val(),s=/[<>]/;if(s.test(t)||s.test(i)||s.test(n)||s.test(o)){var r=e.find("#err-message-angle-brackets").html();return e.find(".error-message").html(r).show(),void $("html, body").animate({scrollTop:e.offset().top},10)}$.post("/MyAccount/UpdateAccount",{title:t,firstName:i,lastName:n,phone:o,country:a},function(t){t.Success?($("#header-account-info-user-fullname").html(i+" "+n),e.find(".success-message").html(t.Html).show()):(e.find(".error-message").html(t.Html).show(),$("html, body").animate({scrollTop:e.offset().top},10))})});var c=$("#change-password").find(".error-message").html();$(document).on("click","#changePasswordBtn",function(){var e=$("#change-password"),i=e.find(".success-message");i.hide();var n=e.find(".error-message");n.html(c).hide();var t={},o=e.find("#currentPassword").val(),a=!1;""===o&&(t.currentPassword=$("label[for=currentPassword]").text().replace("*",""),a=!0);var s=e.find("#newPassword").val();""===s&&(t.newPassword=$("label[for=newPassword]").text().replace("*",""),a=!0);var r=e.find("#confirmNewPassword").val();if(""===r&&(t.confirmNewPassword=$("label[for=confirmNewPassword]").text().replace("*",""),a=!0),a){for(var l in t)n.append("<p> * "+t[l]+"</p>").show();$("html, body").animate({scrollTop:e.offset().top},10)}else n.html(""),$.post("/MyAccount/ChangePassword",{currentPassword:o,newPassword:s,confirmNewPassword:r},function(t){"1"==t[0]?(i.show(),$.post("/LOGIN",{user:t[1],pass:s,dest:"/HTTPHandlers/SAMs/LoginHandler.ashx"}).done(function(t){"1"!==t&&(location.href="/sign-in")})):(n.html(t[1]).show(),$("html, body").animate({scrollTop:e.offset().top},10))})}),$(document).on("click","#changeEmailBtn",function(){var n=$("#change-email-address"),o=n.find(".success-message"),a=n.find(".error-message"),t=n.find("#newEmailAddress").val(),e=n.find("#confirmNewEmailAddress").val(),i=n.find("#currentPassword").val(),s={},r=!1;if(a.html(""),""===t&&(s.newEmailAddress=$("label[for=newEmailAddress]").text().replace("*",""),r=!0),""===e&&(s.confirmNewEmailAddress=$("label[for=confirmNewEmailAddress]").text().replace("*",""),r=!0),""===i&&(s.password=$("label[for=currentPassword]").text().replace("*",""),r=!0),r){for(var l in a.append("Please complete the following required fields:"),s)a.append("<p> * "+s[l]+"</p>");return a.show(),void $("html, body").animate({scrollTop:n.offset().top},10)}$.post("/UserDashboard/RequestEmailAddressChange",{newEmailAddress:t,confirmNewEmailAddress:e,password:i},function(t){if(null!=t)if(t.Success)n.children(".change-email-address-form").hide(),o.show();else{for(var e=0,i=t.Messages.length;e<i;e++)a.append("<p> * "+t.Messages[e]+"</p>");a.show(),$("html, body").animate({scrollTop:n.offset().top},10)}})}),ns.initMyEditableProfile()},ns.initMyEditableProfile=function(){$(".btn-edit-userprofile").click(function(){ns.editUserProfile()})},ns.editUserProfile=function(){$.get("/Content/EditUserProfile/editUserProfile","",function(t){var e=$("#myaccount-tabs-content");null!=t&&t.length&&(e.html(t).show(),ns.initUserProfileEvents())})},ns.initUserProfileEvents=function(){$(".btn-userprofile-update").click(function(){ns.updateUserProfile()}),$(".btn-userprofile-cancel").click(function(){ns.cancelUserProfile()}),$(".userprofile-countries").change(function(){var t=$(this).find(":selected").val();ns.getUserProfileStates(t)}),SCM.MyAccount.initTestPassword()},ns.updateUserProfile=function(){var userProfile={FirstName:$("#userprofile-firstname").val(),LastName:$("#userprofile-lastname").val(),UserName:$("#userprofile-username").val(),Password:$("#Password").val(),ConfirmPassword:$("#ConfirmPassword").val(),Organization:$("#userprofile-organization").val(),HomePhone:$("#userprofile-homephone").val(),WorkPhone:$("#userprofile-workphone").val(),MobilePhone:$("#userprofile-mobilephone").val(),Suffix:$("#userprofile-suffix").val(),Address:$("#userprofile-address").val(),Address2:$("#userprofile-address2").val(),City:$("#userprofile-city").val(),PostalCode:$("#userprofile-postalcode").val(),StateId:$(".userprofile-states :selected").val(),CountryId:$(".userprofile-countries :selected").val(),Title:$("#userprofile-title").val(),EmailAddress:$("#userprofile-emailaddress").val()};$.ajax({type:"POST",url:"/Content/UpdateUserProfile/updateUserProfile",data:JSON.stringify(userProfile),contentType:"application/json",success:function(t){var e=$("#myaccount-tabs-content");if(null==t.Success&&t.length)e.html(t).show(),ns.initMyEditableProfile();else if(e.find(".error-message").html(t.Html),null!=t.Messages&&t.Messages.length){var i=$("<ul></ul>");$.each(t.Messages,function(t,e){i.append("<li>"+e+"</li>")});var n=e.find(".error-message");n.append(i),n.show()}},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})},ns.cancelUserProfile=function(){$.get("/Content/MyProfile/myProfile","",function(t){var e=$("#myaccount-tabs-content");null!=t&&t.length&&(e.html(t).show(),ns.initMyEditableProfile())})},ns.getUserProfileStates=function(t){$.get("/Content/UserProfileGetStates/myProfileGetStates",{countryId:t},function(t){var e=$(".userprofile-states");if(e.empty(),null!=t&&t.length){for(var i in t){var n=$("<option/>").attr("value",t[i].StateId).text(t[i].StateName);e.append(n)}e.removeClass("hide"),e.closest(".dataRow").removeClass("hide")}else e.removeClass("hide").addClass("hide"),e.closest(".dataRow").addClass("hide")})},ns.initSavedSearches=function(){$(".solrSearchSaveWidget table.tablesorter").tablesorter({theme:"default",delayInit:!0,ignoreCase:!0,headers:{4:{sorter:!1}},sortList:[[0,0]]}),$(".solrSearchSaveWidget .save-search-delete").click(function(){SCM.MyAccount.deleteSaveSearch($(this))}),$(".solrSearchSaveWidget .ddlSearchAlertFrequencyMyAccount").change(function(){SCM.MyAccount.changeUserAlert($(this))}),$(".solrSearchSaveWidget .save-search-rename-rename").click(function(){var t=$(this).closest("td"),e=t.find(".save-search-name-link");e.hide(),t.find(".save-search-input").val(e.text()).css("display","inline-block").focus(),t.find(".save-search-rename-cancel").show(),t.find(".save-search-rename-save").show(),$(this).hide()}),$(".solrSearchSaveWidget .save-search-rename-cancel").click(function(){var t=$(this).closest("td");t.find(".save-search-name-link").show(),t.find(".save-search-input").hide(),t.find(".save-search-rename-rename").show(),t.find(".save-search-rename-save").hide(),$(this).hide()}),$(".solrSearchSaveWidget .save-search-rename-save").click(function(){var t=$(this),e=t.closest("td"),i=e.find(".save-search-input"),n=t.closest("tr").data("usersearchid"),o=i.val();o.length&&(SCM.MyAccount.renameSaveSearch(o,n),i.hide(),e.find(".save-search-name-link").text(o).show(),e.find(".save-search-rename-rename").show(),e.find(".save-search-rename-cancel").hide(),$(this).hide())}),$(".solrSearchSaveWidget .save-search-input").on("keypress",function(t){var e=$(this).closest("td"),i=$(this).val();if(13===(t.keyCode||t.which)&&(t.preventDefault(),i.length)){var n=e.closest("tr").data("usersearchid");SCM.MyAccount.renameSaveSearch(i,n),$(this).hide(),e.find(".save-search-name-link").text(i).show(),e.find(".save-search-rename-rename").show(),e.find(".save-search-rename-save").hide(),e.find(".save-search-rename-cancel").hide()}})},ns.deleteSaveSearch=function(delElem){var ajaxUrl="//"+baseSiteUrl.val()+"/Solr/DeleteSolrSearchInfo",parentElem=delElem.closest("tr"),id=parentElem.data("usersearchid"),userAlertId=parentElem.data("useralertid");$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:{userSearchId:id,userAlertId:userAlertId},success:function(t){t.Success&&parentElem.remove()},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})},ns.changeUserAlert=function(upElem){var ajaxUrl="//"+baseSiteUrl.val()+"/Solr/UpdateUserAlert",parentElem=upElem.closest("tr"),id=parentElem.data("usersearchid"),userAlertId=parentElem.data("useralertid"),scheduleId=upElem.val();$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:{userSearchId:id,userAlertId:userAlertId,scheduleId:scheduleId},success:function(t){t.Success&&parentElem.data("useralertid",t.ReturnId)},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})},ns.renameSaveSearch=function(searchName,userSearchId){var ajaxUrl="//"+baseSiteUrl.val()+"/Solr/RenameSolrSearchInfo";$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:{searchName:searchName,userSearchId:userSearchId},success:function(t){},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})},ns.initRegister=function(t){var g=$(".widget-RegisterUser");null!=t&&0<t.length&&g.find(".error-message").html(t).show(),g.on("click","#showPassword",function(){g.find("#Password, #ConfirmPassword").each(function(){var t=$(this).clone();t.attr("type","text"),t.attr("autocomplete","off"),t.attr("value",$(this).val()),$(this).after(t),$(this).remove()}),$(this).hide(),$(this).siblings("#hidePassword").show()}),g.on("click","#hidePassword",function(){g.find("#Password, #ConfirmPassword").each(function(){var t=$(this).clone();t.attr("type","password"),t.removeAttr("autocomplete"),t.attr("value",$(this).val()),$(this).after(t),$(this).remove()}),$(this).hide(),$(this).siblings("#showPassword").show()}),$(document).ready(function(){ns.loadCountryStates($(".widget-RegisterUser"))}),g.on("change","#CountryList",function(){ns.loadCountryStates(g)}),g.on("click","#registerBtn",function(){g.find(".error-message").html().hide;var t=g.find("#UserName").val(),e=g.find("#EmailAddress").val(),i=g.find("#Password").val(),n=g.find("#ConfirmPassword").val(),o=g.find("#Title").val(),a=g.find("#FirstName").val(),s=g.find("#LastName").val(),r=g.find("#MembershipNumber").val(),l=g.find("#VendorId").val(),c=g.find("#Address").val(),d=g.find("#City").val(),u=g.find("#StateList").val(),h=g.find("#CountryList").val(),p=g.find("#ZipCode").val(),f=g.find("#Telephone").val(),m=JSON.stringify({UserName:t,EmailAddress:e,Password:i,ConfirmPassword:n,Title:o,FirstName:a,Lastname:s,MembershipNumber:r,VendorId:l,Address:c,City:d,State:u,Country:h,ZipCode:p,PhoneNumber:f});$.ajax({type:"POST",url:"/UserDashboard/RegisterNewUser",data:m,success:function(t){if(t.Success)SCM.SiteJS.loginReturnBack();else if(null!=t.Messages&&t.Messages.length){var i=$("<ul></ul>");$.each(t.Messages,function(t,e){i.append("<li>"+e+"</li>")}),g.find(".error-message").html(i).show()}},contentType:"application/json"})}),SCM.MyAccount.initTestPassword()},ns.initTestPassword=function(){var e=$(".register-form-wrap, .editable-userprofile-info"),i=/[A-Z]/,n=/[0-9]/,o="",a=e.find(".icon-case"),s=e.find(".password-confirm-icon"),r=e.find(".password-input-icon"),l=e.find(".icon-length"),c=e.find(".icon-number"),d=e.find(".password-check-wrap"),u=!1;e.on("keyup","#Password",function(){var t=$(this).val();o=t,u?d.hide():d.show(),10<=t.length?SCM.MyAccount.showValidPasswordCriteria(l):SCM.MyAccount.showInvalidPasswordCriteria(l),i.test(t)?SCM.MyAccount.showValidPasswordCriteria(a):SCM.MyAccount.showInvalidPasswordCriteria(a),n.test(t)?SCM.MyAccount.showValidPasswordCriteria(c):SCM.MyAccount.showInvalidPasswordCriteria(c),l.hasClass("green")&&a.hasClass("green")&&c.hasClass("green")?(u=!0,d.fadeOut(1500),r.hide(),t===e.find("#ConfirmPassword").val()&&(s.hide(),e.find("#registerBtn").addClass("btn-green"),e.find(".register-button-overlay").hide())):(u=!1,d.show(),SCM.MyAccount.lockRegistrationButton(),r.show()),""!==t&&null!==t||(d.hide(),r.hide())}),e.on("keyup","#ConfirmPassword",function(){var t=$(this).val();o===t?(s.hide(),u&&(e.find("#registerBtn").addClass("btn-green"),e.find(".register-button-overlay").hide())):(""===t||null===t?s.hide():s.show(),SCM.MyAccount.lockRegistrationButton())}),$(document).on("click",function(){d.hide()})},ns.loadCountryStates=function(formContainer){var countryId=formContainer.find("#CountryList").val(),stateList=formContainer.find("#StateList");if(stateList.empty().prop("disabled",!0),null!=countryId&&countryId.length){var countryData={countryId:countryId};$.ajax({url:"/UserDashboard/RegisterGetCountryStates",data:countryData,success:function(t){null!=t&&t.length&&($.each(t,function(t,e){stateList.append($('<option value="'+e.StateId+'">'+e.StateName+"</option>"))}),stateList.prop("disabled",!1))},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})}},ns.lockRegistrationButton=function(){$(".register-form-wrap").find("#registerBtn").removeClass("btn-green"),$(".register-form-wrap").find(".register-button-overlay").show()},ns.showValidPasswordCriteria=function(t){t.removeClass("icon-general-close red").addClass("icon-general-check green"),t.siblings(".password-check-label").addClass("fade")},ns.showInvalidPasswordCriteria=function(t){t.removeClass("icon-general-check green").addClass("icon-general-close red"),t.siblings(".password-check-label").removeClass("fade")},ns.initForgotPassword=function(){var r=$("#forgot-password").find(".error-message").html();$("#forgotPasswordBtn").on("click",function(){var i=$("#forgot-password"),n=i.find(".success-message"),o=i.find(".error-message"),t="";n.html("").hide(),o.html(r).hide();var a=i.find("#contactEmail").val(),s=i.find("#hfCaptchaEnabledForForgotPassword").val(),e={email:a};"1"===s&&(e.captchaChallenge="not empty",e.captchaResponse=grecaptcha.getResponse()),0===e.email.length&&(t+="<p> * "+$("label[for=contactEmail]").text().replace("*","")+"</p>"),"1"===s&&0===e.captchaResponse.length&&(t+="<p> * Captcha</p>"),0===t.length?$.post("/UserDashboard/ForgotPassword",e,function(t){if(null==t||""==t){var e=i.find(".success-message-template").html().replace("{0}",a);n.html(e).show()}else o.html(t).show(),$("html, body").animate({scrollTop:i.offset().top},10);"1"===s&&$("#recaptcha_reload").trigger("click")},"html"):(o.append(t).show(),$("html, body").animate({scrollTop:i.offset().top},10))})},ns.initResetPassword=function(){$("#changePasswordBtn").on("click",function(){var i=$("#change-password"),n=i.find(".success-message"),o=i.find(".error-message"),t=i.find(".default"),e=$.deparam.querystring().t,a=i.find("#newPassword").val(),s=i.find("#confirmNewPassword").val();t.removeClass("default"),$.post("/UserDashboard/ResetPassword",{token:e,newPassword:a,confirmNewPassword:s},function(t){if(null==t||""==t){var e=$.deparam.querystring().returnUrl;e&&window.location.assign(e),n.show(),o.hide()}else n.hide(),o.html(t).show(),$("html, body").animate({scrollTop:i.offset().top},10)},"html")})},ns.countSubjectChoices=function(){$("#communication-preferences-subject-choices").find(".topics-selected-wrap").each(function(){var t=$(this).closest("li").find("input[type=checkbox]"),e=t.filter(":checked");$(this).find(".totalCount").html(t.length),$(this).find(".checkedTotal").html(e.length),$(this).show()})},ns.changeUserTypeSubjects=function(e){var t=$("#communication-preferences");$("#userTypeSubjectHeader").hide();var i=t.find("#userTypes").val();"3"===i&&$("#userTypeSubjectHeader").show(),t.find("ul#userTypeSubjects > li").each(function(){var t=$(this).find("input[type=checkbox]");$(this).attr("data-classification-id")===i?($(this).show(),e&&t.prop("checked",t.data("checked"))):($(this).hide(),e&&t.prop("checked",!1))})},ns.initCommunicationPreferences=function(t){SCM.MyAccount.countSubjectChoices(),$("#communication-preferences-subject-choices").on("click",".mainSubjects > a",function(){$(this).siblings("ul").slideToggle(),$(this).children("i").hasClass("icon-general-arrow-filled-down")?$(this).children("i").removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right"):$(this).children("i").removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down")}),$("#communication-preferences-subject-choices").on("click","input[type=checkbox]",function(){$(this).next("ul").find("input[type=checkbox]").prop("checked",!$(this).is(":checked")),SCM.MyAccount.countSubjectChoices()}),null!=t&&0<t&&$("#communication-preferences #userTypes").val(t),SCM.MyAccount.changeUserTypeSubjects(!1),$("#communication-preferences #userTypes").change(function(){SCM.MyAccount.changeUserTypeSubjects(!0)}),$("#communication-preferences #btnConfirmOptIn").on("click",function(){var e=$(this);$.ajax({url:"/MyAccount/SendEmailForOptInCommPref",type:"GET",dataType:"json"}).done(function(t){t.Success?$("#communication-preferences").find(".success-message").html(t.Html).show():$("#communication-preferences").find(".error-message").html(t.Html).show(),e.hide(),$("#communication-preferences .send-verify-email").hide()})}),$("#communication-preferences #updatePreferencesBtn").click(function(){var e=$("#communication-preferences"),t=e.find("#confirmOptIn").is(":checked"),i=[];e.find("input[type=checkbox][data-type=subjectId]").filter(":checked").each(function(){i.push($(this).val())});var n=e.find("#userTypes").val();$.ajax({url:"/MyAccount/UpdateCommunicationPreferences",type:"POST",traditional:!0,data:{optInMarketEmail:t,subjectIds:i,classificationId:n},dataType:"html"}).done(function(t){e.find(".success-message").html(t).show(),e.find("#userTypeSubjects input[type=checkbox][data-type=subjectId]").each(function(){$(this).data("checked",$(this).is(":checked"))})})})},ns.initActivateSubscription=function(){$("#activateSubscriptionBtn").on("click",function(){var e=$(".activate-subscription-wrap"),n=e.find(".error-message");if(n.html("").hide(),0==$("#activateSubscriptionTermsConditions").is(":checked"))n.html($("#activateSubErrTermsConditions").html()).show(),$("html, body").animate({scrollTop:e.offset().top},10);else{var t=$("#activateSubscriptionToken").val();0<t.length&&$.post("/MyAccount/ActivateSubscriptionSubmitToken",{token:t},function(t){"subscriptions"==t?location.href="/my-account/subscriptions":"institutional-settings"==t?setTimeout(function(){location.href="/my-account/institutional-settings"},1e3):(n.html(t).show(),$("html, body").animate({scrollTop:e.offset().top},10))},"html").fail(function(t,e,i){n.html("There was an error processing your request, please try again or contact customer service.").show()})}}),$("#activateSubscriptionToken").on("keypress",function(t){13===(t.keyCode||t.which)&&(t.preventDefault(),$("#activateSubscriptionBtn").click())})},ns.initInstitutionalSettings=function(){var u=$(".error-summary").html();$("#institutionalAccountInfo").on("click","#saveInstitutionalSettingsBtn",function(){var n=$(this).closest("#institutionalAccountInfo"),o=n.find(".error-summary");o.html(u);var a=n.find(".instUpdate-success");a.hide(),o.hide(),n.find(".instUpdate-error").html("").removeClass("is-active");var t=n.find("#instSet-InstitutionName").val(),e=n.find("#instSet-IpAddresses").val(),i=n.find("#instSet-OrgId").val(),s=n.find("#instSet-EntityId").val(),r=n.find("#instSet-OpenUrl").val(),l=n.find("#instSet-OpenUrlButton").val(),c=n.find("#instSet-InstUrl").val(),d=n.find("#instSet-InstLogo").val();$.post("/MyAccount/UpdateInstitutionalAccountInfo",{institutionName:t,ipAddresses:e,orgId:i,entityId:s,openUrl:r,openUrlButton:l,instUrl:c,instLogoUrl:d},function(t){if(null==t||null==t||$.isEmptyObject(t))a.show(),$.trim(l).length?$("#instSet-OpenUrlButtonImg").attr("src",l).show():$("#instSet-OpenUrlButtonImg").hide(),$.trim(d).length?$("#instSet-InstLogoImg").attr("src",d).show():$("#instSet-InstLogoImg").hide();else{for(var e in t){var i=null;switch(e){case"general":i="general";break;case"institutionName":i="instSet-InstitutionName";break;case"ipAddressList":i="instSet-IpAddresses";break;case"orgId":i="instSet-OrgId";break;case"entityId":i="instSet-EntityId";break;case"openUrl":i="instSet-OpenUrl";break;case"openUrlButton":i="instSet-OpenUrlButton";break;case"instUrl":i="instSet-InstUrl";break;case"instLogoUrl":i="instSet-InstLogo"}null!=i&&("general"===i?n.find(".instUpdate-error.general-error").html(t[e]).addClass("is-active"):(n.find("#"+i).next(".instUpdate-error").html(t[e]).addClass("is-active"),o.append("<p> * "+$("label[for="+i+"]").text().replace("*","")+"</p>"),o.show()))}$("html, body").animate({scrollTop:n.offset().top},10)}})})},ns.initSubscriptions=function(){$(".subscriptions-wrap table.tablesorter").tablesorter({theme:"default",delayInit:!0,ignoreCase:!0,sortList:[[0,0]]}),$(".subscriptions-wrap .view-expired-link").click(function(){$(this).hide(),$subTypeContainer=$(this).closest(".subscription-type").find(".subscription-type-table"),$subTypeContainer.show(),$subTypeContainer.children("tbody").children("tr").show()}),$(".subscriptions-wrap .subscription-resource-link").click(function(){var t=$(this).data("resource-id"),e=$(this).data("resource-type");$.get("/MyAccount/GetResourceUrl",{resourceId:t,resourceType:e},function(t){top.location=t},"text")})},ns.initShibboleth=function(){$("#FederationDropdown").on("change",function(){var federationID=$(this).val();""!=federationID&&0<federationID&&$.ajax({url:"/UserDashboard/GetInstitutionsForFederation",type:"POST",dataType:"json",data:{FederationID:federationID},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}}).done(function(t){var i=$("#InstitutionDropdown");i.find("option:gt(0)").remove(),$.each(t,function(t,e){i.append('<option value="'+e.ShibbolethID+'">'+e.InstitutionName+"</option>")})})}),$("#shibbolethSelectBtn").on("click",function(){var shibbolethID=$("#InstitutionDropdown").val();""!=shibbolethID?$.ajax({url:"/UserDashboard/RedirectToShibboleth",type:"POST",dataType:"json",data:{ShibbolethID:shibbolethID},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}}).done(function(t){var e=$.deparam.querystring().returnUrl;e&&(document.cookie="returnUrl="+encodeURIComponent(e)),window.location.assign(t)}):$("#shibboleth-error").html("Please select an institution")})},ns.checkOpenAthens=function(){0<=window.location.search.indexOf("openathens=")&&$('#FederationDropdown option:contains("OpenAthens Federation")').attr("selected","selected").change()}}(SCM.MyAccount=SCM.MyAccount||{},jQuery),$(document).ready(function(){$(document).on("click",".myaccount-tabs-inner-wrap div",function(){$(".tabbed-content-overlay").show()}),$("#myaccount-tabs-content").on("DOMSubtreeModified",function(){$(".tabbed-content-overlay").hide()}),$("#institutionalLogoURL").keyup(function(){$(".logoPreview").attr("src",$(this).val()),$(".logoPreview").error(function(){$(this).attr("src","/Images/grey.gif")})}),SCM.MyAccount.checkOpenAthens()});var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},function(ns,$,bc){function handleClickEvent(){var $this=$(this),articleId=$this.data("articleid"),isLayAbstract="True"===$this.data("is-lay-abstract"),$abstractLocation=getAbstractLocation(articleId,isLayAbstract),$abstractLinks=$("#abstract-"+articleId+"-links"),ajaxUrl=getAjaxUrl($this,isLayAbstract);$abstractLocation.closest(".js-abstract-parent").toggleClass("abstractExpanded");var isAbstractAlreadyFetchedFromServer="True"===$this.data("tried-to-fetch-abstract");isAbstractAlreadyFetchedFromServer||(toggleSpinner($abstractLocation),$.get(ajaxUrl,{articleId:articleId,layAbstract:isLayAbstract}).done(function(t){$abstractLocation.html(t.Html),$abstractLocation.append($abstractLinks.html()),handleClickEventForTabs(),bc&&bc.init&&bc.init()}).fail(function(xmlHttpRequest,textStatus,errorThrown){if(toggleSpinner($abstractLocation),window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}),$this.data("tried-to-fetch-abstract","True")),$abstractLocation.toggleClass("hide");var $thisAbstractIcon=$this.find(".js-abstract-toggle-icon"),toggleIconClass=$thisAbstractIcon.data("icon-class"),downArrow=toggleIconClass+"-down",upArrow=toggleIconClass+"-up";$thisAbstractIcon.toggleClass(downArrow),$thisAbstractIcon.toggleClass(upArrow)}function getAbstractLocation(t,e){return $(e?".js-layabstract#abstract-"+t:"#abstract-"+t)}function getAjaxUrl(t,e){var i="",n=getBaseSiteUrl();return n&&(i+="//"+n),e?i+="/PlatformArticle/ArticleLayAbstractAjax":"extract"===t.data("abstract-type")?i+="/PlatformArticle/ArticleAbstractOrExtractAjax":i+="/PlatformArticle/ArticleAbstractAjax",i}function getBaseSiteUrl(){var t=$("#hfSiteURL");return t.length?t.val():null}function handleClickEventForTabs(){$(".js-tabs").parents(".js-abstract-response-placeholder").addClass("removePad"),$(document).on("click",".js-abstract-tab-link",function(t){var e=$(t.target),i=e.closest(".js-abstract-response-placeholder"),n=e.closest(".js-abstract-tab-link-wrap"),o=i.find(".js-tabs-content .js-abstract-tab-content-wrap"),a=n.index();switchTabLinks(i,n),switchTabContent(o,a)})}function switchTabLinks(t,e){t.find(".js-abstract-tab-link-wrap").removeClass("is-active"),e.addClass("is-active")}function switchTabContent(t,e){t.removeClass("is-active"),t.eq(e).addClass("is-active")}function toggleSpinner(t){t.find(".js-spinner").toggleClass("hide")}ns.initAbstractClickEvent=function(){$(".master-main").on("click",".js-show-abstract",handleClickEvent)}}(SCM.ArticleAbstract=SCM.ArticleAbstract||{},jQuery,SCM.Utilities.Brightcove),jQuery(document).ready(function(){SCM.ArticleAbstract.initAbstractClickEvent()});var SCM=SCM||{};!function(ns,$){ns.initChapterAbstractClickEvent=function(){$(".master-main").on("click",".js-showChapterAbstractLink",function(){var wrapperDiv=$(this).closest("div[data-chapter-abstract-to-be-fetched-wrapper]"),chapterId=$(wrapperDiv).attr("data-chapterid-for-abstract"),bookId=$(wrapperDiv).attr("data-bookid-for-abstract"),triedFetchDiv=$(wrapperDiv).children("div[data-tried-to-fetch-abstract]").first(),triedFetch="true"===$(triedFetchDiv).attr("data-tried-to-fetch-abstract"),abstractLocation=$("#abstract-"+chapterId),baseSiteUrl=$("#hfSiteURL"),abstractLinks=$("#abstract-"+chapterId+"-links"),ajaxUrl="extract"==$(this).parent().attr("data-link-chapter-abstract-type")?"/PlatformBook/ChapterAbstractOrExtractAjax":"/PlatformBook/ChapterAbstractAjax";baseSiteUrl&&baseSiteUrl.val()&&(ajaxUrl="//"+baseSiteUrl.val()+ajaxUrl),$(abstractLocation).closest("li").toggleClass("abstractExpanded"),triedFetch||($(abstractLocation).append('<div class="spinner"></div>'),$.ajax({url:ajaxUrl,type:"GET",data:{chapterId:chapterId,bookId:bookId},success:function(t){abstractLocation.html(t.Html),abstractLocation.append(abstractLinks.html())},error:function(xmlHttpRequest,textStatus,errorThrown){if($(abstractLocation).find(".spinner").remove(),window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}}),$(triedFetchDiv).attr("data-tried-to-fetch-abstract","true")),abstractLocation.toggleClass("hide");var $thisAbstractIcon=wrapperDiv.find(".abstract-toggle-icon"),toggleIconClass=$thisAbstractIcon.attr("data-icon-class"),downArrow=toggleIconClass+"-down",upArrow=toggleIconClass+"-up";$thisAbstractIcon.toggleClass(downArrow),$thisAbstractIcon.toggleClass(upArrow)})}}(SCM.ChapterAbstract=SCM.ChapterAbstract||{},jQuery),jQuery(document).ready(function(t){SCM.ChapterAbstract.initChapterAbstractClickEvent()});var SCM=SCM||{};SCM.SearchResults={},SCM.SearchResults.defaults={controller:"Solr",action:"SolrSearch",instanceName:"Site_Theme_SearchResults",baseSiteUrl:"",updateTargetSelector:".content-main_content"},function(t,d){function u(e,i){e.on("keydown",function(t){if(13===t.which&&isYearOnly(e.val()))return updateYearOnlyToFullDate(e,i),t.preventDefault(),t.stopImmediatePropagation(),!1}).datepicker()}function r(){0<=window.location.search.indexOf("&cqb=")&&(d("#btnReturnAdvancedSearch").removeClass("hide"),d(".querybuilder-wrap").addClass("hide"));var t=d("#queryBuilderSubmit").data("currentUrl");d("#btnReturnAdvancedSearch").click(function(){window.location.href=location.protocol+"//"+d("#hfSiteURL").val()+"/advanced-search?"+t})}function l(){d(".taxonomy-parent-arrow").on("click",function(){var t=d(this);t.parents(".taxonomy-label-wrap").siblings(".taxonomy-child-list").slideToggle(),t.hasClass("icon-general-arrow-filled-right")?t.removeClass("icon-general-arrow-filled-right").addClass("icon-general-arrow-filled-down"):t.removeClass("icon-general-arrow-filled-down").addClass("icon-general-arrow-filled-right")})}t.AddShowMoreLinks=function(){var e=d("#js-hf-facet-toggle-limit").val();e=e||12,d(".collapsible-facet .sf-facet-list").each(function(){d(this).find(".sf-facet").length>e&&(d(this).find(".sf-facet:gt("+(e-1)+")").hide(),d(this).find(".facetShowMore").length||d(this).append('<li><a href="javascript:;" class="facetShowMore">Show more</a></li>'))}),d(".facetShowMore").off("click"),d(".facetShowMore").on("click",function(t){d(this).closest(".sf-facet-list").find(".sf-facet:gt("+(e-1)+"):visible").length?(d(this).closest(".sf-facet-list").find(".sf-facet:gt("+(e-1)+"):visible").animate({height:"toggle"},400),d(this).text("Show more")):(d(this).closest(".sf-facet-list").find(".sf-facet").not(":visible").animate({height:"toggle"},400),d(this).text("Show less")),t.preventDefault()}),d(document).on("click",".js-sri-journal-description-container a",function(t){t.preventDefault(),d(this).closest(".js-sri-journal-description-container").find(".js-sri-journal-description").toggleClass("hide")})},SCM.SearchResults.AddShowMoreLinks(),r(),l();var c,h={},p=window.location.search.substring(1);window.onpopstate=function(t){t.state&&t.state.queryString&&SCM.SearchResults.doSolrSearch(t.state)},function(){var t=d(SCM.SearchResults.defaults.updateTargetSelector);h[p]={results:t.html()},window.history.replaceState({queryString:p},null,null);var e=d("#fromDate"),i=d("#ToDate");d("#fromDate").datepicker(),d("#ToDate").datepicker();var n=!0;Date.prototype.today=function(){return(this.getMonth()+1<10?"0":"")+(this.getMonth()+1)+"/"+(this.getDate()<10?"0":"")+this.getDate()+"/"+this.getFullYear()};function s(t){var e=/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{2,4})$/.exec(t);if(null==e)return!1;var i=e[2],n=e[1]-1,o=e[3];2==o.length&&(o="20"+o);var a=new Date(o,n,i);return a.getDate()==i&&a.getMonth()==n&&a.getFullYear()==o}function r(t){var e=/^(\d{4})$/.exec(t);return e&&-1<e[1]}function l(t,e){var i=t.val(),n=null,o=null;return o=e?n="01":(n="12","31"),t.val(n+"/"+o+"/"+i),t.val()}function c(t){var e=/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{2,4})$/.exec(t),i=e[1],n=e[2],o=e[3],a=n,s=i,r=o;return 2==o.length&&(r="20"+o),1==n.length&&(a="0"+n),1==i.length&&(s="0"+i),s+"/"+a+"/"+r}t.on("click",".chkSelect",function(t){SCM.SearchResults.doSolrSearch({queryString:d(this).data("redirectUrl"),source:"searchresults"})}),t.on("click","a.close",function(t){var e=d(this).attr("data-url");null!=e&&"#"!=e&&""!=e&&(t.preventDefault(),SCM.SearchResults.doSolrSearch({queryString:e,source:"searchresults"})),u(d("#fromDate"),!0),u(d("#ToDate"),!1)}),t.on("click",".rbShowFacet",function(t){if(t.preventDefault(),"False"==d(this).attr("previous-status")){var e=d(this).attr("data-url");SCM.SearchResults.doSolrSearch({queryString:e,source:"searchresults"})}}),t.on("click","#solrSearchBtn",function(t){var e=d("#txtSearch").val();null==e||""==e?alert("Please enter a term to perform search"):(e=encodeURIComponent(e),SCM.SearchResults.doSolrSearch({queryString:"q="+e}))}),t.on("click","#btnRangeSearch",function(t){var e=d("#fromDate").val();r(e)&&(e=l(d("#fromDate"),!0));var i=d(".date-range-input-radio[value=single]").is(":checked")?e:d("#ToDate").val();if(""!==i&&r(i)&&(i=l(d("#ToDate"),!1)),s(e)&&s(i)){var n=c(e),o=c(i);if(new Date(o)<new Date(n))alert("End Date must be greater than Start Date");else{var a=d(this).attr("data-url").replace("queryText",n+" TO "+o);SCM.SearchResults.doSolrSearch({queryString:a,source:"searchresults"})}}else alert("Please enter valid dates")});function o(t){return"string"==typeof t?"true"==t.toLowerCase():!!t}var a=function(){var t={UserEmail:d("#UserEmail").val(),ResourceTitle:d("#ResourceTitle").val(),AlertType:d("#AlertType").val(),CurrentUserEmail:d("#CurrentUserEmail").val(),IsUserAlreadySubscribed:o(d("#IsUserAlreadySubscribed").val()),SuccessfulUpdate:d("#SuccessfulUpdate").val(),ResourceId:d("#ResourceId").val(),ResourceType:d("#ResourceType").val(),SearchTerm:d("#SearchTerm").val(),SearchUrl:d("#SearchUrl").val(),CurrentAlertContextSiteId:d("#CurrentAlertContextSiteId").val(),ShowSaveSearchToUnauthenticatedUser:o(d("#ShowSaveSearchToUnauthenticatedUser").val()),UserIsLoggedIn:o(d("#UserIsLoggedIn").val())};if(null!=t.IsUserAlreadySubscribed&&t.IsUserAlreadySubscribed){var e=d("#Config_SearchAlertMyAccoutUrl").val();window.location.href=e}else t.ShowSaveSearchToUnauthenticatedUser&&!t.UserIsLoggedIn?(ShowSignInForSearchAlertSignUp(),n=!0):d.post("/Toolbox/ToolboxGetAlertsUpdateMessage",t,function(t){n=!0,alert("Alert Saved Sucessfully. Visit My Account page to manage your email alerts"),d("#divSearchAlerts").html(t),d("#divSearchAlerts a").on("click",function(t){t.preventDefault(),a()})})};t.on("click","#divSearchAlerts a",function(t){t.preventDefault(),n&&(n=!1,a())}),u(e,!0),u(i,!1)}(),SCM.SearchResults=d.extend(SCM.SearchResults,(c=jQuery,{doSolrSearch:function(i){function n(t){t.getBoundingClientRect().top<0&&c("html, body").animate({scrollTop:t.offsetTop},1e3)}function o(t){null===window.history.state?window.history.replaceState(t,null,window.location.pathname+"?"+t.queryString):window.history.state.queryString!=t.queryString&&window.history.pushState(t,null,window.location.pathname+"?"+t.queryString)}var a=c.extend(SCM.SearchResults.defaults,i),s=c(a.updateTargetSelector);if(h[i.queryString])return s.html(h[i.queryString].results).show(),SCM.SolrSearch.ajaxComplete(),n(s[0]),l(),o(i),r(),App.SiteJS.mobileContentNav(),void c("body").removeClass("on-canvas");var t=c.deparam.querystring().page;t&&1!==parseInt(t)&&(i.queryString=i.queryString.replace("page="+t,"page=1"));var e="/"+a.controller+"/"+a.action+"/"+a.instanceName;void 0!==a.baseSiteUrl&&""!==a.baseSiteUrl&&(e="//"+a.baseSiteUrl+e),e+="?"+i.queryString,"155"===c("#hdnSiteID").val()&&window.location.href.indexOf("/map-results?")<0?window.location.href="?"+i.queryString:c.ajax({url:e,success:function(t){if(s.html(t),n(s[0]),h[i.queryString]={results:t,updateTargetSelector:a.updateTargetSelector},u(c("#fromDate"),!0),u(c("#ToDate"),!1),App.SiteJS.mobileContentNav(),c("body").removeClass("on-canvas"),"undefined"!=typeof clientViewOption&&""!==clientViewOption){var e=c(".sri-expandedView");"Expanded"===clientViewOption?e.show():e.hide()}l(),o(i),r(),i.hasOwnProperty("source")&&0<window.location.pathname.indexOf("map-results")&&"heatmap"!==i.source&&SCM.SearchMap.searchUpdated(),SCM.JournalCitationFilter&&SCM.JournalCitationFilter.init(),SCM.SearchResults.AddShowMoreLinks()},error:function(t){console.log(t)}})}}))}(SCM.SearchResults=SCM.SearchResults||{},jQuery);var SCM=SCM||{};!function(SolrSearch,$,undefined){var bodyVar=$("body"),hfParentSiteName=$("#hfParentSiteName"),queryText="",baseSiteURL=$("#hfSiteURL");void 0!==baseSiteURL&&""!==baseSiteURL.val()&&(SCM.SearchResults.defaults.baseSiteUrl=baseSiteURL.val());var testSearchInput=function(t){if(""===hfParentSiteName.val())return""===$.trim(t)||null===t||"Search"===t?(alert("Please enter a term to search: "),!1):t?(doSolrSearch(t),!0):(alert("SCM.SolrSearch.testSearchInput() fail"),!1);doSolrSearch(t)},testKeypress=function(t,e){13===t.keyCode&&(t.preventDefault(),testSearchInput(e))};function doSolrSearch(t){queryText=encodeURIComponent(t);var e=$("#hfQuickSearchUrl").val(),i="";if(e)i=e.replace("{searchQuery}",queryText),window.location=i;else{i="search-results?page=1&q="+queryText+"&SearchSourceType=1";var n=$("#hfSiteURL");n.length&&(i="//"+n.val()+"/"+i),window.location.href=i}}var openSaveSolrSearch=function(t){$(t).closest(".reveal-modal").addClass("open"),$("body").addClass("on-canvas")};function initDateRangeToggle(){$(".date-range-input-radio").on("click",function(){"single"===$(this).attr("value")?($(".date-input-to").addClass("hide"),$(".date-label-from span").text("Search on this date")):($(".date-input-to").removeClass("hide"),$(".date-label-from span").text("From"))})}var saveSolrSearchInfo=function(solrSearchSaveModel){var txtSolrSearchName=$(".txtSolrSearchName");if(""===$.trim(txtSolrSearchName.val())||null===txtSolrSearchName.val())return alert("Please enter a name"),!1;var ddlSearchAlertFrequency=$("#ddlSearchAlertFrequency"),redirectUrl=$("#hdnSearchSaveRedirectUrl"),currentUrl=window.location.href,data=JSON.stringify({searchName:txtSolrSearchName.val(),url:currentUrl,scheduleId:ddlSearchAlertFrequency.val(),redirectUrl:redirectUrl.val()}),ajaxUrl="//"+SCM.SearchResults.defaults.baseSiteUrl+"/Solr/SaveSolrSearchInfo";$.ajax({url:ajaxUrl,type:"POST",dataType:"json",cache:!1,data:data,contentType:"application/json; charset=utf-8",success:function(t){t.RedirectUrl&&t.RedirectUrl.length?window.location=t.RedirectUrl:(alert(t.Html),$(solrSearchSaveModel).closest(".reveal-modal").removeClass("open"),$("body").removeClass("on-canvas"))},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})};function buildSaveSearchUiEvent(){var t=$(".lnkSaveSolrSearch"),n=$(".solrSearchSaveModel"),e=$(".btnSolrSearchSave"),i=$(".txtSolrSearchName");t.off("click").on("click",function(){var t=$(this).data("userloggedin");if(t&&"false"===t.toLowerCase()){var e=$("#hdnSearchSaveRedirectUrl");e&&""!==e||(e="/sign-in");var i=window.location.href;window.location=e.val()+"?returnUrl="+encodeURIComponent(i+"#triggerSaveSearch=1")}else openSaveSolrSearch(n)}),e.off("click").on("click",function(){saveSolrSearchInfo(n)}),i.off("keypress").on("keypress",function(t){13===(t.keyCode||t.which)&&saveSolrSearchInfo(n)})}function restrictedImagesSearch(){$("div.sri-figure[restricted]").each(function(){$(this).off("contextmenu").on("contextmenu",function(){return!1})})}function toggleBoundingCoordMessage(){var t=location.search.substring(1),e=SCM.Common.getQueryStringValue(t,"exPrm_fq");(!e||e.length<1)&&$(".sr-map-results-text").addClass("hide")}function updateMapResultsButtons(){0<window.location.pathname.indexOf("map-results")&&($("#btnViewResultsInSearch").removeClass("hide"),$("#btnViewResultsInMapResults").addClass("hide"))}function bindUiEvents(){var t=$(".microsite-search-icon"),e=$(".microsite-search-term"),i=$(".master-header").find(".mobile-microsite-search-icon"),n=$(".master-header").find(".mobile-microsite-search-term"),o=$(".toolbar-search").find(".microsite-search-icon"),a=$(".toolbar-search").find(".microsite-search-term"),s=$("#UmbrellaSearchIcon"),r=$("#UmbrellaHomeSearchIcon"),l=$("#UmbrellaSearchTerm"),c=$("#UmbrellaHomeSearchTerm"),d=$(".kwd-part"),u=$("#hfQuickSearchUrl"),h=$("#navbar-search-filter-mobile"),p=$("#navbar-search-filter-site");s.on("click",function(){testSearchInput(l.val())}),r.on("click",function(){testSearchInput(c.val())}),t.on("click",function(){testSearchInput(e.val())}),i.on("click",function(){testSearchInput(n.val())}),o.on("click",function(){testSearchInput(a.val())}),$(".searchLi .icon-search").on("click",function(){testSearchInput(e.val())}),d.on("click",function(){testSearchInput($(this).attr("data-keyword"))}),l.on("keypress",function(t){testKeypress(t,l.val())}),c.on("keypress",function(t){testKeypress(t,c.val())}),e.on("keypress",function(t){testKeypress(t,e.val())}),n.on("keypress",function(t){testKeypress(t,n.val())}),a.on("keypress",function(t){testKeypress(t,a.val())}),h.on("change",function(t){u.val($(this).val()),p.prop("selectedIndex")!==$(this).prop("selectedIndex")&&p.prop("selectedIndex",$(this).prop("selectedIndex"))}),p.on("change",function(t){u.val($(this).val()),h.prop("selectedIndex")!==$(this).prop("selectedIndex")&&h.prop("selectedIndex",$(this).prop("selectedIndex"))}),$(".master-main").on("click",".js-show-book-abstract-link",function(){$(this).parent().parent().find(".js-abstract-response-placeholder").toggleClass("hide")})}function bindViewAllImages(){$(".js-view-all-figures").off("click").on("click",function(){$(this).closest(".js-figures").find(".js-figures-rows").slideToggle().find("img.lazy").trigger("appear")})}function UserTrackingGeoRef(t,e,i,n,o,a,s,r,l){this.SourceType=t,this.ResourceTypeId=e,this.ClientActionType=i,this.ClientActionData=n,this.ActionUrl=o,this.SearchSourceType=a,this.SearchData=s,this.IsTurnaway=r,this.SearchSource=l}function sendTrackingDataGeoRef(t,e,i,n,o,a,s,r,l){var c=new UserTrackingGeoRef(t,e,i,n,o,a,s,r,l).toJson();$.ajax({type:"POST",url:"/Services/UserActionService.svc/TrackUserActionGeoRef",data:c,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,processData:!0})}$("body").on("click","#btnViewResultsInMapResults",function(){var t=location.search.substring(1);""!==SCM.SearchResults.defaults.baseSiteUrl&&(location.href="//"+baseSiteURL.val()+"/map-results?"+t)}),$("body").on("click","#btnViewResultsInSearch",function(){var t=location.search.substring(1),e=SCM.Common.getQueryStringValue(t,"boundCoordSearch");if(e==undefined||e.length<1){var i=SCM.Common.getQueryStringValue(t,"exPrm_fq");i!=undefined&&i.length&&(t=t.replace("&exPrm_fq="+i,""));var n=SCM.Common.getQueryStringValue(t,"exPrm_pt");n!=undefined&&n.length&&(t=t.replace("&exPrm_pt="+n,""))}""!==SCM.SearchResults.defaults.baseSiteUrl&&(location.href="//"+baseSiteURL.val()+"/search-results?"+t)}),$("body").on("click",".taxonomy-label",function(){var t=$("#TaxonomyCurrentDataUrl").val();if(t=decodeURIComponent(t),""!==$(this).attr("data-parentid")){var e=$(".taxonomy-node").attr("data-id"),i=$(this).parent(".taxonomy-label-wrap").attr("data-id"),n=t.indexOf("tax");if(-1!==n){var o=t.substring(n);if(null!==o&&""!==o)if(-1<o.indexOf("="+e))t=t.replace(o,"tax="+i);else if(-1===$.inArray(i,decodeURIComponent(o.slice(4)).split(","))){var a="tax="+i;t=t.replace(o,a)}}else t+="&tax="+i;SCM.SearchResults.doSolrSearch({queryString:t,source:"searchresults"})}}),UserTrackingGeoRef.prototype.toJson=function(){return JSON.stringify(this)},$("body").on("click","a",function(t){if(/\/(search-results|georef\/term\/(.*))$/i.test(location.pathname)){if(null!=this.href){/\/georef\/record\/(.*)/.test(this.href)&&sendTrackingDataGeoRef(2001,1665,"0","",this.href,"","",!1,location.pathname)}return!0}}),SolrSearch.init=function(){bindUiEvents(),bindViewAllImages(),buildSaveSearchUiEvent(),initDateRangeToggle(),restrictedImagesSearch(),toggleBoundingCoordMessage(),$("main").on("click",".collapsible-facet .sf-group-header",function(){if($(window).outerWidth()<1024){var t=$(this),e=t.children(".sf-group-header-icon");t.siblings("fieldset").children(".sf-facets, .sf-facet-list").slideToggle(),t.siblings(".taxonomy-node").slideToggle(),e.hasClass("icon-general_arrow-right")?e.removeClass("icon-general_arrow-right").addClass("icon-general_arrow-down"):e.removeClass("icon-general_arrow-down").addClass("icon-general_arrow-right")}}),SCM.QueryBuilder.configure(),0<$(SCM.SearchResults.defaults.updateTargetSelector).length?SCM.QueryBuilder.defaults.runSearch=function(t){SCM.SearchResults.doSolrSearch({queryString:t,source:"searchresults"})}:($(".querybuilder-submit").attr("value","Search"),$(".querybuilder-title").text("Modify your search"),SCM.QueryBuilder.defaults.runSearch=function(t){var e=$("#hfSiteURL").val();-1===t.indexOf("q=")&&(t="q="+t),window.location=window.location.protocol+"//"+e+"/search-results?"+t}),$(".sort-dropdown-option:selected").addClass("selected"),bodyVar.on("click",".sriTopiclink",function(t){doSolrSearch((queryText=$(this).text()).replace(",","")),t.preventDefault()}),bodyVar.on("click","#topicResultsWire",function(t){var e=location.search;e=e.substring(0,e.indexOf("&fd_JournalID")),window.location.href="solr/topicresults.aspx"+e})},SolrSearch.ajaxComplete=function(){bindViewAllImages(),buildSaveSearchUiEvent(),initDateRangeToggle(),restrictedImagesSearch(),SCM.QueryBuilder.configure(),updateMapResultsButtons(),toggleBoundingCoordMessage()},SCM.SearchResults.defaults.instanceName="Site_Theme_SearchResults",$(".pg_map-results").length?SCM.SearchResults.defaults.updateTargetSelector="#searchResultsPage":SCM.SearchResults.defaults.updateTargetSelector=".content-main_content",SCM.SolrSearch.init()}(SCM.SolrSearch=SCM.SolrSearch||{},jQuery);var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},SCM.AddReturnUrlToSocietyLinks=function(){var t=encodeURIComponent(window.location.href);$(".society-links-logo, .society-links-url").each(function(){"undefined"!=typeof placeholderReturnUrlValue&&0<placeholderReturnUrlValue.length&&$(this).attr("href",$(this).attr("href").replace(placeholderReturnUrlValue,t))})};var App=App||{};!function(ns,$,undefined){ns.callSlideToggle=function(t,e){var i=$(t),n=$(e);i.on("click",function(){n.slideToggle()})},ns.loginInstitutionalUser=function(){var instLoginForm=$(".inst-login-form");$.ajax({type:"POST",url:"/SignIn/LoginInstitutionalUser",data:{username:instLoginForm.find("input.username").val(),password:instLoginForm.find("input.password").val()},success:function(t){if(0<t.length)instLoginForm.find(".error").removeClass("hide");else{var e=$.deparam.querystring().returnUrl;e?window.location.assign(decodeURIComponent(e)):window.location.reload()}},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})},ns.loginInstitutionalUserClick=function(){$(".inst-login-form").find(".signin-button").click(function(){ns.loginInstitutionalUser()}),$(".inst-login-form").on("keypress",function(t){13==t.which&&ns.loginInstitutionalUser()})},$(document).ready(function(){ns.init()}),ns.init=function(){ns.loginInstitutionalUserClick(),ns.callSlideToggle(".pub-history__label",".pub-history__wrap")}}(App.CustomScript=App.CustomScript||{},jQuery);var App=App||{};function initializeBound(){if(null!=SCM.BoundingCoordinates.zoomLevel){var n,t={zoom:SCM.BoundingCoordinates.zoomLevel,center:new google.maps.LatLng(SCM.BoundingCoordinates.defaultLatValue,SCM.BoundingCoordinates.defaultLonValue),mapTypeId:SCM.BoundingCoordinates.mapTypeId,zoomControl:SCM.BoundingCoordinates.zoomControl,mapTypeControl:SCM.BoundingCoordinates.mapTypeControl,streetViewControl:!1,mapTypeControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},panControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},ZoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_LEFT}},e=new google.maps.Map(document.getElementById("google-bounding-map-canvas"),t),i=$(".bounding-coordinates"),o=$("#"+SCM.BoundingCoordinates.boundCordNorth),a=$("#"+SCM.BoundingCoordinates.boundCordEast),s=$("#"+SCM.BoundingCoordinates.boundCordSouth),r=$("#"+SCM.BoundingCoordinates.boundCordWest);o.val(""),a.val(""),s.val(""),r.val("");var l=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.RECTANGLE,drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.RECTANGLE]}});function c(t){n&&(n.setEditable(!1),n=null),(n=t).setEditable(!0)}function d(){if(n){var t=new google.maps.LatLng(o.val(),a.val()),e=new google.maps.LatLng(s.val(),r.val()),i=new google.maps.LatLngBounds(e,t);n.setBounds(i)}}l.setMap(e),function(){for(var t=0;t<i.length;t++)i[t].addEventListener("keyup",function(t){d()},!1)}(),u=l,google.maps.event.addListener(u,"overlaycomplete",function(t){if(t.type!=google.maps.drawing.OverlayType.MARKER){var e=t.overlay;e.type=t.type,n&&n.setMap(null),c(e),function(t){var e=t.getNorthEast(),i=t.getSouthWest();o.val(e.lat()),a.val(e.lng()),s.val(i.lat()),r.val(i.lng())}(e.getBounds())}})}var u}!function(t,e){function i(){e(".thesaurus-term__view-all").on("click",function(){!function(t){e.ajax({url:(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/GSW/GeoRefThesaurusTermViewAll/ThesaurusTermViewAllPopup",cache:!1,data:{gbosId:t.data("gbosid"),gbosContainerId:t.data("gboscontainerid")},dataType:"html",success:function(t){e(".geoRefTermViewAll").html(t).promise().done(function(){e(".geoRefTermViewAllModal").addClass("open"),e("body").addClass("on-canvas")})}})}(e(this))})}t.init=function(){i()}}(App.ThesaurusTermJS=App.ThesaurusTermJS||{},jQuery),jQuery(document).ready(function(){App.ThesaurusTermJS.init()});var SCM=SCM||{};!function(t){t.loadBoundCoordScript=function(){initializeBound()}}(SCM.BoundingCoordinates=SCM.BoundingCoordinates||{},jQuery);var App=App||{};!function(t,o){t.setSOLRDefaults=function(){o(".pg_SearchResults").length&&(SCM.SearchResults.defaults={controller:"Solr",action:"SolrSearch",instanceName:"SearchResults",updateTargetSelector:".content-main_content",onHashChange:function(t){}})},t.toggleRelatedContentWidget=function(t,i){console.log();var n="View More";o(t).on("click",function(){var t=o(this),e=t.parent().siblings(i);"View More"===n?t.html("View Less"):t.html("View More"),e.slideToggle(),n=t.html()})},t.launchGetCitationModal=function(){o('[data-reveal-id="getCitation"]').on("click",function(t){t.preventDefault();o(this).attr("reveal-id");var e="#getCitation.reveal-modal";o(e).length&&(o(e).addClass("open"),o("body.pg_Article").length&&o("body").addClass("on-canvas"))})},t.toolbarDropdowns=function(){o(".drop-trigger").on("click",function(t){o(this);var e=o(this).next(".f-dropdown");t.stopPropagation(),o(".f-dropdown").not(e).css("display","none"),o(".toolbar-search").removeClass("expanded"),e.slideToggle("fast",function(){o(this).is(":visible")&&o(this).css("display","flex")}),o(document.body).on("click",function(t){o(e).css("display","none")})})},t.mobileContentNav=function(){o(".toggle-left-col").on("click",function(t){t.stopPropagation(),o("body").addClass("on-canvas"),o(".page-column--left").addClass("expanded")}),o(".toggle-left-col__close, .info-widget-wrap a, .mobile-mask").on("click",function(){o(".page-column--left").removeClass("expanded"),o("body").removeClass("on-canvas")})},t.siteMenuDropdown=function(){o(".js-nav-link").on("click",function(t){o(this);var e=o(this).next(".site-menu");t.stopPropagation(),o(".site-menu-item .site-menu").not(e).css("display","none"),e.slideToggle("fast",function(){o(this).is(":visible")&&o(this).css("display","block")}),o(document.body).on("click",function(t){o(e).css("display","none")})}),o(".js-toolbar-search-trigger").on("click",function(){o(".toolbar-search").toggleClass("expanded")})},t.stickySidebar=function(){if(o(".info-inner-wrap").length){o(".page-column--left").height(),o(".info-inner-wrap").height(),o(".page-column--left").offset().top;o(window).scroll(function(){if(899<o(window).width()){var t=o(this).scrollTop();o(".info-inner-wrap").height();t<o(".page-column--left").offset().top-65?(o(".info-inner-wrap").removeClass("menu-stuck").addClass("menu-not-stuck"),o(".toolbar-wrap").length&&(o(".toolbar-wrap").removeClass("toolbar-stuck"),o(".site-theme-header").find(".navbar-search-container").removeClass("hide"))):(o(".info-inner-wrap").removeClass("menu-not-stuck").addClass("menu-stuck"),o(".toolbar-wrap").length&&(o(".toolbar-wrap").addClass("toolbar-stuck"),o(".site-theme-header").find(".navbar-search-container").addClass("hide")))}else o(".info-inner-wrap").removeClass("menu-not-stuck").removeClass("menu-stuck")});var t=o(".info-inner-wrap").height();o(".content-main").height()<t&&(o(".info-inner-wrap").addClass("im-too-tall"),o(".page-column-wrap").css("min-height","1000px"))}},t.unStickSidebar=function(){899<o(window).width()&&(o.fn.is_on_screen=function(){var t=o(window),e={top:t.scrollTop(),left:t.scrollLeft()};e.right=e.left+t.width(),e.bottom=e.top+t.height();var i=this.offset();return i.right=i.left+this.outerWidth(),i.bottom=i.top+this.outerHeight(),!(e.right<i.left||e.left>i.right||e.bottom<i.top||e.top>i.bottom)},o(window).scroll(function(){var t=o(".info-inner-wrap").height(),e=o(".footer_wrap").offset().top-65-o(window).scrollTop();0<o(".footer_wrap").length&&(o(".footer_wrap").is_on_screen()?(o("body.pg_map-results, body.pg_thesaurus-terms").length&&o(".info-inner-wrap").addClass("hide"),e<t&&o(".info-inner-wrap").addClass("menu-bottomed-out"),t<e&&o(".info-inner-wrap").removeClass("menu-bottomed-out")):(o(".info-inner-wrap").removeClass("menu-bottomed-out"),o("body.pg_map-results, body.pg_thesaurus-terms").length&&o(".info-inner-wrap").removeClass("hide")))}))},t.scrollHighlight=function(){o(window).on("scroll",function(){var n=o(this).scrollTop();o(".articleClientType").each(function(){var t=o(this).offset().top,e=o(this).attr("id"),i=o('.section-jump-link__link-wrap a[href="#'+e+'"]');t-80<n&&(o(i).length&&o(".list-issue-jumplinks li").removeClass("active"),o(i).closest(".section-jump-link").addClass("active"))}),o(".article-body").length&&o("h2").each(function(){var t=o(this).offset().top,e=o(this).attr("id"),i=o('.section-jump-link__link-wrap a[href="#'+e+'"]');t-80<n&&(o(i).length&&o(".jumplink-list li").removeClass("active"),o(i).closest(".section-jump-link").addClass("active"))})})},t.contentModals=function(){o(".table-modal").addClass("reveal-modal"),o(".pg_ArticleSplitView, .pg_articlesplitview").length||o("a[reveal-id]").each(function(){if(o(this).hasClass("xref-bibr")&&(o(this).on("click",function(){var t=o(this).attr("reveal-id"),e=o('.ref > div[role="'+t.toLowerCase()+'"]'),i=o(e).html();o("body").addClass("on-canvas"),o(i).clone().appendTo("#revealModal #revealContent").addClass("ref-modal"),o(".ref-modal").closest(".reveal-modal").addClass("open")}),o(".close-reveal-modal").on("click",function(t){o(this).closest(".reveal-modal").removeClass("open"),o(".ref-modal").html("").removeClass("ref-modal"),o("body").removeClass("on-canvas")})),o(this).hasClass("xref-fn"))o(this).on("click",function(){var t=o(this).attr("reveal-id"),e=o('.fn[content-id="'+t+'"]'),i=o(e).html();o("body").addClass("on-canvas"),o(i).clone().appendTo("#revealModal #revealContent").addClass("ref-modal"),o(".ref-modal").closest(".reveal-modal").addClass("open")}),o(".close-reveal-modal").on("click",function(t){o(this).closest(".reveal-modal").removeClass("open"),o(".ref-modal").html("").removeClass("ref-modal"),o("body").removeClass("on-canvas")});else{var t=o(this).attr("reveal-id"),e=o('.reveal-modal[content-id="'+t+'"]');o(this).on("click",function(t){o(e).length&&(t.stopPropagation(),o("body").addClass("on-canvas"),o(e).addClass("open"))})}})},t.init=function(){t.siteMenuDropdown(),t.mobileContentNav(),t.stickySidebar(),t.unStickSidebar(),t.scrollHighlight(),t.toolbarDropdowns(),t.toggleRelatedContentWidget(".related-content__view-more",".related-content__hidden-wrap")},t.windowLoadInit=function(){t.contentModals(),t.launchGetCitationModal()},t.ajaxCompleteInit=function(){t.stickySidebar(),t.unStickSidebar()}}(App.SiteJS=App.SiteJS||{},jQuery),function(t){t(document).ready(function(){App.SiteJS.init(),!0===t("body").hasClass("pg_ArticleSplitView")&&SCM.SplitScreen.init()}),t(window).on("load",function(){App.SiteJS.windowLoadInit()}),t(window).on("resize",function(){}),t(document).ajaxComplete(function(t,e,i){App.SiteJS.ajaxCompleteInit()})}(jQuery);var SCM=SCM||{};!function(c,n){var o="";c.getGdprCookie=function(t){for(var e=t+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){var o=i[n].trim();if(0===o.indexOf(e))return o.substring(e.length,o.length)}return""},c.createGdprCookie=function(t,e,i){var n,o=c.getCookieName();if(i){var a=new Date;a.setTime(a.getTime()+24*i*60*60*1e3),n="; expires="+a.toGMTString()}else n="";var s=o+"="+encodeURIComponent(e)+n+"; samesite=lax; secure; path=/",r=c.getCookieDomain(),l=null;r&&(document.cookie=s+";domain="+r,l=c.getGdprCookie(o)),r&&l||(document.cookie=s)},c.getCookieName=function(){if(o)return o;var t=n("#hdnClientIdGdpr").val(),e=c.getCookieDomain(),i="GDPR_";return t&&(i=i+t+"_"),e&&(i+=e),i},c.getCookieDomain=function(){return n("#hdnDomainGdpr").val()},c.hideGdprBanner=function(){var t=n(".gdpr-cookie-wrapper");if(navigator.cookieEnabled){var e=c.getCookieName();c.getGdprCookie(e)&&t.hide()}else t.hide()},c.gdprAcceptLinkClick=function(){n(".js-gdpr-cookie-acceptLink, .js-gdpr-cookie-close").on("click",function(t){c.createGdprCookie("GDPR_",!0,365),c.hideGdprBanner(),SCM.ClientStatsMaster&&SCM.ClientStatsMaster.trackGdprCookieAcceptance&&SCM.ClientStatsMaster.trackGdprCookieAcceptance("1050","0","Cookie Acceptance")})},c.init=function(t){t&&(o=t),n(".gdpr-cookie-wrapper").show(),c.gdprAcceptLinkClick(),c.hideGdprBanner()}}(SCM.gdprCookieBanner=SCM.gdprCookieBanner||{},jQuery),function(r,g,b){var t,n,o,e,C={version:"1.0.3+ed36a04"};function i(){}function a(t){return r["webkit"+t]||r["moz"+t]||r["ms"+t]}function s(t){var e=+new Date,i=Math.max(0,16-(e-n));return n=e+i,r.setTimeout(t,i)}"object"==typeof module&&"object"==typeof module.exports?module.exports=C:"function"==typeof define&&define.amd&&define(C),void 0!==r&&(t=r.L,C.noConflict=function(){return r.L=t,this},r.L=C),C.Util={extend:function(t){var e,i,n,o;for(i=1,n=arguments.length;i<n;i++)for(e in o=arguments[i])t[e]=o[e];return t},create:Object.create||function(t){return i.prototype=t,new i},bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++C.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,a,s;return s=function(){n=!1,o&&(a.apply(i,o),o=!1)},a=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],a=n-o;return t===n&&i?t:((t-o)%a+a)%a+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return C.Util.trim(t).split(/\s+/)},setOptions:function(t,e){for(var i in t.hasOwnProperty("options")||(t.options=t.options?C.Util.create(t.options):{}),e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,n){return t.replace(C.Util.templateRe,function(t,e){var i=n[e];if(i===b)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(n)),i})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},n=0,o=r.requestAnimationFrame||a("RequestAnimationFrame")||s,e=r.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(t){r.clearTimeout(t)},C.Util.requestAnimFrame=function(t,e,i){if(!i||o!==s)return o.call(r,C.bind(t,e));t.call(e)},C.Util.cancelAnimFrame=function(t){t&&e.call(r,t)},C.extend=C.Util.extend,C.bind=C.Util.bind,C.stamp=C.Util.stamp,C.setOptions=C.Util.setOptions,C.Class=function(){},C.Class.extend=function(t){function e(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var i=e.__super__=this.prototype,n=C.Util.create(i);for(var o in(n.constructor=e).prototype=n,this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);return t.statics&&(C.extend(e,t.statics),delete t.statics),t.includes&&(C.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=C.Util.extend(C.Util.create(n.options),t.options)),C.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;t<e;t++)n._initHooks[t].call(this)}},e},C.Class.include=function(t){return C.extend(this.prototype,t),this},C.Class.mergeOptions=function(t){return C.extend(this.prototype.options,t),this},C.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this},C.Evented=C.Class.extend({on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var o=0,a=(t=C.Util.splitWords(t)).length;o<a;o++)this._on(t[o],e,i);return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else for(var o=0,a=(t=C.Util.splitWords(t)).length;o<a;o++)this._off(t[o],e,i);else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=b);for(var o={fn:e,ctx:i},a=n,s=0,r=a.length;s<r;s++)if(a[s].fn===e&&a[s].ctx===i)return;a.push(o)},_off:function(t,e,i){var n,o,a;if(this._events&&(n=this._events[t]))if(e){if(i===this&&(i=b),n)for(o=0,a=n.length;o<a;o++){var s=n[o];if(s.ctx===i&&s.fn===e)return s.fn=C.Util.falseFn,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(o,1)}}else{for(o=0,a=n.length;o<a;o++)n[o].fn=C.Util.falseFn;delete this._events[t]}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=C.Util.extend({},e,{type:t,target:this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var a=0,s=o.length;a<s;a++){var r=o[a];r.fn.call(r.ctx||this,n)}this._firingCount--}}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var o=C.bind(function(){this.off(t,e,i).off(t,o,i)},this);return this.on(t,e,i).on(t,o,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[C.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[C.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,C.extend({layer:t.target},t),!0)}});var l,c,d,u,h,p,f,m,v,_,y,w,S,k,x,L,M,D,T,P=C.Evented.prototype;P.addEventListener=P.on,P.removeEventListener=P.clearAllEventListeners=P.off,P.addOneTimeEventListener=P.once,P.fireEvent=P.fire,P.hasEventListeners=P.listens,C.Mixin={Events:P},l=navigator.userAgent.toLowerCase(),c=g.documentElement,d="ActiveXObject"in r,u=-1!==l.indexOf("webkit"),h=-1!==l.indexOf("phantom"),p=-1!==l.search("android [23]"),f=-1!==l.indexOf("chrome"),m=-1!==l.indexOf("gecko")&&!u&&!r.opera&&!d,v=0===navigator.platform.indexOf("Win"),_="undefined"!=typeof orientation||-1!==l.indexOf("mobile"),y=!r.PointerEvent&&r.MSPointerEvent,w=r.PointerEvent||y,S=d&&"transition"in c.style,k="WebKitCSSMatrix"in r&&"m11"in new r.WebKitCSSMatrix&&!p,x="MozPerspective"in c.style,L="OTransition"in c.style,M=!r.L_NO_TOUCH&&(w||"ontouchstart"in r||r.DocumentTouch&&g instanceof r.DocumentTouch),C.Browser={ie:d,ielt9:d&&!g.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in g),webkit:u,gecko:m,android:-1!==l.indexOf("android"),android23:p,chrome:f,safari:!f&&-1!==l.indexOf("safari"),win:v,ie3d:S,webkit3d:k,gecko3d:x,opera12:L,any3d:!r.L_DISABLE_3D&&(S||k||x)&&!L&&!h,mobile:_,mobileWebkit:_&&u,mobileWebkit3d:_&&k,mobileOpera:_&&r.opera,mobileGecko:_&&m,touch:!!M,msPointer:!!y,pointer:!!w,retina:1<(r.devicePixelRatio||r.screen.deviceXDPI/r.screen.logicalXDPI)},C.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},C.Point.prototype={clone:function(){return new C.Point(this.x,this.y)},add:function(t){return this.clone()._add(C.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(C.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new C.Point(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new C.Point(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){var e=(t=C.point(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=C.point(t)).x===this.x&&t.y===this.y},contains:function(t){return t=C.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+C.Util.formatNum(this.x)+", "+C.Util.formatNum(this.y)+")"}},C.point=function(t,e,i){return t instanceof C.Point?t:C.Util.isArray(t)?new C.Point(t[0],t[1]):t===b||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new C.Point(t.x,t.y):new C.Point(t,e,i)},C.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},C.Bounds.prototype={extend:function(t){return t=C.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new C.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new C.Point(this.min.x,this.max.y)},getTopRight:function(){return new C.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof C.Point?C.point(t):C.bounds(t))instanceof C.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=C.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,a=o.x>=e.x&&n.x<=i.x,s=o.y>=e.y&&n.y<=i.y;return a&&s},overlaps:function(t){t=C.bounds(t);var e=this.min,i=this.max,n=t.min,o=t.max,a=o.x>e.x&&n.x<i.x,s=o.y>e.y&&n.y<i.y;return a&&s},isValid:function(){return!(!this.min||!this.max)}},C.bounds=function(t,e){return!t||t instanceof C.Bounds?t:new C.Bounds(t,e)},C.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},C.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new C.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},C.DomUtil={get:function(t){return"string"==typeof t?g.getElementById(t):t},getStyle:function(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&g.defaultView){var n=g.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i},create:function(t,e,i){var n=g.createElement(t);return n.className=e||"",i&&i.appendChild(n),n},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(t.classList!==b)return t.classList.contains(e);var i=C.DomUtil.getClass(t);return 0<i.length&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){if(t.classList!==b)for(var i=C.Util.splitWords(e),n=0,o=i.length;n<o;n++)t.classList.add(i[n]);else if(!C.DomUtil.hasClass(t,e)){var a=C.DomUtil.getClass(t);C.DomUtil.setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==b?t.classList.remove(e):C.DomUtil.setClass(t,C.Util.trim((" "+C.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){t.className.baseVal===b?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===b?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&C.DomUtil._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"},testProp:function(t){for(var e=g.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},setTransform:function(t,e,i){var n=e||new C.Point(0,0);t.style[C.DomUtil.TRANSFORM]=(C.Browser.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")},setPosition:function(t,e){t._leaflet_pos=e,C.Browser.any3d?C.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos||new C.Point(0,0)}},function(){C.DomUtil.TRANSFORM=C.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var t=C.DomUtil.TRANSITION=C.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(C.DomUtil.TRANSITION_END="webkitTransition"===t||"OTransition"===t?t+"End":"transitionend","onselectstart"in g)C.DomUtil.disableTextSelection=function(){C.DomEvent.on(r,"selectstart",C.DomEvent.preventDefault)},C.DomUtil.enableTextSelection=function(){C.DomEvent.off(r,"selectstart",C.DomEvent.preventDefault)};else{var e=C.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);C.DomUtil.disableTextSelection=function(){if(e){var t=g.documentElement.style;this._userSelect=t[e],t[e]="none"}},C.DomUtil.enableTextSelection=function(){e&&(g.documentElement.style[e]=this._userSelect,delete this._userSelect)}}C.DomUtil.disableImageDrag=function(){C.DomEvent.on(r,"dragstart",C.DomEvent.preventDefault)},C.DomUtil.enableImageDrag=function(){C.DomEvent.off(r,"dragstart",C.DomEvent.preventDefault)},C.DomUtil.preventOutline=function(t){for(;-1===t.tabIndex;)t=t.parentNode;t&&t.style&&(C.DomUtil.restoreOutline(),this._outlineElement=t,this._outlineStyle=t.style.outline,t.style.outline="none",C.DomEvent.on(r,"keydown",C.DomUtil.restoreOutline,this))},C.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,C.DomEvent.off(r,"keydown",C.DomUtil.restoreOutline,this))}}(),C.LatLng=function(t,e,i){if(isNaN(t)&&(t=0),isNaN(e)&&(e=0),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,i!==b&&(this.alt=+i)},C.LatLng.prototype={equals:function(t,e){return!!t&&(t=C.latLng(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(e===b?1e-9:e))},toString:function(t){return"LatLng("+C.Util.formatNum(this.lat,t)+", "+C.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return C.CRS.Earth.distance(this,C.latLng(t))},wrap:function(){return C.CRS.Earth.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return C.latLngBounds([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new C.LatLng(this.lat,this.lng,this.alt)}},C.latLng=function(t,e,i){return t instanceof C.LatLng?t:C.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new C.LatLng(t[0],t[1],t[2]):2===t.length?new C.LatLng(t[0],t[1]):null:t===b||null===t?t:"object"==typeof t&&"lat"in t?new C.LatLng(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===b?null:new C.LatLng(t,e,i)},C.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},C.LatLngBounds.prototype={extend:function(t){var e,i,n=this._southWest,o=this._northEast;if(t instanceof C.LatLng)i=e=t;else{if(!(t instanceof C.LatLngBounds))return t?this.extend(C.latLng(t)||C.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||o?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),o.lat=Math.max(i.lat,o.lat),o.lng=Math.max(i.lng,o.lng)):(this._southWest=new C.LatLng(e.lat,e.lng),this._northEast=new C.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,o=Math.abs(e.lng-i.lng)*t;return new C.LatLngBounds(new C.LatLng(e.lat-n,e.lng-o),new C.LatLng(i.lat+n,i.lng+o))},getCenter:function(){return new C.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getCenterForSolr:function(){return((this._southWest.lat+this._northEast.lat)/2).toString()+","+((this._southWest.lng+this._northEast.lng)/2).toString()},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new C.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new C.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof C.LatLng||"lat"in t?C.latLng(t):C.latLngBounds(t);var e,i,n=this._southWest,o=this._northEast;return t instanceof C.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=o.lat&&e.lng>=n.lng&&i.lng<=o.lng},intersects:function(t){t=C.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),a=o.lat>=e.lat&&n.lat<=i.lat,s=o.lng>=e.lng&&n.lng<=i.lng;return a&&s},overlaps:function(t){t=C.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),o=t.getNorthEast(),a=o.lat>e.lat&&n.lat<i.lat,s=o.lng>e.lng&&n.lng<i.lng;return a&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=C.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},C.latLngBounds=function(t,e){return t instanceof C.LatLngBounds?t:new C.LatLngBounds(t,e)},C.Projection={},C.Projection.LonLat={project:function(t){return new C.Point(t.lng,t.lat)},unproject:function(t){return new C.LatLng(t.y,t.x)},bounds:C.bounds([-180,-90],[180,90])},C.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),o=Math.sin(n*e);return new C.Point(this.R*t.lng*e,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var e=180/Math.PI;return new C.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(D=6378137*Math.PI,C.bounds([-D,-D],[D,D]))},C.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),n=this.transformation.transform(e.min,i),o=this.transformation.transform(e.max,i);return C.bounds(n,o)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?C.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?C.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat,n=t.alt;return C.latLng(i,e,n)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,o=e.lng-i.lng;if(0==n&&0==o)return t;var a=t.getSouthWest(),s=t.getNorthEast(),r=C.latLng({lat:a.lat-n,lng:a.lng-o}),l=C.latLng({lat:s.lat-n,lng:s.lng-o});return new C.LatLngBounds(r,l)}},C.CRS.Simple=C.extend({},C.CRS,{projection:C.Projection.LonLat,transformation:new C.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),C.CRS.Earth=C.extend({},C.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,a=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return this.R*Math.acos(Math.min(a,1))}}),C.CRS.EPSG3857=C.extend({},C.CRS.Earth,{code:"EPSG:3857",projection:C.Projection.SphericalMercator,transformation:(T=.5/(Math.PI*C.Projection.SphericalMercator.R),new C.Transformation(T,.5,-T,.5))}),C.CRS.EPSG900913=C.extend({},C.CRS.EPSG3857,{code:"EPSG:900913"}),C.CRS.EPSG4326=C.extend({},C.CRS.Earth,{code:"EPSG:4326",projection:C.Projection.LonLat,transformation:new C.Transformation(1/180,1,-1/180,.5)}),C.Map=C.Evented.extend({options:{crs:C.CRS.EPSG3857,center:b,zoom:b,minZoom:b,maxZoom:b,layers:[],maxBounds:b,renderer:b,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=C.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=C.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==b&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==b&&this.setView(C.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=C.DomUtil.TRANSITION&&C.Browser.any3d&&!C.Browser.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),C.DomEvent.on(this._proxy,C.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){if((e=e===b?this._zoom:this._limitZoom(e),t=this._limitCenter(C.latLng(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i)&&(i.animate!==b&&(i.zoom=C.extend({animate:i.animate},i.zoom),i.pan=C.extend({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(C.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(C.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),o=this.getSize().divideBy(2),a=(t instanceof C.Point?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/n),s=this.containerPointToLatLng(o.add(a));return this.setView(s,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():C.latLngBounds(t);var i=C.point(e.paddingTopLeft||e.padding||[0,0]),n=C.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,i.add(n));o="number"==typeof e.maxZoom?Math.min(e.maxZoom,o):o;var a=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),o),r=this.project(t.getNorthEast(),o);return{center:this.unproject(s.add(r).divideBy(2).add(a),o),zoom:o}},fitBounds:function(t,e){if(!(t=C.latLngBounds(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=C.point(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new C.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){C.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(n,o,t){if(!1===(t=t||{}).animate||!C.Browser.any3d)return this.setView(n,o,t);this._stop();var a=this.project(this.getCenter()),s=this.project(n),e=this.getSize(),r=this._zoom;n=C.latLng(n),o=o===b?r:o;var l=Math.max(e.x,e.y),c=l*this.getZoomScale(r,o),d=s.distanceTo(a)||1,u=1.42,h=u*u;function i(t){var e=(c*c-l*l+(t?-1:1)*h*h*d*d)/(2*(t?c:l)*h*d),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function p(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}var m=i(0);function g(t){return l*(f(m)*function(t){return p(t)/f(t)}(m+u*t)-p(m))/h}var v=Date.now(),_=(i(1)-m)/u,y=t.duration?1e3*t.duration:1e3*_*.8;return this._moveStart(!0),function t(){var e=(Date.now()-v)/y,i=function(t){return 1-Math.pow(1-t,1.5)}(e)*_;e<=1?(this._flyToFrame=C.Util.requestAnimFrame(t,this),this._move(this.unproject(a.add(s.subtract(a).multiplyBy(g(i)/d)),r),this.getScaleZoom(l/function(t){return l*(f(m)/f(m+u*t))}(i),r),{flyTo:!0})):this._move(n,o)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return(t=C.latLngBounds(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,C.latLngBounds(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=C.extend({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),o=i.divideBy(2).round(),a=n.subtract(o);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(C.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=C.extend({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=C.bind(this._handleGeolocationResponse,this),i=C.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new C.LatLng(e,i),o=n.toBounds(t.coords.accuracy),a=this._locateOptions;if(a.setView){var s=this.getBoundsZoom(o);this.setView(n,a.maxZoom?Math.min(s,a.maxZoom):s)}var r={latlng:n,bounds:o,timestamp:t.timestamp};for(var l in t.coords)"number"==typeof t.coords[l]&&(r[l]=t.coords[l]);this.fire("locationfound",r)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=b,this._containerId=b}for(var t in C.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();return this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=C.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new C.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===b?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===b?this._layersMaxZoom===b?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=C.latLngBounds(t),i=C.point(i||[0,0]);var n=this.getZoom()||0,o=this.getMinZoom(),a=this.getMaxZoom(),s=t.getNorthWest(),r=t.getSouthEast(),l=this.getSize().subtract(i),c=C.bounds(this.project(r,n),this.project(s,n)).getSize(),d=C.Browser.any3d?this.options.zoomSnap:1,u=Math.min(l.x/c.x,l.y/c.y);return n=this.getScaleZoom(u,n),d&&(n=Math.round(n/(d/100))*(d/100),n=e?Math.ceil(n/d)*d:Math.floor(n/d)*d),Math.max(o,Math.min(a,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new C.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new C.Bounds(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===b?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=e===b?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=e===b?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=e===b?this._zoom:e,this.options.crs.latLngToPoint(C.latLng(t),e)},unproject:function(t,e){return e=e===b?this._zoom:e,this.options.crs.pointToLatLng(C.point(t),e)},layerPointToLatLng:function(t){var e=C.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(C.latLng(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(C.latLng(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(C.latLngBounds(t))},distance:function(t,e){return this.options.crs.distance(C.latLng(t),C.latLng(e))},containerPointToLayerPoint:function(t){return C.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return C.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(C.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(C.latLng(t)))},mouseEventToContainerPoint:function(t){return C.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=C.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");C.DomEvent.addListener(e,"scroll",this._onScroll,this),this._containerId=C.Util.stamp(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&C.Browser.any3d,C.DomUtil.addClass(t,"leaflet-container"+(C.Browser.touch?" leaflet-touch":"")+(C.Browser.retina?" leaflet-retina":"")+(C.Browser.ielt9?" leaflet-oldie":"")+(C.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=C.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),C.DomUtil.setPosition(this._mapPane,new C.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(C.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),C.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){C.DomUtil.setPosition(this._mapPane,new C.Point(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,i){e===b&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return C.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){C.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(C.DomEvent){this._targets={},this._targets[C.stamp(this._container)]=this;var e=t?"off":"on";C.DomEvent[e](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&C.DomEvent[e](r,"resize",this._onResize,this),C.Browser.any3d&&this.options.transform3DLimit&&this[e]("moveend",this._onMoveEnd)}},_onResize:function(){C.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=C.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],o="mouseout"===e||"mouseover"===e,a=t.target||t.srcElement,s=!1;a;){if((i=this._targets[C.stamp(a)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){s=!0;break}if(i&&i.listens(e,!0)){if(o&&!C.DomEvent._isExternalTarget(a,t))break;if(n.push(i),o)break}if(a===this._container)break;a=a.parentNode}return n.length||s||o||!C.DomEvent._isExternalTarget(a,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!C.DomEvent._skipped(t)){var e="keypress"===t.type&&13===t.keyCode?"click":t.type;"mousedown"===e&&C.DomUtil.preventOutline(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_fireDOMEvent:function(t,e,i){if("click"===t.type){var n=C.Util.extend({},t);n.type="preclick",this._fireDOMEvent(n,n.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e))).length){var o=i[0];"contextmenu"===e&&o.listens(e,!0)&&C.DomEvent.preventDefault(t);var a={originalEvent:t};if("keypress"!==t.type){var s=o instanceof C.Marker;a.containerPoint=s?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),a.layerPoint=this.containerPointToLayerPoint(a.containerPoint),a.latlng=s?o.getLatLng():this.layerPointToLatLng(a.layerPoint)}for(var r=0;r<i.length;r++)if(i[r].fire(e,a,!0),a.originalEvent._stopped||i[r].options.nonBubblingEvents&&-1!==C.Util.indexOf(i[r].options.nonBubblingEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return C.DomUtil.getPosition(this._mapPane)||new C.Point(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&e!==b?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return C.bounds([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),o=this.getSize().divideBy(2),a=new C.Bounds(n.subtract(o),n.add(o)),s=this._getBoundsOffset(a,i,e);return s.round().equals([0,0])?t:this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new C.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=C.bounds(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),o=n.min.subtract(t.min),a=n.max.subtract(t.max),s=this._rebound(o.x,-a.x),r=this._rebound(o.y,-a.y);return new C.Point(s,r)},_rebound:function(t,e){return 0<t+e?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=C.Browser.any3d?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){C.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)},_createAnimProxy:function(){var n=this._proxy=C.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(t){var e=C.DomUtil.TRANSFORM,i=n.style[e];C.DomUtil.setTransform(n,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===n.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),e=this.getZoom();C.DomUtil.setTransform(n,this.project(t,e),this.getZoomScale(e,1))},this)},_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(o))&&(C.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,i,n){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,C.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),setTimeout(C.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(C.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),C.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}),C.map=function(t,e){return new C.Map(t,e)},C.Layer=C.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[],attribution:null},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[C.stamp(t)]=this},removeInteractiveTarget:function(t){return delete this._map._targets[C.stamp(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}}),C.Map.include({addLayer:function(t){var e=C.stamp(t);return this._layers[e]||((this._layers[e]=t)._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=C.stamp(t);return this._layers[e]&&(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null),this},hasLayer:function(t){return!!t&&C.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?C.Util.isArray(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[C.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=C.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var o=this._zoomBoundLayers[n].options;t=o.minZoom===b?t:Math.min(t,o.minZoom),e=o.maxZoom===b?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?b:e,this._layersMinZoom=t===1/0?b:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===b&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===b&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var A,I="_leaflet_events";C.DomEvent={on:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._on(t,o,e[o],i);else for(var a=0,s=(e=C.Util.splitWords(e)).length;a<s;a++)this._on(t,e[a],i,n);return this},off:function(t,e,i,n){if("object"==typeof e)for(var o in e)this._off(t,o,e[o],i);else for(var a=0,s=(e=C.Util.splitWords(e)).length;a<s;a++)this._off(t,e[a],i,n);return this},_on:function(e,t,i,n){var o=t+C.stamp(i)+(n?"_"+C.stamp(n):"");if(e[I]&&e[I][o])return this;var a=function(t){return i.call(n||e,t||r.event)},s=a;return C.Browser.pointer&&0===t.indexOf("touch")?this.addPointerListener(e,t,a,o):!C.Browser.touch||"dblclick"!==t||!this.addDoubleTapListener||C.Browser.pointer&&C.Browser.chrome?"addEventListener"in e?"mousewheel"===t?e.addEventListener("onwheel"in e?"wheel":"mousewheel",a,!1):"mouseenter"===t||"mouseleave"===t?(a=function(t){t=t||r.event,C.DomEvent._isExternalTarget(e,t)&&s(t)},e.addEventListener("mouseenter"===t?"mouseover":"mouseout",a,!1)):("click"===t&&C.Browser.android&&(a=function(t){return C.DomEvent._filterClick(t,s)}),e.addEventListener(t,a,!1)):"attachEvent"in e&&e.attachEvent("on"+t,a):this.addDoubleTapListener(e,a,o),e[I]=e[I]||{},e[I][o]=a,this},_off:function(t,e,i,n){var o=e+C.stamp(i)+(n?"_"+C.stamp(n):""),a=t[I]&&t[I][o];return a&&(C.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,o):C.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,o):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",a,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,a,!1):"detachEvent"in t&&t.detachEvent("on"+e,a),t[I][o]=null),this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,C.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return C.DomEvent.on(t,"mousewheel",C.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=C.DomEvent.stopPropagation;return C.DomEvent.on(t,C.Draggable.START.join(" "),e),C.DomEvent.on(t,{click:C.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return C.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new C.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new C.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},_wheelPxFactor:C.Browser.win&&C.Browser.chrome?2:C.Browser.gecko?r.devicePixelRatio:1,getWheelDelta:function(t){return C.Browser.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/C.DomEvent._wheelPxFactor:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(t){C.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_isExternalTarget:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=C.DomEvent._lastClick&&i-C.DomEvent._lastClick;n&&100<n&&n<500||t.target._simulatedClick&&!t._simulated?C.DomEvent.stop(t):(C.DomEvent._lastClick=i,e(t))}},C.DomEvent.addListener=C.DomEvent.on,C.DomEvent.removeListener=C.DomEvent.off,C.PosAnimation=C.Evented.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=C.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=C.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),C.DomUtil.setPosition(this._el,i),this.fire("step")},_complete:function(){C.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),C.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:C.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,o=this.R_MINOR/i,a=Math.sqrt(1-o*o),s=a*Math.sin(n),r=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),a/2);return n=-i*Math.log(Math.max(r,1e-10)),new C.Point(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,o=this.R_MINOR/n,a=Math.sqrt(1-o*o),s=Math.exp(-t.y/n),r=Math.PI/2-2*Math.atan(s),l=0,c=.1;l<15&&1e-7<Math.abs(c);l++)e=a*Math.sin(r),e=Math.pow((1-e)/(1+e),a/2),r+=c=Math.PI/2-2*Math.atan(s*e)-r;return new C.LatLng(r*i,t.x*i/n)}},C.CRS.EPSG3395=C.extend({},C.CRS.Earth,{code:"EPSG:3395",projection:C.Projection.Mercator,transformation:(A=.5/(Math.PI*C.Projection.Mercator.R),new C.Transformation(A,.5,-A,.5))}),C.GridLayer=C.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:C.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:b,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){C.setOptions(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),C.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(C.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(C.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=C.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return g.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof C.Point?t:new C.Point(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==b&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),o=0,a=i.length;o<a;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!C.Browser.ielt9){C.DomUtil.setOpacity(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var o=this._tiles[n];if(o.current&&o.loaded){var a=Math.min(1,(t-o.loaded)/200);C.DomUtil.setOpacity(o.el,a),a<1?e=!0:(o.active&&(i=!0),o.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(C.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=C.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=C.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t===b)return b;for(var i in this._levels)this._levels[i].el.children.length||i===t?this._levels[i].el.style.zIndex=e-Math.abs(t-i):(C.DomUtil.remove(this._levels[i].el),this._removeTilesAtZoom(i),delete this._levels[i]);var n=this._levels[t],o=this._map;return n||((n=this._levels[t]={}).el=C.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,o.getCenter(),o.getZoom()),C.Util.falseFn(n.el.offsetWidth)),this._level=n},_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)C.DomUtil.remove(this._levels[t].el),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(t,e,i,n){var o=Math.floor(t/2),a=Math.floor(e/2),s=i-1,r=new C.Point(+o,+a);r.z=+s;var l=this._tileCoordsToKey(r),c=this._tiles[l];return c&&c.active?c.retain=!0:(c&&c.loaded&&(c.retain=!0),n<s&&this._retainParent(o,a,s,n))},_retainChildren:function(t,e,i,n){for(var o=2*t;o<2*t+2;o++)for(var a=2*e;a<2*e+2;a++){var s=new C.Point(o,a);s.z=i+1;var r=this._tileCoordsToKey(s),l=this._tiles[r];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<n&&this._retainChildren(o,a,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_setView:function(t,e,i,n){var o=Math.round(e);(this.options.maxZoom!==b&&o>this.options.maxZoom||this.options.minZoom!==b&&o<this.options.minZoom)&&(o=b);var a=this.options.updateWhenZooming&&o!==this._tileZoom;n&&!a||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),o!==b&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),o=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();C.Browser.any3d?C.DomUtil.setTransform(t.el,o,n):C.DomUtil.setPosition(t.el,o)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),o=e.project(t,this._tileZoom).floor(),a=e.getSize().divideBy(2*n);return new C.Bounds(o.subtract(a),o.add(a))},_update:function(t){var e=this._map;if(e){var i=e.getZoom();if(t===b&&(t=e.getCenter()),this._tileZoom!==b){var n=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(n),a=o.getCenter(),s=[],r=this.options.keepBuffer,l=new C.Bounds(o.getBottomLeft().subtract([r,-r]),o.getTopRight().add([r,-r]));for(var c in this._tiles){var d=this._tiles[c].coords;d.z===this._tileZoom&&l.contains(C.point(d.x,d.y))||(this._tiles[c].current=!1)}if(1<Math.abs(i-this._tileZoom))this._setView(t,i);else{for(var u=o.min.y;u<=o.max.y;u++)for(var h=o.min.x;h<=o.max.x;h++){var p=new C.Point(h,u);if(p.z=this._tileZoom,this._isValidTile(p)){var f=this._tiles[this._tileCoordsToKey(p)];f?f.current=!0:s.push(p)}}if(s.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)}),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var m=g.createDocumentFragment();for(h=0;h<s.length;h++)this._addTile(s[h],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return C.latLngBounds(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),o=n.add(i),a=e.unproject(n,t.z),s=e.unproject(o,t.z),r=new C.LatLngBounds(a,s);return this.options.noWrap||e.wrapLatLngBounds(r),r},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new C.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(C.DomUtil.remove(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){C.DomUtil.addClass(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=C.Util.falseFn,t.onmousemove=C.Util.falseFn,C.Browser.ielt9&&this.options.opacity<1&&C.DomUtil.setOpacity(t,this.options.opacity),C.Browser.android&&!C.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),C.bind(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&C.Util.requestAnimFrame(C.bind(this._tileReady,this,t,null,o)),C.DomUtil.setPosition(o,i),this._tiles[n]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,i){if(this._map){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);(i=this._tiles[n])&&(i.loaded=+new Date,this._map._fadeAnimated?(C.DomUtil.setOpacity(i.el,0),C.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=C.Util.requestAnimFrame(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(C.DomUtil.addClass(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),C.Browser.ielt9||!this._map._fadeAnimated?C.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(C.bind(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new C.Point(this._wrapX?C.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?C.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new C.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),C.gridLayer=function(t){return new C.GridLayer(t)},C.TileLayer=C.GridLayer.extend({options:{minZoom:0,maxZoom:16,maxNativeZoom:null,minNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=C.setOptions(this,e)).detectRetina&&C.Browser.retina&&0<e.maxZoom&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),C.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=g.createElement("img");return C.DomEvent.on(i,"load",C.bind(this._tileOnLoad,this,e,i)),C.DomEvent.on(i,"error",C.bind(this._tileOnError,this,e,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",i.setAttribute("role","presentation"),i.src=this.getTileUrl(t),i},getTileUrl:function(t){var e={r:C.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return C.Util.template(this._url,C.extend(e,this.options))},_tileOnLoad:function(t,e){C.Browser.ielt9?setTimeout(C.bind(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.src!==n&&(e.src=n),t(i,e)},getTileSize:function(){var t=this._map,e=C.GridLayer.prototype.getTileSize.call(this),i=this._tileZoom+this.options.zoomOffset,n=this.options.minNativeZoom,o=this.options.maxNativeZoom;return null!==n&&i<n?e.divideBy(t.getZoomScale(n,i)).round():null!==o&&o<i?e.divideBy(t.getZoomScale(o,i)).round():e},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,i=this.options.zoomReverse,n=this.options.zoomOffset,o=this.options.minNativeZoom,a=this.options.maxNativeZoom;return i&&(t=e-t),t+=n,null!==o&&t<o?o:null!==a&&a<t?a:t},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=C.Util.falseFn,e.onerror=C.Util.falseFn,e.complete||(e.src=C.Util.emptyImageUrl,C.DomUtil.remove(e)))}}),C.tileLayer=function(t,e){return new C.TileLayer(t,e)},C.TileLayer.WMS=C.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=C.extend({},this.defaultWmsParams);for(var n in e)n in this.options||(i[n]=e[n]);e=C.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&C.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[e]=this._crs.code,C.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),n=this._crs.project(e.getSouthEast()),o=(1.3<=this._wmsVersion&&this._crs===C.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(","),a=C.TileLayer.prototype.getTileUrl.call(this,t);return a+C.Util.getParamString(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(t,e){return C.extend(this.wmsParams,t),e||this.redraw(),this}}),C.tileLayer.wms=function(t,e){return new C.TileLayer.WMS(t,e)},C.ImageOverlay=C.Layer.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1},initialize:function(t,e,i){this._url=t,this._bounds=C.latLngBounds(e),C.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(C.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){C.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&C.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&C.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=t,this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=C.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=C.Util.falseFn,t.onmousemove=C.Util.falseFn,t.onload=C.bind(this.fire,this,"load"),this.options.crossOrigin&&(t.crossOrigin=""),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;C.DomUtil.setTransform(this._image,i,e)},_reset:function(){var t=this._image,e=new C.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();C.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){C.DomUtil.setOpacity(this._image,this.options.opacity)}}),C.imageOverlay=function(t,e,i){return new C.ImageOverlay(t,e,i)},C.Icon=C.Class.extend({initialize:function(t){C.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var o=C.point(n),a=C.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),a&&(t.style.marginLeft=-a.x+"px",t.style.marginTop=-a.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return(e=e||g.createElement("img")).src=t,e},_getIconUrl:function(t){return C.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),C.icon=function(t){return new C.Icon(t)},C.Icon.Default=C.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[0,0],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[0,0],imagePath:"/UI/app/img/"},_getIconUrl:function(t){return C.Icon.Default.imagePath||(C.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||C.Icon.Default.imagePath)+C.Icon.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=C.DomUtil.create("div","leaflet-default-icon-path",g.body),e=C.DomUtil.getStyle(t,"background-image")||C.DomUtil.getStyle(t,"backgroundImage");return g.body.removeChild(t),0===e.indexOf("url")?e.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}}),C.Marker=C.Layer.extend({options:{icon:new C.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(t,e){C.setOptions(this,e),this._latlng=C.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=C.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),C.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var o=t.icon.createShadow(this._shadow),a=!1;o!==this._shadow&&(this._removeShadow(),a=!0),o&&(C.DomUtil.addClass(o,e),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&a&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),C.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&C.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){C.DomUtil.setPosition(this._icon,t),this._shadow&&C.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(C.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),C.Handler.MarkerDrag)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new C.Handler.MarkerDrag(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;C.DomUtil.setOpacity(this._icon,t),this._shadow&&C.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),C.marker=function(t,e){return new C.Marker(t,e)},C.DivIcon=C.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:g.createElement("div"),i=this.options;if(e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=C.point(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),C.divIcon=function(t){return new C.DivIcon(t)},C.DivOverlay=C.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){C.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&C.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&C.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(C.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(C.bind(C.DomUtil.remove,C.DomUtil,this._container),200)):C.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=C.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&C.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&C.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=C.point(this.options.offset),i=this._getAnchor();this._zoomAnimated?C.DomUtil.setPosition(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}}),C.Popup=C.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){C.DivOverlay.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof C.Path||this._source.on("preclick",C.DomEvent.stopPropagation))},onRemove:function(t){C.DivOverlay.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof C.Path||this._source.off("preclick",C.DomEvent.stopPropagation))},getEvents:function(){var t=C.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=C.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var i=this._closeButton=C.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",C.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var n=this._wrapper=C.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=C.DomUtil.create("div",t+"-content",n),C.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",C.DomEvent.stopPropagation),this._tipContainer=C.DomUtil.create("div",t+"-tip-container",e),this._tip=C.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,o=this.options.maxHeight,a="leaflet-popup-scrolled";o&&o<n?(e.height=o+"px",C.DomUtil.addClass(t,a)):C.DomUtil.removeClass(t,a),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();C.DomUtil.setPosition(this._container,e.add(i))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(C.DomUtil.getStyle(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,o=new C.Point(this._containerLeft,-i-this._containerBottom);o._add(C.DomUtil.getPosition(this._container));var a=t.layerPointToContainerPoint(o),s=C.point(this.options.autoPanPadding),r=C.point(this.options.autoPanPaddingTopLeft||s),l=C.point(this.options.autoPanPaddingBottomRight||s),c=t.getSize(),d=0,u=0;a.x+n+l.x>c.x&&(d=a.x+n-c.x+l.x),a.x-d-r.x<0&&(d=a.x-r.x),a.y+i+l.y>c.y&&(u=a.y+i-c.y+l.y),a.y-u-r.y<0&&(u=a.y-r.y),(d||u)&&t.fire("autopanstart").panBy([d,u])}},_onCloseButtonClick:function(t){this._close(),C.DomEvent.stop(t)},_getAnchor:function(){return C.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),C.popup=function(t,e){return new C.Popup(t,e)},C.Map.mergeOptions({closePopupOnClick:!0}),C.Map.include({openPopup:function(t,e,i){return t instanceof C.Popup||(t=new C.Popup(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),C.Layer.include({bindPopup:function(t,e){return t instanceof C.Popup?(C.setOptions(t,e),(this._popup=t)._source=this):(this._popup&&!e||(this._popup=new C.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof C.Layer||(e=t,t=this),t instanceof C.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e=e||(t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(C.DomEvent.stop(t),e instanceof C.Path?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),C.Tooltip=C.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){C.DivOverlay.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){C.DivOverlay.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=C.DivOverlay.prototype.getEvents.call(this);return C.Browser.touch&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=C.DomUtil.create("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),o=e.layerPointToContainerPoint(t),a=this.options.direction,s=i.offsetWidth,r=i.offsetHeight,l=C.point(this.options.offset),c=this._getAnchor();t="top"===a?t.add(C.point(-s/2+l.x,-r+l.y+c.y,!0)):"bottom"===a?t.subtract(C.point(s/2-l.x,-l.y,!0)):"center"===a?t.subtract(C.point(s/2+l.x,r/2-c.y+l.y,!0)):"right"===a||"auto"===a&&o.x<n.x?(a="right",t.add(C.point(l.x+c.x,c.y-r/2+l.y,!0))):(a="left",t.subtract(C.point(s+c.x-l.x,r/2-c.y-l.y,!0))),C.DomUtil.removeClass(i,"leaflet-tooltip-right"),C.DomUtil.removeClass(i,"leaflet-tooltip-left"),C.DomUtil.removeClass(i,"leaflet-tooltip-top"),C.DomUtil.removeClass(i,"leaflet-tooltip-bottom"),C.DomUtil.addClass(i,"leaflet-tooltip-"+a),C.DomUtil.setPosition(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&C.DomUtil.setOpacity(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return C.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),C.tooltip=function(t,e){return new C.Tooltip(t,e)},C.Map.include({openTooltip:function(t,e,i){return t instanceof C.Tooltip||(t=new C.Tooltip(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),C.Layer.include({bindTooltip:function(t,e){return t instanceof C.Tooltip?(C.setOptions(t,e),(this._tooltip=t)._source=this):(this._tooltip&&!e||(this._tooltip=C.tooltip(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),C.Browser.touch&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof C.Layer||(e=t,t=this),t instanceof C.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e=e||(t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(C.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(C.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:b)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}}),C.LayerGroup=C.Layer.extend({initialize:function(t){var e,i;if(this._layers={},t)for(e=0,i=t.length;e<i;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return C.stamp(t)}}),C.layerGroup=function(t){return new C.LayerGroup(t)},C.FeatureGroup=C.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),C.LayerGroup.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),C.LayerGroup.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new C.LatLngBounds;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),C.featureGroup=function(t){return new C.FeatureGroup(t)},C.Renderer=C.Layer.extend({options:{padding:.1},initialize:function(t){C.setOptions(this,t),C.stamp(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&C.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){C.DomUtil.remove(this._container),this.off("update",this._updatePaths,this)},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=C.DomUtil.getPosition(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),a=this._map.project(this._center,e),s=this._map.project(t,e).subtract(a),r=o.multiplyBy(-i).add(n).add(o).subtract(s);C.Browser.any3d?C.DomUtil.setTransform(this._container,r,i):C.DomUtil.setPosition(this._container,r)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new C.Bounds(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),C.Map.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e=e||(this._renderer=this.options.preferCanvas&&C.canvas()||C.svg()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||t===b)return!1;var e=this._paneRenderers[t];return e===b&&(e=C.SVG&&C.svg({pane:t})||C.Canvas&&C.canvas({pane:t}),this._paneRenderers[t]=e),e}}),C.Path=C.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return C.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(C.Browser.touch?10:0)}}),C.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var i=t.length,n=new(typeof Uint8Array!=b+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,this._simplifyDPStep(t,n,e,0,i-1);var o,a=[];for(o=0;o<i;o++)n[o]&&a.push(t[o]);return a},_simplifyDPStep:function(t,e,i,n,o){var a,s,r,l=0;for(s=n+1;s<=o-1;s++)l<(r=this._sqClosestPointOnSegment(t[s],t[n],t[o],!0))&&(a=s,l=r);i<l&&(e[a]=1,this._simplifyDPStep(t,e,i,n,a),this._simplifyDPStep(t,e,i,a,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,a=t.length;n<a;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return o<a-1&&i.push(t[a-1]),i},clipSegment:function(t,e,i,n,o){var a,s,r,l=n?this._lastCode:this._getBitCode(t,i),c=this._getBitCode(e,i);for(this._lastCode=c;;){if(!(l|c))return[t,e];if(l&c)return!1;a=l||c,s=this._getEdgeIntersection(t,e,a,i,o),r=this._getBitCode(s,i),a===l?(t=s,l=r):(e=s,c=r)}},_getEdgeIntersection:function(t,e,i,n,o){var a,s,r=e.x-t.x,l=e.y-t.y,c=n.min,d=n.max;return 8&i?(a=t.x+r*(d.y-t.y)/l,s=d.y):4&i?(a=t.x+r*(c.y-t.y)/l,s=c.y):2&i?(a=d.x,s=t.y+l*(d.x-t.x)/r):1&i&&(a=c.x,s=t.y+l*(c.x-t.x)/r),new C.Point(a,s,o)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var o,a=e.x,s=e.y,r=i.x-a,l=i.y-s,c=r*r+l*l;return 0<c&&(1<(o=((t.x-a)*r+(t.y-s)*l)/c)?(a=i.x,s=i.y):0<o&&(a+=r*o,s+=l*o)),r=t.x-a,l=t.y-s,n?r*r+l*l:new C.Point(a,s)}},C.Polyline=C.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){C.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,o=null,a=C.LineUtil._sqClosestPointOnSegment,s=0,r=this._parts.length;s<r;s++)for(var l=this._parts[s],c=1,d=l.length;c<d;c++){var u=a(t,e=l[c-1],i=l[c],!0);u<n&&(n=u,o=a(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,a,s,r=this._rings[0],l=r.length;if(!l)return null;for(e=t=0;t<l-1;t++)e+=r[t].distanceTo(r[t+1])/2;if(0===e)return this._map.layerPointToLatLng(r[0]);for(n=t=0;t<l-1;t++)if(o=r[t],a=r[t+1],e<(n+=i=o.distanceTo(a)))return s=(n-e)/i,this._map.layerPointToLatLng([a.x-s*(a.x-o.x),a.y-s*(a.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=C.latLng(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new C.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return C.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=C.Polyline._flat(t),n=0,o=t.length;n<o;n++)i?(e[n]=C.latLng(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new C.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new C.Point(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,o,a=t[0]instanceof C.LatLng,s=t.length;if(a){for(o=[],n=0;n<s;n++)o[n]=this._map.latLngToLayerPoint(t[n]),i.extend(o[n]);e.push(o)}else for(n=0;n<s;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,o,a,s,r,l=this._parts;for(n=e=0,o=this._rings.length;e<o;e++)for(i=0,a=(r=this._rings[e]).length;i<a-1;i++)(s=C.LineUtil.clipSegment(r[i],r[i+1],t,i,!0))&&(l[n]=l[n]||[],l[n].push(s[0]),s[1]===r[i+1]&&i!==a-2||(l[n].push(s[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=C.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),C.polyline=function(t,e){return new C.Polyline(t,e)},C.Polyline._flat=function(t){return!C.Util.isArray(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]},C.PolyUtil={},C.PolyUtil.clipPolygon=function(t,e,i){var n,o,a,s,r,l,c,d,u,h=[1,4,2,8],p=C.LineUtil;for(o=0,c=t.length;o<c;o++)t[o]._code=p._getBitCode(t[o],e);for(s=0;s<4;s++){for(d=h[s],n=[],o=0,a=(c=t.length)-1;o<c;a=o++)r=t[o],l=t[a],r._code&d?l._code&d||((u=p._getEdgeIntersection(l,r,d,e,i))._code=p._getBitCode(u,e),n.push(u)):(l._code&d&&((u=p._getEdgeIntersection(l,r,d,e,i))._code=p._getBitCode(u,e),n.push(u)),n.push(r));t=n}return t},C.Polygon=C.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,a,s,r,l,c=this._rings[0],d=c.length;if(!d)return null;for(a=s=r=0,t=0,e=d-1;t<d;e=t++)i=c[t],n=c[e],o=i.y*n.x-n.y*i.x,s+=(i.x+n.x)*o,r+=(i.y+n.y)*o,a+=3*o;return l=0===a?c[0]:[s/a,r/a],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=C.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return 2<=i&&e[0]instanceof C.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){C.Polyline.prototype._setLatLngs.call(this,t),C.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return C.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new C.Point(e,e);if(t=new C.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,o=0,a=this._rings.length;o<a;o++)(n=C.PolyUtil.clipPolygon(this._rings[o],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),C.polygon=function(t,e){return new C.Polygon(t,e)},C.Rectangle=C.Polygon.extend({initialize:function(t,e){C.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=C.latLngBounds(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),C.rectangle=function(t,e){return new C.Rectangle(t,e)},C.CircleMarker=C.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){C.setOptions(this,e),this._latlng=C.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=C.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return C.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new C.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),C.circleMarker=function(t,e){return new C.CircleMarker(t,e)},C.Circle=C.CircleMarker.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=C.extend({},i,{radius:e})),C.setOptions(this,e),this._latlng=C.latLng(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new C.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:C.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===C.CRS.Earth.distance){var o=Math.PI/180,a=this._mRadius/C.CRS.Earth.R/o,s=i.project([e+a,t]),r=i.project([e-a,t]),l=s.add(r).divideBy(2),c=i.unproject(l).lat,d=Math.acos((Math.cos(a*o)-Math.sin(e*o)*Math.sin(c*o))/(Math.cos(e*o)*Math.cos(c*o)))/o;!isNaN(d)&&0!==d||(d=a/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(d)?0:Math.max(Math.round(l.x-i.project([c,t-d]).x),1),this._radiusY=Math.max(Math.round(l.y-s.y),1)}else{var u=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(u).x}this._updateBounds()}}),C.circle=function(t,e,i){return new C.Circle(t,e,i)},C.SVG=C.Renderer.extend({getEvents:function(){var t=C.Renderer.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=C.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=C.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){C.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),C.DomUtil.setPosition(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=C.SVG.create("path");t.options.className&&C.DomUtil.addClass(e,t.options.className),t.options.interactive&&C.DomUtil.addClass(e,"leaflet-interactive"),this._updateStyle(t),this._layers[C.stamp(t)]=t},_addPath:function(t){this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){C.DomUtil.remove(t._path),t.removeInteractiveTarget(t._path),delete this._layers[C.stamp(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,C.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n="a"+i+","+(t._radiusY||i)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,o)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){C.DomUtil.toFront(t._path)},_bringToBack:function(t){C.DomUtil.toBack(t._path)}}),C.extend(C.SVG,{create:function(t){return g.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,n,o,a,s,r,l="";for(i=0,o=t.length;i<o;i++){for(n=0,a=(s=t[i]).length;n<a;n++)l+=(n?"L":"M")+(r=s[n]).x+" "+r.y;l+=e?C.Browser.svg?"z":"x":""}return l||"M0 0"}}),C.Browser.svg=!(!g.createElementNS||!C.SVG.create("svg").createSVGRect),C.svg=function(t){return C.Browser.svg||C.Browser.vml?new C.SVG(t):null},C.Browser.vml=!C.Browser.svg&&function(){try{var t=g.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),C.SVG.include(C.Browser.vml?{_initContainer:function(){this._container=C.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(C.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=C.SVG.create("shape");C.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=C.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[C.stamp(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;C.DomUtil.remove(e),t.removeInteractiveTarget(e),delete this._layers[C.stamp(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,o=t._container;o.stroked=!!n.stroke,o.filled=!!n.fill,n.stroke?(e=e||(t._stroke=C.SVG.create("stroke")),o.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=C.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(o.removeChild(e),t._stroke=null),n.fill?(i=i||(t._fill=C.SVG.create("fill")),o.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(o.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){C.DomUtil.toFront(t._container)},_bringToBack:function(t){C.DomUtil.toBack(t._container)}}:{}),C.Browser.vml&&(C.SVG.create=function(){try{return g.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return g.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return g.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),C.Canvas=C.Renderer.extend({getEvents:function(){var t=C.Renderer.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){C.Renderer.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=g.createElement("canvas");C.DomEvent.on(t,"mousemove",C.Util.throttle(this._onMouseMove,32,this),this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},C.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=C.Browser.retina?2:1;C.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",C.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){C.Renderer.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t);var e=(this._layers[C.stamp(t)]=t)._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[C.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(","),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||C.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(t){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new C.Bounds,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,o,a,s=t._parts,r=s.length,l=this._ctx;if(r){for(this._drawnLayers[t._leaflet_id]=t,l.beginPath(),l.setLineDash&&l.setLineDash(t.options&&t.options._dashArray||[]),i=0;i<r;i++){for(n=0,o=s[i].length;n<o;n++)a=s[i][n],l[n?"lineTo":"moveTo"](a.x,a.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!=o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!=o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(n)&&!this._map._draggableMoved(e)&&(i=e);i&&(C.DomEvent._fakeStop(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(C.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var i,n,o=this._drawFirst;o;o=o.next)(i=o.layer).options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(C.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order,i=e.next,n=e.prev;i&&((i.prev=n)?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,(this._drawLast.next=e).next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,i=e.next,n=e.prev;n&&((n.next=i)?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),C.Browser.canvas=!!g.createElement("canvas").getContext,C.canvas=function(t){return C.Browser.canvas?new C.Canvas(t):null},C.Polyline.prototype._containsPoint=function(t,e){var i,n,o,a,s,r,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,a=this._parts.length;i<a;i++)for(n=0,o=(s=(r=this._parts[i]).length)-1;n<s;o=n++)if((e||0!==n)&&C.LineUtil.pointToSegmentDistance(t,r[o],r[n])<=l)return!0;return!1},C.Polygon.prototype._containsPoint=function(t){var e,i,n,o,a,s,r,l,c=!1;if(!this._pxBounds.contains(t))return!1;for(o=0,r=this._parts.length;o<r;o++)for(a=0,s=(l=(e=this._parts[o]).length)-1;a<l;s=a++)i=e[a],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(c=!c);return c||C.Polyline.prototype._containsPoint.call(this,t,!0)},C.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},C.GeoJSON=C.FeatureGroup.extend({initialize:function(t,e){C.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,o=C.Util.isArray(t)?t:t.features;if(o){for(e=0,i=o.length;e<i;e++)((n=o[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var a=this.options;if(a.filter&&!a.filter(t))return this;var s=C.GeoJSON.geometryToLayer(t,a);return s?(s.feature=C.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),a.onEachFeature&&a.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return t.options=C.Util.extend({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(e){return this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),C.extend(C.GeoJSON,{geometryToLayer:function(t,e){var i,n,o,a,s="Feature"===t.type?t.geometry:t,r=s?s.coordinates:null,l=[],c=e&&e.pointToLayer,d=e&&e.coordsToLatLng||this.coordsToLatLng;if(!r&&!s)return null;switch(s.type){case"Point":return i=d(r),c?c(t,i):new C.Marker(i);case"MultiPoint":for(o=0,a=r.length;o<a;o++)i=d(r[o]),l.push(c?c(t,i):new C.Marker(i));return new C.FeatureGroup(l);case"LineString":case"MultiLineString":return n=this.coordsToLatLngs(r,"LineString"===s.type?0:1,d),new C.Polyline(n,e);case"Polygon":case"MultiPolygon":return n=this.coordsToLatLngs(r,"Polygon"===s.type?1:2,d),new C.Polygon(n,e);case"GeometryCollection":for(o=0,a=s.geometries.length;o<a;o++){var u=this.geometryToLayer({geometry:s.geometries[o],type:"Feature",properties:t.properties},e);u&&l.push(u)}return new C.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new C.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],a=0,s=t.length;a<s;a++)n=e?this.coordsToLatLngs(t[a],e-1,i):(i||this.coordsToLatLng)(t[a]),o.push(n);return o},latLngToCoords:function(t){return t.alt!==b?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var n=[],o=0,a=t.length;o<a;o++)n.push(e?C.GeoJSON.latLngsToCoords(t[o],e-1,i):C.GeoJSON.latLngToCoords(t[o]));return!e&&i&&n.push(n[0]),n},getFeature:function(t,e){return t.feature?C.extend({},t.feature,{geometry:e}):C.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var E={toGeoJSON:function(){return C.GeoJSON.getFeature(this,{type:"Point",coordinates:C.GeoJSON.latLngToCoords(this.getLatLng())})}};C.Marker.include(E),C.Circle.include(E),C.CircleMarker.include(E),C.Polyline.prototype.toGeoJSON=function(){var t=!C.Polyline._flat(this._latlngs),e=C.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return C.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},C.Polygon.prototype.toGeoJSON=function(){var t=!C.Polyline._flat(this._latlngs),e=t&&!C.Polyline._flat(this._latlngs[0]),i=C.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t||(i=[i]),C.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},C.LayerGroup.include({toMultiPoint:function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),C.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var i="GeometryCollection"===t,n=[];return this.eachLayer(function(t){if(t.toGeoJSON){var e=t.toGeoJSON();n.push(i?e.geometry:C.GeoJSON.asFeature(e))}}),i?C.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}}),C.geoJSON=function(t,e){return new C.GeoJSON(t,e)},C.geoJson=C.geoJSON,C.Draggable=C.Evented.extend({options:{clickTolerance:3},statics:{START:C.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e,i){this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(C.DomEvent.on(this._dragStartTarget,C.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(C.Draggable._dragging===this&&this.finishDrag(),C.DomEvent.off(this._dragStartTarget,C.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!C.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(C.Draggable._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||((C.Draggable._dragging=this)._preventOutline&&C.DomUtil.preventOutline(this._element),C.DomUtil.disableImageDrag(),C.DomUtil.disableTextSelection(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new C.Point(e.clientX,e.clientY),C.DomEvent.on(g,C.Draggable.MOVE[t.type],this._onMove,this).on(g,C.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&1<t.touches.length)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new C.Point(e.clientX,e.clientY).subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(C.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=C.DomUtil.getPosition(this._element).subtract(i),C.DomUtil.addClass(g.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,r.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),C.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,C.Util.cancelAnimFrame(this._animRequest),this._lastEvent=t,this._animRequest=C.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),C.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in C.DomUtil.removeClass(g.body,"leaflet-dragging"),this._lastTarget&&(C.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),C.Draggable.MOVE)C.DomEvent.off(g,C.Draggable.MOVE[t],this._onMove,this).off(g,C.Draggable.END[t],this._onUp,this);C.DomUtil.enableImageDrag(),C.DomUtil.enableTextSelection(),this._moved&&this._moving&&(C.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,C.Draggable._dragging=!1}}),C.Handler=C.Class.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}}),C.Map.mergeOptions({dragging:!0,inertia:!C.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),C.Map.Drag=C.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new C.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}C.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){C.DomUtil.removeClass(this._map._container,"leaflet-grab"),C.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var t=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=C.latLngBounds(this._map.options.maxBounds);this._offsetLimit=C.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),50<e-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,a=(n+e+i)%t-e-i,s=Math.abs(o+i)<Math.abs(a+i)?o:a;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),a=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,r=o.multiplyBy(s/a),l=r.distanceTo([0,0]),c=Math.min(i.inertiaMaxSpeed,l),d=r.multiplyBy(c/l),u=c/(i.inertiaDeceleration*s),h=d.multiplyBy(-u/2).round();h.x||h.y?(h=e._limitOffset(h,e.options.maxBounds),C.Util.requestAnimFrame(function(){e.panBy(h,{duration:u,easeLinearity:s,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}}),C.Map.addInitHook("addHandler","dragging",C.Map.Drag),C.Map.mergeOptions({doubleClickZoom:!0}),C.Map.DoubleClickZoom=C.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}}),C.Map.addInitHook("addHandler","doubleClickZoom",C.Map.DoubleClickZoom),C.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),C.Map.ScrollWheelZoom=C.Handler.extend({addHooks:function(){C.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){C.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=C.DomEvent.getWheelDelta(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(C.bind(this._performZoom,this),n),C.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,a=i?Math.ceil(o/i)*i:o,s=t._limitZoom(e+(0<this._delta?a:-a))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}}),C.Map.addInitHook("addHandler","scrollWheelZoom",C.Map.ScrollWheelZoom),C.extend(C.DomEvent,{_touchstart:C.Browser.msPointer?"MSPointerDown":C.Browser.pointer?"pointerdown":"touchstart",_touchend:C.Browser.msPointer?"MSPointerUp":C.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,o,e){var a,s,r=!1;function i(t){var e;if(C.Browser.pointer){if(!C.Browser.edge||"mouse"===t.pointerType)return;e=C.DomEvent._pointersCount}else e=t.touches.length;if(!(1<e)){var i=Date.now(),n=i-(a||i);s=t.touches?t.touches[0]:t,r=0<n&&n<=250,a=i}}function n(t){if(r&&!s.cancelBubble){if(C.Browser.pointer){if(!C.Browser.edge||"mouse"===t.pointerType)return;var e,i,n={};for(i in s)e=s[i],n[i]=e&&e.bind?e.bind(s):e;s=n}s.type="dblclick",o(s),a=null}}var l="_leaflet_",c=this._touchstart,d=this._touchend;return t[l+c+e]=i,t[l+d+e]=n,t[l+"dblclick"+e]=o,t.addEventListener(c,i,!1),t.addEventListener(d,n,!1),t.addEventListener("dblclick",o,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",n=t[i+this._touchstart+e],o=t[i+this._touchend+e],a=t[i+"dblclick"+e];return t.removeEventListener(this._touchstart,n,!1),t.removeEventListener(this._touchend,o,!1),C.Browser.edge||t.removeEventListener("dblclick",a,!1),this}}),C.extend(C.DomEvent,{POINTER_DOWN:C.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:C.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:C.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:C.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,e,i){var n=C.bind(function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(t.target.tagName)<0))return;C.DomEvent.preventDefault(t)}this._handlePointer(t,e)},this);if(t["_leaflet_touchstart"+i]=n,t.addEventListener(this.POINTER_DOWN,n,!1),!this._pointerDocListener){var o=C.bind(this._globalPointerUp,this);g.documentElement.addEventListener(this.POINTER_DOWN,C.bind(this._globalPointerDown,this),!0),g.documentElement.addEventListener(this.POINTER_MOVE,C.bind(this._globalPointerMove,this),!0),g.documentElement.addEventListener(this.POINTER_UP,o,!0),g.documentElement.addEventListener(this.POINTER_CANCEL,o,!0),this._pointerDocListener=!0}},_globalPointerDown:function(t){this._pointers[t.pointerId]=t,this._pointersCount++},_globalPointerMove:function(t){this._pointers[t.pointerId]&&(this._pointers[t.pointerId]=t)},_globalPointerUp:function(t){delete this._pointers[t.pointerId],this._pointersCount--},_handlePointer:function(t,e){for(var i in t.touches=[],this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var n=C.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&this._handlePointer(t,e)},this);t["_leaflet_touchmove"+i]=n,t.addEventListener(this.POINTER_MOVE,n,!1)},_addPointerEnd:function(t,e,i){var n=C.bind(function(t){this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=n,t.addEventListener(this.POINTER_UP,n,!1),t.addEventListener(this.POINTER_CANCEL,n,!1)}}),C.Map.mergeOptions({touchZoom:C.Browser.touch&&!C.Browser.android23,bounceAtZoomLimits:!0}),C.Map.TouchZoom=C.Handler.extend({addHooks:function(){C.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),C.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){C.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),C.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),C.DomEvent.on(g,"touchmove",this._onTouchMove,this).on(g,"touchend",this._onTouchEnd,this),C.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),o=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&1<o)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1==o)return}else{var a=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1==o&&0===a.x&&0===a.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(a),this._zoom)}this._moved||(e._moveStart(!0),this._moved=!0),C.Util.cancelAnimFrame(this._animRequest);var s=C.bind(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=C.Util.requestAnimFrame(s,this,!0),C.DomEvent.preventDefault(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,C.Util.cancelAnimFrame(this._animRequest),C.DomEvent.off(g,"touchmove",this._onTouchMove).off(g,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}}),C.Map.addInitHook("addHandler","touchZoom",C.Map.TouchZoom),C.Map.mergeOptions({tap:!0,tapTolerance:15}),C.Map.Tap=C.Handler.extend({addHooks:function(){C.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){C.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(C.DomEvent.preventDefault(t),this._fireClick=!0,1<t.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new C.Point(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&C.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(C.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),C.DomEvent.on(g,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),C.DomEvent.off(g,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&C.DomUtil.removeClass(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new C.Point(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var i=g.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,r,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}),C.Browser.touch&&!C.Browser.pointer&&C.Map.addInitHook("addHandler","tap",C.Map.Tap),C.Map.mergeOptions({boxZoom:!0}),C.Map.BoxZoom=C.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){C.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){C.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._resetState(),C.DomUtil.disableTextSelection(),C.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),C.DomEvent.on(g,{contextmenu:C.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=C.DomUtil.create("div","leaflet-zoom-box",this._container),C.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new C.Bounds(this._point,this._startPoint),i=e.getSize();C.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(C.DomUtil.remove(this._box),C.DomUtil.removeClass(this._container,"leaflet-crosshair")),C.DomUtil.enableTextSelection(),C.DomUtil.enableImageDrag(),C.DomEvent.off(g,{contextmenu:C.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){setTimeout(C.bind(this._resetState,this),0);var e=new C.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),C.Map.addInitHook("addHandler","boxZoom",C.Map.BoxZoom),C.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),C.Map.Keyboard=C.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),C.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),C.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=g.body,e=g.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),r.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){C.DomEvent.on(g,"keydown",this._onKeyDown,this)},_removeHooks:function(){C.DomEvent.off(g,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=C.point(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i)return;n.closePopup()}C.DomEvent.stop(t)}}}),C.Map.addInitHook("addHandler","keyboard",C.Map.Keyboard),C.Handler.MarkerDrag=C.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new C.Draggable(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),C.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&C.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,i=e._shadow,n=C.DomUtil.getPosition(e._icon),o=e._map.layerPointToLatLng(n);i&&C.DomUtil.setPosition(i,n),e._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),C.Control=C.Class.extend({options:{position:"topright"},initialize:function(t){C.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return C.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return this._map&&(C.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null),this},_refocusOnMap:function(t){this._map&&t&&0<t.screenX&&0<t.screenY&&this._map.getContainer().focus()}}),C.control=function(t){return new C.Control(t)},C.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var n=this._controlCorners={},o="leaflet-",a=this._controlContainer=C.DomUtil.create("div",o+"control-container",this._container);function t(t,e){var i=o+t+" "+o+e;n[t+e]=C.DomUtil.create("div",i,a)}t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){C.DomUtil.remove(this._controlContainer)}}),C.Control.Zoom=C.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=C.DomUtil.create("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,o){var a=C.DomUtil.create("a",i,n);return a.innerHTML=t,a.href="#",a.title=e,a.setAttribute("role","button"),a.setAttribute("aria-label",e),C.DomEvent.on(a,"mousedown dblclick",C.DomEvent.stopPropagation).on(a,"click",C.DomEvent.stop).on(a,"click",o,this).on(a,"click",this._refocusOnMap,this),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";C.DomUtil.removeClass(this._zoomInButton,e),C.DomUtil.removeClass(this._zoomOutButton,e),!this._disabled&&t._zoom!==t.getMinZoom()||C.DomUtil.addClass(this._zoomOutButton,e),!this._disabled&&t._zoom!==t.getMaxZoom()||C.DomUtil.addClass(this._zoomInButton,e)}}),C.Map.mergeOptions({zoomControl:!0}),C.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new C.Control.Zoom,this.addControl(this.zoomControl))}),C.control.zoom=function(t){return new C.Control.Zoom(t)},C.Control.Attribution=C.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){C.setOptions(this,t),this._attributions={}},onAdd:function(t){for(var e in(t.attributionControl=this)._container=C.DomUtil.create("div","leaflet-control-attribution"),C.DomEvent&&C.DomEvent.disableClickPropagation(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t&&(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update()),this},removeAttribution:function(t){return t&&this._attributions[t]&&(this._attributions[t]--,this._update()),this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),C.Map.mergeOptions({attributionControl:!1}),C.Map.addInitHook(function(){this.options.attributionControl&&(new C.Control.Attribution).addTo(this)}),C.control.attribution=function(t){return new C.Control.Attribution(t)},C.Control.Scale=C.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=C.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=C.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=C.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;5280<o?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=10<=i?10:5<=i?5:3<=i?3:2<=i?2:1)}}),C.control.scale=function(t){return new C.Control.Scale(t)},C.Control.Layers=C.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){for(var n in C.setOptions(this,i),this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),(this._map=t).on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(C.stamp(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){C.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(C.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):C.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return C.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=C.DomUtil.create("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),C.DomEvent.disableClickPropagation(e),C.Browser.touch||C.DomEvent.disableScrollPropagation(e);var n=this._form=C.DomUtil.create("form",t+"-list");i&&(this._map.on("click",this.collapse,this),C.Browser.android||C.DomEvent.on(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var o=this._layersLink=C.DomUtil.create("a",t+"-toggle",e);o.href="#",o.title="Layers",C.Browser.touch?C.DomEvent.on(o,"click",C.DomEvent.stop).on(o,"click",this.expand,this):C.DomEvent.on(o,"focus",this.expand,this),C.DomEvent.on(n,"click",function(){setTimeout(C.bind(this._onInputClick,this),0)},this),i||this.expand(),this._baseLayersList=C.DomUtil.create("div",t+"-base",n),this._separator=C.DomUtil.create("div",t+"-separator",n),this._overlaysList=C.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&C.stamp(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(C.bind(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;C.DomUtil.empty(this._baseLayersList),C.DomUtil.empty(this._overlaysList);var t,e,i,n,o=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,o+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&1<o,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(C.stamp(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=g.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=g.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((e=g.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers",n),e.layerId=C.stamp(t.layer),C.DomEvent.on(e,"click",this._onInputClick,this);var o=g.createElement("span");o.innerHTML=" "+t.name;var a=g.createElement("div");return i.appendChild(a),a.appendChild(e),a.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=[],a=[];this._handlingClick=!0;for(var s=n.length-1;0<=s;s--)t=n[s],e=this._getLayer(t.layerId).layer,i=this._map.hasLayer(e),t.checked&&!i?o.push(e):!t.checked&&i&&a.push(e);for(s=0;s<a.length;s++)this._map.removeLayer(a[s]);for(s=0;s<o.length;s++)this._map.addLayer(o[s]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._form.getElementsByTagName("input"),n=this._map.getZoom(),o=i.length-1;0<=o;o--)t=i[o],e=this._getLayer(t.layerId).layer,t.disabled=e.options.minZoom!==b&&n<e.options.minZoom||e.options.maxZoom!==b&&n>e.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),C.control.layers=function(t,e,i){return new C.Control.Layers(t,e,i)}}(window,document),function(t,f){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[]},addLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.addLayers(e)}if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this;if(!this._map)return this._needsClustering.push(t),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom);var n=t,o=this._map.getZoom();if(t.__parent)for(;n.__parent._zoom>=o;)n=n.__parent;return this._currentShownBounds.contains(n.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,n):this._animationAddLayerNonAnimated(t,n)),this},removeLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.removeLayers(e)}return t.getLatLng?this._map?t.__parent&&(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),t.off("move",this._childMarkerMoved,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.setOpacity&&t.setOpacity(1))):!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push(t):this._nonPointGroup.removeLayer(t),this},addLayers:function(o){var t,e,i,a,s=this._featureGroup,r=this._nonPointGroup,l=this.options.chunkedLoading,c=this.options.chunkInterval,d=this.options.chunkProgress;if(this._map){var u=0,h=(new Date).getTime(),p=L.bind(function(){for(var t=(new Date).getTime();u<o.length;u++){if(l&&u%200==0){var e=(new Date).getTime()-t;if(c<e)break}if((a=o[u]).getLatLng){if(!this.hasLayer(a)&&(this._addLayer(a,this._maxZoom),a.__parent&&2===a.__parent.getChildCount())){var i=a.__parent.getAllChildMarkers(),n=i[0]===a?i[1]:i[0];s.removeLayer(n)}}else r.addLayer(a)}d&&d(u,o.length,(new Date).getTime()-h),u===o.length?(this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()}),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(p,this.options.chunkDelay)},this);p()}else{for(t=[],e=0,i=o.length;e<i;e++)(a=o[e]).getLatLng?this.hasLayer(a)||t.push(a):r.addLayer(a);this._needsClustering=this._needsClustering.concat(t)}return this},removeLayers:function(t){var e,i,n,o=this._featureGroup,a=this._nonPointGroup;if(!this._map){for(e=0,i=t.length;e<i;e++)n=t[e],this._arraySplice(this._needsClustering,n),a.removeLayer(n);return this}for(e=0,i=t.length;e<i;e++)(n=t[e]).__parent?(this._removeLayer(n,!0,!0),o.hasLayer(n)&&(o.removeLayer(n),n.setOpacity&&n.setOpacity(1))):a.removeLayer(n);return this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),o.eachLayer(function(t){t instanceof L.MarkerCluster&&t._updateIcon()}),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){t.off("move",this._childMarkerMoved,this),delete t.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;if(this._topClusterLevel)t.extend(this._topClusterLevel._bounds);else for(var e=this._needsClustering.length-1;0<=e;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var i,n=this._needsClustering.slice();for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(n),i=n.length-1;0<=i;i--)t.call(e,n[i]);this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var e=[];return this.eachLayer(function(t){e.push(t)}),e},getLayer:function(e){var i=null;return this.eachLayer(function(t){L.stamp(t)===e&&(i=t)}),i},hasLayer:function(t){if(!t)return!1;var e,i=this._needsClustering;for(e=i.length-1;0<=e;e--)if(i[e]===t)return!0;for(e=(i=this._needsRemoving).length-1;0<=e;e--)if(i[e]===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(e,i){var n=function(){if((e._icon||e.__parent._icon)&&!this._inZoomAnimation)if(this._map.off("moveend",n,this),this.off("animationend",n,this),e._icon)i();else if(e.__parent._icon){var t=function(){this.off("spiderfied",t,this),i()};this.on("spiderfied",t,this),e.__parent.spiderfy()}};e._icon&&this._map.getBounds().contains(e.getLatLng())?i():e.__parent._zoom<this._map.getZoom()?(this._map.on("moveend",n,this),this._map.panTo(e.getLatLng())):(this._map.on("moveend",n,this),this.on("animationend",n,this),this._map.setView(e.getLatLng(),e.__parent._zoom+1),e.__parent.zoomToBounds())},onAdd:function(t){var e,i,n;if(this._map=t,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),e=0,i=this._needsRemoving.length;e<i;e++)n=this._needsRemoving[e],this._removeLayer(n,!0);this._needsRemoving=[],this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),i=this._needsClustering,this._needsClustering=[],this.addLayers(i)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var i=t.length-1;0<=i;i--)if(t[i]===e)return t.splice(i,1),!0},_childMarkerMoved:function(t){this._ignoreMove||(t.target._latlng=t.oldLatLng,this.removeLayer(t.target),t.target._latlng=t.latlng,this.addLayer(t.target))},_removeLayer:function(t,e,i){var n=this._gridClusters,o=this._gridUnclustered,a=this._featureGroup,s=this._map;if(e)for(var r=this._maxZoom;0<=r&&o[r].removeObject(t,s.project(t.getLatLng(),r));r--);var l,c=t.__parent,d=c._markers;for(this._arraySplice(d,t);c&&(c._childCount--,!(c._zoom<0));)e&&c._childCount<=1?(l=c._markers[0]===t?c._markers[1]:c._markers[0],n[c._zoom].removeObject(c,s.project(c._cLatLng,c._zoom)),o[c._zoom].addObject(l,s.project(l.getLatLng(),c._zoom)),this._arraySplice(c.__parent._childClusters,c),c.__parent._markers.push(l),l.__parent=c.__parent,c._icon&&(a.removeLayer(c),i||a.addLayer(l))):(c._recalculateBounds(),i&&c._icon||c._updateIcon()),c=c.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,i){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,i)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),i=" marker-cluster-";return i+=e<10?"small":e<100?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick;(e||n)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=this._map;e.getMaxZoom()===e.getZoom()?this.options.spiderfyOnMaxZoom&&t.layer.spiderfy():this.options.zoomToBoundsOnClick&&t.layer.zoomToBounds(),t.originalEvent&&13===t.originalEvent.keyCode&&e._container.focus()},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),2<t.layer.getChildCount()&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,n=this._map;(t||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=this._map.getMaxZoom(),e=this.options.maxClusterRadius,i=e;"function"!=typeof e&&(i=function(){return e}),this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var n=t;0<=n;n--)this._gridClusters[n]=new L.DistanceGrid(i(n)),this._gridUnclustered[n]=new L.DistanceGrid(i(n));this._topClusterLevel=new L.MarkerCluster(this,-1)},_addLayer:function(t,e){var i,n,o=this._gridClusters,a=this._gridUnclustered;for(this.options.singleMarkerMode&&(t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}})),t.on("move",this._childMarkerMoved,this);0<=e;e--){i=this._map.project(t.getLatLng(),e);var s=o[e].getNearObject(i);if(s)return s._addChild(t),void(t.__parent=s);if(s=a[e].getNearObject(i)){var r=s.__parent;r&&this._removeLayer(s,!1);var l=new L.MarkerCluster(this,e,s,t);o[e].addObject(l,this._map.project(l._cLatLng,e)),s.__parent=l;var c=t.__parent=l;for(n=e-1;n>r._zoom;n--)c=new L.MarkerCluster(this,n,c),o[n].addObject(c,this._map.project(s.getLatLng(),n));for(r._addChild(c),n=e;0<=n&&a[n].removeObject(s,this._map.project(s.getLatLng(),n));n--);return}a[e].addObject(t,i)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.contains(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds)return this.getBounds();var t=this._map.getBounds(),e=t._southWest,i=t._northEast,n=L.Browser.mobile?0:Math.abs(e.lat-i.lat),o=L.Browser.mobile?0:Math.abs(e.lng-i.lng);return new L.LatLngBounds(new L.LatLng(e.lat-n,e.lng-o,!0),new L.LatLng(i.lat+n,i.lng+o,!0))},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var i=e.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else e._updateIcon()}}),L.MarkerClusterGroup.include(L.DomUtil.TRANSITION?{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_animationZoomIn:function(o,a){var s,r=this._getExpandedVisibleBounds(),l=this._featureGroup;this._ignoreMove=!0,this._topClusterLevel._recursively(r,o,0,function(t){var e,i=t._latlng,n=t._markers;for(r.contains(i)||(i=null),t._isSingleParent()&&o+1===a?(l.removeLayer(t),t._recursivelyAddChildrenToMap(null,a,r)):(t.setOpacity(0),t._recursivelyAddChildrenToMap(i,a,r)),s=n.length-1;0<=s;s--)e=n[s],r.contains(e._latlng)||l.removeLayer(e)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(r,a),l.eachLayer(function(t){t instanceof L.MarkerCluster||!t._icon||t.setOpacity(1)}),this._topClusterLevel._recursively(r,o,a,function(t){t._recursivelyRestoreChildPositions(a)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(r,o,0,function(t){l.removeLayer(t),t.setOpacity(1)}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(e,i,n){var o=this._getExpandedVisibleBounds();e._recursivelyAnimateChildrenInAndAddSelfToMap(o,i+1,n);var a=this;this._forceLayout(),e._recursivelyBecomeVisible(o,n),this._enqueue(function(){if(1===e._childCount){var t=e._markers[0];this._ignoreMove=!0,t.setLatLng(t.getLatLng()),this._ignoreMove=!1,t.setOpacity&&t.setOpacity(1)}else e._recursively(o,n,0,function(t){t._recursivelyRemoveChildrenFromMap(o,i+1)});a._animationEnd()})},_animationAddLayer:function(t,e){var i=this,n=this._featureGroup;n.addLayer(t),e!==t&&(2<e._childCount?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.setOpacity(0),this._enqueue(function(){n.removeLayer(t),t.setOpacity(1),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(e,this._map.getMaxZoom(),this._map.getZoom())))},_forceLayout:function(){L.Util.falseFn(f.body.offsetWidth)}}:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)},L.MarkerCluster=L.Marker.extend({initialize:function(t,e,i,n){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),n&&this._addChild(n)},getAllChildMarkers:function(t){t=t||[];for(var e=this._childClusters.length-1;0<=e;e--)this._childClusters[e].getAllChildMarkers(t);for(var i=this._markers.length-1;0<=i;i--)t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var t,e=this._childClusters.slice(),i=this._group._map,n=i.getBoundsZoom(this._bounds),o=this._zoom+1,a=i.getZoom();0<e.length&&o<n;){o++;var s=[];for(t=0;t<e.length;t++)s=s.concat(e[t]._childClusters);e=s}o<n?this._group._map.setView(this._latlng,o):n<=a?this._group._map.setView(this._latlng,a+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._expandBounds(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_expandBounds:function(t){var e,i=t._wLatLng||t._latlng;e=t instanceof L.MarkerCluster?(this._bounds.extend(t._bounds),t._childCount):(this._bounds.extend(i),1),this._cLatLng||(this._cLatLng=t._cLatLng||i);var n=this._childCount+e;this._wLatLng?(this._wLatLng.lat=(i.lat*e+this._wLatLng.lat*this._childCount)/n,this._wLatLng.lng=(i.lng*e+this._wLatLng.lng*this._childCount)/n):this._latlng=this._wLatLng=new L.LatLng(i.lat,i.lng)},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,o,e){this._recursively(t,0,e-1,function(t){var e,i,n=t._markers;for(e=n.length-1;0<=e;e--)(i=n[e])._icon&&(i._setPos(o),i.setOpacity(0))},function(t){var e,i,n=t._childClusters;for(e=n.length-1;0<=e;e--)(i=n[e])._icon&&(i._setPos(o),i.setOpacity(0))})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(e,i,n){this._recursively(e,n,0,function(t){t._recursivelyAnimateChildrenIn(e,t._group._map.latLngToLayerPoint(t.getLatLng()).round(),i),t._isSingleParent()&&i-1===n?(t.setOpacity(1),t._recursivelyRemoveChildrenFromMap(e,i)):t.setOpacity(0),t._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,0,e,null,function(t){t.setOpacity(1)})},_recursivelyAddChildrenToMap:function(n,o,a){this._recursively(a,-1,o,function(t){if(o!==t._zoom)for(var e=t._markers.length-1;0<=e;e--){var i=t._markers[e];a.contains(i._latlng)&&(n&&(i._backupLatlng=i.getLatLng(),i.setLatLng(n),i.setOpacity&&i.setOpacity(0)),t._group._featureGroup.addLayer(i))}},function(t){t._addToMap(n)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;0<=e;e--){var i=this._markers[e];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(t-1===this._zoom)for(var n=this._childClusters.length-1;0<=n;n--)this._childClusters[n]._restorePosition();else for(var o=this._childClusters.length-1;0<=o;o--)this._childClusters[o]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,i){var n,o;this._recursively(t,-1,e-1,function(t){for(o=t._markers.length-1;0<=o;o--)n=t._markers[o],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))},function(t){for(o=t._childClusters.length-1;0<=o;o--)n=t._childClusters[o],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))})},_recursively:function(t,e,i,n,o){var a,s,r=this._childClusters,l=this._zoom;if(l<e)for(a=r.length-1;0<=a;a--)s=r[a],t.intersects(s._bounds)&&s._recursively(t,e,i,n,o);else if(n&&n(this),o&&this._zoom===i&&o(this),l<i)for(a=r.length-1;0<=a;a--)s=r[a],t.intersects(s._bounds)&&s._recursively(t,e,i,n,o)},_recalculateBounds:function(){var t,e=this._markers,i=this._childClusters;for(this._bounds=new L.LatLngBounds,delete this._wLatLng,t=e.length-1;0<=t;t--)this._expandBounds(e[t]);for(t=i.length-1;0<=t;t--)this._expandBounds(i[t])},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var i=this._getCoord(e.x),n=this._getCoord(e.y),o=this._grid,a=o[n]=o[n]||{},s=a[i]=a[i]||[],r=L.Util.stamp(t);this._objectPoint[r]=e,s.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i,n,o=this._getCoord(e.x),a=this._getCoord(e.y),s=this._grid,r=s[a]=s[a]||{},l=r[o]=r[o]||[];for(delete this._objectPoint[L.Util.stamp(t)],i=0,n=l.length;i<n;i++)if(l[i]===t)return l.splice(i,1),1===n&&delete r[o],!0},eachObject:function(t,e){var i,n,o,a,s,r,l=this._grid;for(i in l)for(n in s=l[i])for(o=0,a=(r=s[n]).length;o<a;o++)t.call(e,r[o])&&(o--,a--)},getNearObject:function(t){var e,i,n,o,a,s,r,l,c=this._getCoord(t.x),d=this._getCoord(t.y),u=this._objectPoint,h=this._sqCellSize,p=null;for(e=d-1;e<=d+1;e++)if(o=this._grid[e])for(i=c-1;i<=c+1;i++)if(a=o[i])for(n=0,s=a.length;n<s;n++)r=a[n],(l=this._sqDist(u[L.Util.stamp(r)],t))<h&&(h=l,p=r);return p},_getCoord:function(t){return Math.floor(t/this._cellSize)},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}},L.QuickHull={getDistant:function(t,e){var i=e[1].lat-e[0].lat;return(e[0].lng-e[1].lng)*(t.lat-e[0].lat)+i*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var i,n,o,a=0,s=null,r=[];for(i=e.length-1;0<=i;i--)n=e[i],0<(o=this.getDistant(n,t))&&(r.push(n),a<o&&(a=o,s=n));return{maxPoint:s,newPoints:r}},buildConvexHull:function(t,e){var i=[],n=this.findMostDistantPointFromBaseLine(t,e);return n.maxPoint?i=(i=i.concat(this.buildConvexHull([t[0],n.maxPoint],n.newPoints))).concat(this.buildConvexHull([n.maxPoint,t[1]],n.newPoints)):[t[0]]},getConvexHull:function(t){var e,i=!1,n=!1,o=null,a=null;for(e=t.length-1;0<=e;e--){var s=t[e];(!1===i||s.lat>i)&&(i=(o=s).lat),(!1===n||s.lat<n)&&(n=(a=s).lat)}return[].concat(this.buildConvexHull([a,o],t),this.buildConvexHull([o,a],t))}},L.MarkerCluster.include({getConvexHull:function(){var t,e,i=this.getAllChildMarkers(),n=[];for(e=i.length-1;0<=e;e--)t=i[e].getLatLng(),n.push(t);return L.QuickHull.getConvexHull(n)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(),i=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,t=e.length>=this._circleSpiralSwitchover?this._generatePointsSpiral(e.length,i):(i.y+=10,this._generatePointsCircle(e.length,i)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var i,n,o=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t)/this._2PI,a=this._2PI/t,s=[];for(i=(s.length=t)-1;0<=i;i--)n=this._circleStartAngle+i*a,s[i]=new L.Point(e.x+o*Math.cos(n),e.y+o*Math.sin(n))._round();return s},_generatePointsSpiral:function(t,e){var i,n=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,o=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,a=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,s=0,r=[];for(i=(r.length=t)-1;0<=i;i--)s+=o/n+5e-4*i,r[i]=new L.Point(e.x+n*Math.cos(s),e.y+n*Math.sin(s))._round(),n+=this._2PI*a/s;return r},_noanimationUnspiderfy:function(){var t,e,i=this._group,n=i._map,o=i._featureGroup,a=this.getAllChildMarkers();for(i._ignoreMove=!0,this.setOpacity(1),e=a.length-1;0<=e;e--)t=a[e],o.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(n.removeLayer(t._spiderLeg),delete t._spiderLeg);i._ignoreMove=!1,i._spiderfied=null}}),L.MarkerCluster.include(L.DomUtil.TRANSITION?{SVG_ANIMATION:-1<f.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate"),_animationSpiderfy:function(t,e){var i,n,o,a,s=this._group,r=s._map,l=s._featureGroup,c=r.latLngToLayerPoint(this._latlng),d="http://www.w3.org/2000/svg";for(s._ignoreMove=!0,i=t.length-1;0<=i;i--)(n=t[i]).setOpacity?(n.setZIndexOffset(1e6),n.setOpacity(0),l.addLayer(n),n._setPos(c)):l.addLayer(n);s._forceLayout(),s._animationStart();var u=this.SVG_ANIMATION?0:.3;for(i=t.length-1;0<=i;i--)if(a=r.layerPointToLatLng(e[i]),(n=t[i])._preSpiderfyLatlng=n._latlng,n.setLatLng(a),n.setOpacity&&n.setOpacity(1),o=new L.Polyline([this._latlng,a],{weight:1.5,color:"#222",opacity:u}),r.addLayer(o),n._spiderLeg=o,this.SVG_ANIMATION){var h=o._path.getTotalLength();o._path.setAttribute("stroke-dasharray",h+","+h);var p=f.createElementNS(d,"animate");p.setAttribute("attributeName","stroke-dashoffset"),p.setAttribute("begin","indefinite"),p.setAttribute("from",h),p.setAttribute("to",0),p.setAttribute("dur",.25),o._path.appendChild(p),p.beginElement(),(p=f.createElementNS(d,"animate")).setAttribute("attributeName","stroke-opacity"),p.setAttribute("attributeName","stroke-opacity"),p.setAttribute("begin","indefinite"),p.setAttribute("from",0),p.setAttribute("to",.3),p.setAttribute("dur",.25),o._path.appendChild(p),p.beginElement()}for(this.setOpacity(.3),this._group._forceLayout(),i=t.length-1;0<=i;i--)(n=t[i]._spiderLeg).options.opacity=.5,n._path.setAttribute("stroke-opacity",.5);s._ignoreMove=!1,setTimeout(function(){s._animationEnd(),s.fire("spiderfied")},200)},_animationUnspiderfy:function(t){var e,i,n,o=this._group,a=o._map,s=o._featureGroup,r=t?a._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):a.latLngToLayerPoint(this._latlng),l=this.getAllChildMarkers();for(o._ignoreMove=!0,o._animationStart(),this.setOpacity(1),i=l.length-1;0<=i;i--)(e=l[i])._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,e.setOpacity?(e._setPos(r),e.setOpacity(0)):s.removeLayer(e),this.SVG_ANIMATION&&((n=e._spiderLeg._path.childNodes[0]).setAttribute("to",n.getAttribute("from")),n.setAttribute("from",0),n.beginElement(),(n=e._spiderLeg._path.childNodes[1]).setAttribute("from",.5),n.setAttribute("to",0),n.setAttribute("stroke-opacity",0),n.beginElement(),e._spiderLeg._path.setAttribute("stroke-opacity",0)));o._ignoreMove=!1,setTimeout(function(){var t=0;for(i=l.length-1;0<=i;i--)(e=l[i])._spiderLeg&&t++;for(i=l.length-1;0<=i;i--)(e=l[i])._spiderLeg&&(e.setOpacity&&(e.setOpacity(1),e.setZIndexOffset(0)),1<t&&s.removeLayer(e),a.removeLayer(e._spiderLeg),delete e._spiderLeg);o._animationEnd()},200)}}:{_animationSpiderfy:function(t,e){var i,n,o,a,s=this._group,r=s._map,l=s._featureGroup;for(s._ignoreMove=!0,i=t.length-1;0<=i;i--)a=r.layerPointToLatLng(e[i]),(n=t[i])._preSpiderfyLatlng=n._latlng,n.setLatLng(a),n.setZIndexOffset&&n.setZIndexOffset(1e6),l.addLayer(n),o=new L.Polyline([this._latlng,a],{weight:1.5,color:"#222"}),r.addLayer(o),n._spiderLeg=o;this.setOpacity(.3),s._ignoreMove=!1,s.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.setOpacity(1),t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}})}(window,document),L.GridLayer.GoogleMutant=L.GridLayer.extend({includes:L.Mixin.Events,options:{minZoom:0,zoom:2,maxZoom:16,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,type:"roadmap",maxNativeZoom:21},initialize:function(t){L.GridLayer.prototype.initialize.call(this,t),this._ready=!!window.google&&!!window.google.maps&&!!window.google.maps.Map,this._GAPIPromise=this._ready?Promise.resolve(window.google):new Promise(function(t,e){var i=0,n=null;n=setInterval(function(){return 10<=i?(clearInterval(n),e(new Error("window.google not found after 10 attempts"))):window.google&&window.google.maps&&window.google.maps.Map?(clearInterval(n),t(window.google)):void i++},500)}),this._tileCallbacks={},this._freshTiles={},this._imagesPerTile="hybrid"===this.options.type?2:1},onAdd:function(e){L.GridLayer.prototype.onAdd.call(this,e),this._initMutantContainer(),this._GAPIPromise.then(function(){if(this._ready=!0,this._map=e,this._initMutant(),e.on("viewreset",this._reset,this),e.on("move",this._update,this),e.on("zoomend",this._handleZoomAnim,this),e.on("resize",this._resize,this),google.maps.event.addListenerOnce(this._mutant,"idle",function(){this._checkZoomLevels(),this._mutantIsReady=!0}.bind(this)),e._controlCorners.bottomright.style.marginBottom="20px",e._controlCorners.bottomleft.style.marginBottom="20px",this._reset(),this._update(),this._subLayers)for(var t in this._subLayers)this._subLayers[t].setMap(this._mutant)}.bind(this))},onRemove:function(t){L.GridLayer.prototype.onRemove.call(this,t),t._container.removeChild(this._mutantContainer),this._mutantContainer=void 0,google.maps.event.clearListeners(t,"idle"),google.maps.event.clearListeners(this._mutant,"idle"),t.off("viewreset",this._reset,this),t.off("move",this._update,this),t.off("zoomend",this._handleZoomAnim,this),t.off("resize",this._resize,this),t._controlCorners.bottomright.style.marginBottom="0em",t._controlCorners.bottomleft.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(t){(this.options.opacity=t)<1&&L.DomUtil.setOpacity(this._mutantContainer,t)},setElementSize:function(t,e){t.style.width=e.x+"px",t.style.height=e.y+"px"},addGoogleLayer:function(e,i){return this._subLayers||(this._subLayers={}),this._GAPIPromise.then(function(){var t=new google.maps[e](i);return t.setMap(this._mutant),this._subLayers[e]=t}.bind(this))},removeGoogleLayer:function(t){var e=this._subLayers&&this._subLayers[t];e&&(e.setMap(null),delete this._subLayers[t])},_initMutantContainer:function(){this._mutantContainer||(this._mutantContainer=L.DomUtil.create("div","leaflet-google-mutant leaflet-top leaflet-left"),this._mutantContainer.id="_MutantContainer_"+L.Util.stamp(this._mutantContainer),this._mutantContainer.style.zIndex="800",this._mutantContainer.style.pointerEvents="none",this._map.getContainer().appendChild(this._mutantContainer)),this.setOpacity(this.options.opacity),this.setElementSize(this._mutantContainer,this._map.getSize()),this._attachObserver(this._mutantContainer)},_initMutant:function(){if(this._ready&&this._mutantContainer){this._mutantCenter=new google.maps.LatLng(0,0);var t=new google.maps.Map(this._mutantContainer,{center:this._mutantCenter,zoom:2,tilt:0,mapTypeId:this.options.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,styles:this.options.styles||{},backgroundColor:"transparent"});this._mutant=t,google.maps.event.addListenerOnce(t,"idle",function(){for(var t=this._mutantContainer.querySelectorAll("a"),e=0;e<t.length;e++)t[e].style.pointerEvents="auto"}.bind(this)),this.fire("spawned",{mapObject:t})}},_attachObserver:function(t){new MutationObserver(this._onMutations.bind(this)).observe(t,{childList:!0,subtree:!0})},_onMutations:function(t){for(var e=0;e<t.length;++e)for(var i=t[e],n=0;n<i.addedNodes.length;++n){var o=i.addedNodes[n];o instanceof HTMLImageElement?this._onMutatedImage(o):o instanceof HTMLElement&&Array.prototype.forEach.call(o.querySelectorAll("img"),this._onMutatedImage.bind(this))}},_roadRegexp:/!1i(\d+)!2i(\d+)!3i(\d+)!/,_satRegexp:/x=(\d+)&y=(\d+)&z=(\d+)/,_staticRegExp:/StaticMapService\.GetMapImage/,_onMutatedImage:function(t){var e,i=t.src.match(this._roadRegexp),n=0;if(i?(e={z:i[1],x:i[2],y:i[3]},1<this._imagesPerTile&&(n=t.style.zIndex=1)):((i=t.src.match(this._satRegexp))&&(e={x:i[1],y:i[2],z:i[3]}),n=0),e){var o=this._tileCoordsToKey(e);t.style.position="absolute",t.style.visibility="hidden";var a=o+"/"+n;if(this._freshTiles[a]=t,a in this._tileCallbacks&&this._tileCallbacks[a])this._tileCallbacks[a].pop()(t),this._tileCallbacks[a].length||delete this._tileCallbacks[a];else if(this._tiles[o]){var s=this._tiles[o].el,r=0===n?s.firstChild:s.firstChild.nextSibling,l=this._clone(t);s.replaceChild(l,r)}}else t.src.match(this._staticRegExp)&&(t.style.visibility="hidden")},createTile:function(t,i){var e=this._tileCoordsToKey(t),n=L.DomUtil.create("div");n.dataset.pending=this._imagesPerTile,i=i.bind(this,null,n);for(var o=0;o<this._imagesPerTile;o++){var a=e+"/"+o;if(a in this._freshTiles){var s=this._freshTiles[a];n.appendChild(this._clone(s)),n.dataset.pending--}else this._tileCallbacks[a]=this._tileCallbacks[a]||[],this._tileCallbacks[a].push(function(e){return function(t){e.appendChild(this._clone(t)),e.dataset.pending--,parseInt(e.dataset.pending)||i()}.bind(this)}.bind(this)(n))}return parseInt(n.dataset.pending)||L.Util.requestAnimFrame(i),n},_clone:function(t){var e=t.cloneNode(!0);return e.style.visibility="visible",e},_checkZoomLevels:function(){var t=this._map.getZoom(),e=this._mutant.getZoom();t&&e&&(e!==t||e>this.options.maxNativeZoom)&&this._setMaxNativeZoom(e)},_setMaxNativeZoom:function(t){t!=this.options.maxNativeZoom&&(this.options.maxNativeZoom=t,this._resetView())},_reset:function(){this._initContainer()},_update:function(){if(this._mutant){var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._mutant.setCenter(e);var i=this._map.getZoom(),n=i!==Math.round(i),o=this._mutant.getZoom();n||i==o||(this._mutant.setZoom(i),this._mutantIsReady&&this._checkZoomLevels())}L.GridLayer.prototype._update.call(this)},_resize:function(){var t=this._map.getSize();this._mutantContainer.style.width===t.x&&this._mutantContainer.style.height===t.y||(this.setElementSize(this._mutantContainer,t),this._mutant&&google.maps.event.trigger(this._mutant,"resize"))},_handleZoomAnim:function(){if(this._mutant){var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._mutant.setCenter(e),this._mutant.setZoom(Math.round(this._map.getZoom()))}},_removeTile:function(t){if(this._mutant)return setTimeout(this._pruneTile.bind(this,t),1e3),L.GridLayer.prototype._removeTile.call(this,t)},_pruneTile:function(t){for(var e=this._mutant.getZoom(),i=t.split(":")[2],n=this._mutant.getBounds(),o=n.getSouthWest(),a=n.getNorthEast(),s=L.latLngBounds([[o.lat(),o.lng()],[a.lat(),a.lng()]]),r=0;r<this._imagesPerTile;r++){var l=t+"/"+r;if(l in this._freshTiles){var c=this._map&&this._keyToBounds(t);this._map&&c.overlaps(s)&&i==e||delete this._freshTiles[l]}}}}),L.gridLayer.googleMutant=function(t){return new L.GridLayer.GoogleMutant(t)};var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},function(t,n){function e(t){if(t.length){t.each(function(){var t=n(this);t.attr("data-video-id",encodeURIComponent(t.attr("data-video-id")).replace("ref%3A","ref:"))});var e=t.data("player"),i="//players.brightcove.net/"+t.data("account")+"/"+e+"_default/index.min.js";n.getScript(i,function(){})}}t.init=function(){e(n(".brightcove-wrapper video.video-js")),e(n(".brightcove-wrapper-audio video.video-js"))}}(SCM.Utilities.Brightcove=SCM.Utilities.Brightcove||{},jQuery);var App=App||{};!function(t,a){function o(t,e,i,n){var o=function(t,e){return t.find(".mixed-citation "+e).text()}(e,i);o&&(t[n]=o)}function e(t){ajaxUrl=(App.CurrentSubdomain.length?"/"+App.CurrentSubdomain:"")+"/GSW/GetGeoRefEnhancements/GetGeoRefEnhancementsRelated";var e=function(t){var e=0;if(0===t.length)return e;for(var i=0;i<t.length;i++){var n=t.charCodeAt(i);e=(e<<5)-e+n,e&=e}return e.toString()}(JSON.stringify(t));return a.ajax({async:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({cacheHash:e,contentQueryItems:t}),url:ajaxUrl,type:"POST",success:function(t){!function(t){for(var e=0;e<t.length;e++){var i=t[e],n=a('div.ref-content[role="'+i.ReferenceId+'"]').find(".citation-links"),o='<div class="georef-link"><a href="'+i.Href+'">GeoRef</a></div>';n.append(o)}}(t)},error:function(t,e,i){console.log("The request to the GetGeoRefEnhancements widget has failed."+e),console.log(t),console.log(e),console.log(i)}}),null}function i(){var t=function(){var n=[];return a("div.ref-content").each(function(){var t=a(this),e={};e.referenceId=t.attr("role");var i=t.find(".mixed-citation .crossref-doi > a").attr("href");i?e.doi=i.slice(18):(o(e,t,".publisher-name","publisher"),o(e,t,".source","journal"),o(e,t,".volume","volume"),o(e,t,".issue","issue"),o(e,t,".fpage","startPage"),o(e,t,".issn","issn"),o(e,t,".eissn","eissn")),n.push(e)}),n}();t&&0<t.length&&e(t)}t.init=function(){setTimeout(i,0)}}(App.GeoRefReferenceLinks=App.GeoRefReferenceLinks||{},jQuery),$(document).ready(function(){App.GeoRefReferenceLinks.init()});var ArtMetric={fullVersion:function($dest,routeUrl){if($dest.find(".widget-ArticleLevelMetrics").length<1){var baseSiteUrl=$("#hfSiteURL");void 0!==baseSiteUrl&&void 0!==baseSiteUrl.val()&&""!=baseSiteUrl&&(routeUrl="//"+baseSiteUrl.val()+routeUrl),$.ajax({url:routeUrl,datatype:"HTML",success:function(t){$dest.prepend(t),setTimeout(function(){if(void 0!==window.ChartistData){ArtMetric.createChart(".ct-chart",window.ChartistData.data,{lineSmooth:!1,showArea:!0,low:0},[["screen and (max-width: 1024px)",{axisX:{labelInterpolationFnc:function(t){return t.slice(0,3)}}}],["screen and (min-width: 1px)",{axisX:{labelInterpolationFnc:function(t){return t}}}]])}},200),$(".artmet-dimensions").length&&window.__dimensions_embed&&window.__dimensions_embed.addBadges&&window.__dimensions_embed.addBadges()},error:function(xmlHttpRequest,textStatus,errorThrown){if(window.console){var err=eval("("+xmlHttpRequest.responseText+")");console.log("error: "+err),console.log("status: "+textStatus)}}})}},limitLabels:function(){var t=$(".ct-horizontal.ct-label"),e=t.length,i=Math.ceil(e/8),n=1;t.not(":eq(0)").each(function(){n%i!=0&&$(this).hide(),n++})},createChart:function(t,e,i,n){var o=new Chartist.Line(t,e,i,n),a=0;o.on("created",function(){a=0,ArtMetric.limitLabels()}),o.on("draw",function(t){"line"!==t.type&&"point"!==t.type&&"area"!==t.type||a++,"line"===t.type?t.element.animate({opacity:{begin:25*a+150,dur:250,from:0,to:1}}):"point"===t.type?t.element.animate({x1:{begin:25*a,dur:250,from:t.x-10,to:t.x,easing:"easeOutQuart"},x2:{begin:25*a,dur:250,from:t.x-10,to:t.x,easing:"easeOutQuart"},opacity:{begin:25*a,dur:250,from:0,to:1,easing:"easeOutQuart"}}):"area"===t.type&&t.element.animate({opacity:{begin:25*a+250,dur:300,from:0,to:1}})})},triggerModal:function(t,e){var i="/ThirdParty/ArticleLevelMetricsDetails?articleId="+e+"&showDimensionsBadge="+($(".artmet-dimensions").length?"true":"false");ArtMetric.fullVersion(t,i);var n=$(".artmet-modal"),o=$("body");n.css({display:"block",opacity:1}),o.addClass("metrics-modal-open")},closeModal:function(){var t=$(".artmet-modal"),e=$("body");t.attr("style",""),e.removeClass("metrics-modal-open")},eventsToClose:function(){$(".artmet-close-modal").click(function(){ArtMetric.closeModal()}),$(".artmet-modal").click(function(){$(event.target).closest(".artmet-modal-contents").length||ArtMetric.closeModal()})}};$(document).ready(function(){$(".artmet-modal-trigger, .artmet-condensed-stats .artmet-views").click(function(){var t=$(".artmet-modal-trigger").attr("data-article-id");ArtMetric.triggerModal($(".artmet-modal-contents"),t)}),ArtMetric.eventsToClose()});var SCM=SCM||{};SCM.Utilities=SCM.Utilities||{},SCM.Utilities.LocalStorage=function(){"use strict";var n=window.localStorage;return{getItem:function(t,e){var i=(e=e||n).getItem("SCM."+t);return JSON.parse(i)},setItem:function(t,e,i){(i=i||n).setItem("SCM."+t,JSON.stringify(e))},removeItem:function(t,e){(e=e||n).removeItem("SCM."+t)}}}(),SCM=SCM||{},SCM.Utilities=SCM.Utilities||{},SCM.Utilities.Reveal=function(n){var o="data-reveal-id",a="reveal-modal",s="close-reveal-modal",r="open",l="on-canvas",c=n(document.body);return{init:function(t){!function(t){if(!t||"object"!=typeof t)return;t.targetIdAttr&&(o=t.targetIdAttr),t.modalClass&&(a=t.modalClass),t.closeTriggerClass&&(s=t.closeTriggerClass),t.modalOpenClass&&(r=t.modalOpenClass),t.bodyOpenClass&&(l=t.bodyOpenClass)}(t);var e="*["+o+"]";c.on("click",e,function(t){!function(t){var e=n(t).attr(o),i=n("#"+e);i.length&&d(i)}(t.currentTarget)});var i="."+s;c.on("click",i,function(t){!function(t){var e=n(t).closest("."+a);e.length&&u(e)}(t.currentTarget)})},open:d,close:u,toggle:function(t){("string"==typeof t||t instanceof Element)&&(t=n(t));t.each(function(t,e){var i=n(e);i.hasClass(r)?u(i):d(i)})}};function d(t,e){("string"==typeof t||t instanceof Element)&&(t=n(t)),t.addClass(r),e&&l&&c.addClass(l)}function u(t){("string"==typeof t||t instanceof Element)&&(t=n(t)),t.removeClass(r),l&&c.removeClass(l)}}(jQuery),SCM=SCM||{},SCM.Utilities=SCM.Utilities||{},SCM.Utilities.LazyLoad=function(){var o="lazyLoadInit";return{init:function(t){try{var e="img."+(t=t||"lazy")+":not(."+o+")",i=[].slice.call(document.querySelectorAll(e));if(!i.length)return;"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&"isIntersecting"in window.IntersectionObserverEntry.prototype?function(t,n){var e=new IntersectionObserver(function(t,i){t.forEach(function(t){if(t.isIntersecting){var e=t.target;a(e),e.classList.remove(n),i.unobserve(e)}})},{rootMargin:"200px 0px 200px 0px"});t.forEach(function(t){e.observe(t),t.classList.add(o)})}(i,t):function(t,i){var e=!1,n=function(){!1===e&&(e=!0,setTimeout(function(){t.forEach(function(e){e.getBoundingClientRect().top<=window.innerHeight&&0<=e.getBoundingClientRect().bottom&&"none"!==getComputedStyle(e).display&&(a(e),e.classList.remove(i),0===(t=t.filter(function(t){return t!==e})).length&&(document.removeEventListener("scroll",n),window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n)))}),e=!1},200))};document.addEventListener("scroll",n),window.addEventListener("resize",n),window.addEventListener("orientationchange",n),t.forEach(function(t){t.classList.add(o)})}(i,t)}catch(t){console.error("Exception during SCM.Utilities.LazyLoad.init()",t)}}};function a(t){t.src=t.dataset.src||t.dataset.original,t.dataset.srcset&&(t.srcset=t.dataset.srcset)}}();var SCM=SCM||{},App=App||{};!function(n,o,a){var s="instOpenUrlKey_";n.replaceOpenUrlPlaceHolders=function(t,i){null!==i&&""!==i&&t.each(function(){var t=o(this).attr("data-targetId"),e=i.replace("{openUrlTargetId}",t);o(this).html(e),o(this).parent().show()})},n.getAndReplaceOpenUrlPlaceHolders=function(i){o.ajax({type:"POST",url:"/ThirdParty/InstitutionOpenUrlTemplate",dataType:"json",success:function(t){if(null!==t&&"undefined"!==t){var e="";1==t.DisplayOpenUrlLink&&(e=null!==t.LinkImageSource&&""!==t.LinkImageSource?" <a target='_blank' href='"+t.TargetUrl+"'><img src='"+t.LinkImageSource+"'/></a> ":" <a target='_blank' href='"+t.TargetUrl+"'> "+t.LinkImageText+" </a> "),n.replaceOpenUrlPlaceHolders(i,e),null!==a&&null!==window.sessionStorage&&void 0!==window.App.LoginUserInfo&&void 0!==window.App.LoginUserInfo.currentSessionId&&a.setItem(s+window.App.LoginUserInfo.currentSessionId,e,window.sessionStorage)}},error:function(t){}})},n.checkAndReplaceOpenUrlPlaceHolders=function(){if(void 0!==window.App.LoginUserInfo&&0<window.App.LoginUserInfo.isInstLoggedIn){var t=o('span[class="inst-open-url-holders"]');if(null!=t&&0<t.length)if(null!==a&&null!==window.sessionStorage&&void 0!==window.App.LoginUserInfo.currentSessionId){var e=a.getItem(s+window.App.LoginUserInfo.currentSessionId,window.sessionStorage);null!==e?n.replaceOpenUrlPlaceHolders(t,e):n.getAndReplaceOpenUrlPlaceHolders(t)}else n.getAndReplaceOpenUrlPlaceHolders(t)}},n.init=function(){n.checkAndReplaceOpenUrlPlaceHolders()},n.init()}(SCM.InstitutionOpenUrl=SCM.InstitutionOpenUrl||{},jQuery,SCM.Utilities.LocalStorage);var SCM=SCM||{};function insertArticleLinksIntoReferences(){var t=$("#js-hfArticleLinksReferencesDoiRegex").val();if(t){var n=new RegExp(t,"g"),e=$(".ref-list").children("div").map(function(t,e){var i=$(e).html().match(n);return i&&i.length?{elem:e,doi:i[0]}:null}).filter(function(t,e){return!!e&&!!e.elem&&!!e.doi});if(e.length){var i=e.map(function(t,e){return e.doi}).get().filter(function(t,e,i){return i.indexOf(t)===e});i&&i.length&&$.post("/Article/ArticleUrlsByDoi",{dois:i.toString()}).promise().then(function(o){if(!o||!o.Success){var t=$.Deferred();return t.reject(o.Messages&&o.Messages.length?o.Messages[0]:"Unknown error"),t}e.each(function(t,e){if(e.elem&&e.doi&&o.Result[e.doi]){var i=$(e.elem).find(".js-ref-link").first(),n=$("<div>").addClass("article-ref-link js-ref-link").html($("<a>").attr("href",o.Result[e.doi]).html("Article"));i.before(n)}})}).then(null,function(t){console.error("Unable to look up resource URLs for DOIs"),console.error(t)})}}}!function(t,e,i,n){var o=e("#ArticleFullTextWrap"),a=!1;o&&o.attr("data-userHasAccess")&&(a="true"===o.attr("data-userHasAccess").toLowerCase()),t.replaceContentLinks=function(){a||o.find("a[data-reveal-id]").each(function(){e(this).replaceWith(function(){return"<span>"+this.innerHTML+"</span>"})})},t.init=function(){t.replaceContentLinks(),n&&n.init(),i&&i.init()},insertArticleLinksIntoReferences()}(SCM.ArticleFulltext=SCM.ArticleFulltext||{},jQuery,SCM.InstitutionOpenUrl,SCM.Utilities.Brightcove);var SCM=SCM||{};!function(n,c){n.init=function(){var t=c("#articlefulltext_figshare");if(t.length){var e=c('meta[name="citation_doi"]').attr("content");if(e){var i=c(".widget-ArticleFulltext");i.length&&(n.initMount(i,t),n.loadFigShare(e,t))}}},n.loadFigShare=function(i,n){figshare.load("filesViewerGeneric",function(t){var e=new t({version:"3",width:n.width(),showStats:"true"===n.data("showstats").toLowerCase(),showPageInfo:"true"===n.data("showpageinfo").toLowerCase(),showShareButton:"true"===n.data("showsharebutton").toLowerCase(),showFileDetails:"true"===n.data("showfiledetails").toLowerCase(),item:{resourceDOI:i}});e.on("loading",function(){var e=0,i=setInterval(function(){if(10===(e+=1))clearInterval(i);else if(n.find("figshare-widget").html().trim().length){clearInterval(i);var t=c(".js-splitview-aside").find('.tab-SupplementsCss[role="tab"]');t.length&&(t.addClass("js-hascontent"),t.show())}},500)}),e.initialize(),e.mount(n[0])})},n.initMount=function(t,e){var i,n,o,a;if((i=t.closest(".widget-SplitView").find(".js-splitview-aside")).length&&(n=i.find('.tab-SupplementsCss[role="tab"]'),o=i.find('.dynamic-widget-inner-wrap[role="tabpanel"]').has(".SupplementsCss"),a=o.find(".widget-dynamic-inner-wrap")),a&&a.length){var s=i.find('*[role="tabpanel"][aria-hidden="false"]').width();if(s){var r=c('<div class="position:relative"></div>').appendTo("body");e.css({position:"absolute",top:-9999,left:-9999,width:s}).detach().appendTo(r),n.on("click",function(){0===e.parent(".widget-dynamic-inner-wrap").length&&e.detach().prependTo(a).css({position:"static",top:0,left:0})})}}else{var l=t.find(".backreferences-title");1===l.length&&e.detach().insertBefore(l)}}}(SCM.FigShare=SCM.FigShare||{},jQuery),$(function(){SCM.FigShare.init()});
//# sourceMappingURL=site.min.js.map
